<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Êó•Êú¨Ë™ûÂ≠¶Áøí ‚Äî Japanese Learning Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700;900&family=Noto+Sans+JP:wght@300;400;500;700&family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #080810;
  --bg2: #0f0f1a;
  --bg3: #161625;
  --surface: #1a1a2e;
  --surface2: #22223b;
  --border: #2a2a45;
  --red: #c0392b;
  --red2: #e74c3c;
  --gold: #d4a017;
  --gold2: #f0c040;
  --teal: #16a085;
  --teal2: #1abc9c;
  --text: #e8e8f0;
  --text2: #9999bb;
  --text3: #5555aa;
  --white: #ffffff;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

html { scroll-behavior: smooth; }

body {
  font-family: 'Sarabun', 'Noto Sans JP', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* SIDEBAR */
.sidebar {
  position: fixed;
  left: 0; top: 0;
  width: 220px;
  height: 100vh;
  background: var(--bg2);
  border-right: 1px solid var(--border);
  z-index: 100;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  padding-bottom: 60px;
}

.logo {
  padding: 24px 20px;
  border-bottom: 1px solid var(--border);
}
.logo .jp { font-family: 'Noto Serif JP'; font-size: 22px; color: var(--red2); font-weight: 900; }
.logo .sub { font-size: 10px; color: var(--text3); letter-spacing: 2px; text-transform: uppercase; margin-top: 4px; }

.nav-section {
  padding: 12px 0;
  border-bottom: 1px solid var(--border);
}
.nav-label {
  font-size: 9px;
  letter-spacing: 2px;
  color: var(--text3);
  padding: 0 20px 8px;
  text-transform: uppercase;
}
.nav-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 20px;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 13px;
  color: var(--text2);
  border-left: 3px solid transparent;
}
.nav-item:hover { background: var(--surface); color: var(--text); }
.nav-item.active { background: var(--surface); color: var(--red2); border-left-color: var(--red2); }
.nav-item .icon { font-size: 16px; width: 20px; text-align: center; }
.nav-progress {
  font-size: 10px;
  margin-left: auto;
  background: var(--surface2);
  padding: 2px 6px;
  border-radius: 10px;
  color: var(--gold);
}

/* MAIN */
.main {
  margin-left: 220px;
  min-height: 100vh;
}

/* PAGES */
.page { display: none; padding: 32px; animation: fadeIn 0.3s ease; }
.page.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* PAGE HEADER */
.page-header { margin-bottom: 32px; }
.page-header h1 {
  font-family: 'Noto Serif JP';
  font-size: 32px;
  color: var(--white);
  font-weight: 900;
}
.page-header .jp-title { font-size: 14px; color: var(--red2); margin-top: 4px; font-family: 'Noto Serif JP'; }
.page-header p { color: var(--text2); margin-top: 8px; font-size: 14px; line-height: 1.6; }

/* CARDS */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 24px;
  margin-bottom: 20px;
}
.card-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--white);
  margin-bottom: 4px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.card-sub { font-size: 12px; color: var(--text2); margin-bottom: 20px; }

/* GRID */
.grid2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
.grid3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; }
.grid4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }

/* PROGRESS BAR */
.progress-bar {
  height: 6px;
  background: var(--surface2);
  border-radius: 3px;
  overflow: hidden;
  margin-top: 8px;
}
.progress-fill {
  height: 100%;
  border-radius: 3px;
  background: linear-gradient(90deg, var(--red), var(--gold));
  transition: width 0.5s ease;
}

/* STAT CARD */
.stat-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 20px;
  text-align: center;
}
.stat-num { font-family: 'Noto Serif JP'; font-size: 36px; color: var(--red2); font-weight: 900; }
.stat-label { font-size: 11px; color: var(--text2); margin-top: 4px; }

/* HIRAGANA/KATAKANA CHART */
.kana-grid {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  gap: 6px;
  margin: 16px 0;
}
.kana-cell {
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 10px 4px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}
.kana-cell:hover { background: var(--red); border-color: var(--red2); transform: scale(1.05); }
.kana-cell.learned { background: var(--surface2); border-color: var(--teal); }
.kana-cell.learned::after {
  content: '‚úì';
  position: absolute;
  top: 2px; right: 4px;
  font-size: 8px;
  color: var(--teal2);
}
.kana-jp { font-family: 'Noto Serif JP'; font-size: 20px; color: var(--white); }
.kana-ro { font-size: 9px; color: var(--text2); margin-top: 2px; }

/* FLASHCARD */
.flashcard-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}
.flashcard {
  width: 300px;
  height: 200px;
  perspective: 1000px;
  cursor: pointer;
}
.flashcard-inner {
  width: 100%;
  height: 100%;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.6s;
}
.flashcard.flipped .flashcard-inner { transform: rotateY(180deg); }
.card-face {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  border: 2px solid var(--border);
}
.card-front {
  background: linear-gradient(135deg, var(--surface), var(--surface2));
}
.card-back {
  background: linear-gradient(135deg, var(--red) 0%, #8b0000 100%);
  transform: rotateY(180deg);
  border-color: var(--red2);
}
.card-char { font-family: 'Noto Serif JP'; font-size: 72px; color: var(--white); }
.card-reading { font-size: 24px; color: rgba(255,255,255,0.9); font-weight: 600; }
.card-hint { font-size: 11px; color: var(--text2); margin-top: 8px; }

.fc-controls { display: flex; gap: 12px; }
.btn {
  padding: 10px 24px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-family: 'Sarabun';
  font-size: 14px;
  font-weight: 600;
  transition: all 0.2s;
}
.btn-primary { background: var(--red2); color: white; }
.btn-primary:hover { background: var(--red); transform: translateY(-1px); }
.btn-success { background: var(--teal); color: white; }
.btn-success:hover { background: var(--teal2); }
.btn-outline { background: transparent; color: var(--text2); border: 1px solid var(--border); }
.btn-outline:hover { border-color: var(--text2); color: var(--text); }
.btn-gold { background: var(--gold); color: #000; }
.btn-gold:hover { background: var(--gold2); }

/* QUIZ */
.quiz-options {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 16px;
}
.quiz-opt {
  padding: 14px;
  background: var(--surface2);
  border: 2px solid var(--border);
  border-radius: 10px;
  text-align: center;
  cursor: pointer;
  font-size: 18px;
  font-family: 'Noto Sans JP';
  transition: all 0.2s;
  color: var(--text);
}
.quiz-opt:hover { border-color: var(--gold); background: var(--surface); }
.quiz-opt.correct { border-color: var(--teal2); background: rgba(26, 188, 156, 0.15); color: var(--teal2); }
.quiz-opt.wrong { border-color: var(--red2); background: rgba(231, 76, 60, 0.15); color: var(--red2); }

/* GRAMMAR */
.grammar-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  margin-bottom: 16px;
  overflow: hidden;
}
.grammar-header {
  padding: 16px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  cursor: pointer;
  transition: background 0.2s;
}
.grammar-header:hover { background: var(--surface2); }
.grammar-pattern {
  font-family: 'Noto Serif JP';
  font-size: 18px;
  color: var(--gold);
}
.grammar-meaning { font-size: 13px; color: var(--text2); margin-top: 2px; }
.grammar-body {
  display: none;
  padding: 0 20px 20px;
  border-top: 1px solid var(--border);
}
.grammar-body.open { display: block; }
.example {
  background: var(--bg3);
  border-left: 3px solid var(--red2);
  padding: 12px 16px;
  border-radius: 0 8px 8px 0;
  margin: 12px 0;
}
.example-jp { font-family: 'Noto Sans JP'; font-size: 16px; color: var(--white); }
.example-ro { font-size: 12px; color: var(--text3); font-style: italic; margin-top: 2px; }
.example-th { font-size: 13px; color: var(--text2); margin-top: 4px; }

/* VOCAB */
.vocab-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 10px;
}
.vocab-item {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 14px;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}
.vocab-item:hover { border-color: var(--red2); transform: translateY(-2px); }
.vocab-item.known { border-color: var(--teal); }
.vocab-jp { font-family: 'Noto Sans JP'; font-size: 20px; color: var(--white); }
.vocab-ro { font-size: 11px; color: var(--red2); margin-top: 2px; }
.vocab-th { font-size: 12px; color: var(--text2); margin-top: 6px; }
.vocab-tag {
  font-size: 9px;
  padding: 2px 6px;
  border-radius: 4px;
  background: var(--surface2);
  color: var(--text3);
  display: inline-block;
  margin-top: 6px;
  text-transform: uppercase;
  letter-spacing: 1px;
}
.vocab-tag.n5 { background: rgba(192,57,43,0.2); color: var(--red2); }
.vocab-tag.n4 { background: rgba(212,160,23,0.2); color: var(--gold); }
.vocab-tag.adult { background: rgba(142,68,173,0.2); color: #bb8fce; }

/* KANJI */
.kanji-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
}
.kanji-card:hover { border-color: var(--gold); transform: translateY(-3px); }
.kanji-char { font-family: 'Noto Serif JP'; font-size: 48px; color: var(--white); }
.kanji-on { font-size: 11px; color: var(--red2); margin-top: 8px; }
.kanji-kun { font-size: 11px; color: var(--teal2); }
.kanji-meaning { font-size: 12px; color: var(--text2); margin-top: 4px; }
.kanji-stroke { font-size: 10px; color: var(--text3); margin-top: 4px; }

/* ROADMAP */
.roadmap {
  position: relative;
  padding-left: 32px;
}
.roadmap::before {
  content: '';
  position: absolute;
  left: 12px; top: 0; bottom: 0;
  width: 2px;
  background: linear-gradient(180deg, var(--red2), var(--gold), var(--teal));
}
.roadmap-item {
  position: relative;
  margin-bottom: 24px;
}
.roadmap-dot {
  position: absolute;
  left: -26px;
  top: 8px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--red2);
  border: 2px solid var(--bg2);
}
.roadmap-dot.done { background: var(--teal2); }
.roadmap-dot.current { background: var(--gold); box-shadow: 0 0 12px var(--gold); }
.roadmap-item h4 { font-size: 14px; font-weight: 600; color: var(--white); }
.roadmap-item p { font-size: 12px; color: var(--text2); margin-top: 4px; line-height: 1.5; }
.roadmap-month { font-size: 10px; color: var(--gold); letter-spacing: 1px; margin-bottom: 4px; }

/* TOOLS */
.tool-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  transition: all 0.2s;
}
.tool-card:hover { border-color: var(--teal); transform: translateY(-2px); }
.tool-icon { font-size: 28px; margin-bottom: 12px; }
.tool-name { font-size: 15px; font-weight: 600; color: var(--white); margin-bottom: 4px; }
.tool-desc { font-size: 12px; color: var(--text2); line-height: 1.5; }
.tool-link {
  display: inline-block;
  margin-top: 12px;
  font-size: 11px;
  color: var(--teal2);
  text-decoration: none;
}
.tool-link:hover { color: var(--gold2); }

/* TABS */
.tabs { display: flex; gap: 4px; margin-bottom: 24px; border-bottom: 1px solid var(--border); }
.tab {
  padding: 10px 20px;
  font-size: 13px;
  cursor: pointer;
  color: var(--text2);
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
  font-family: 'Sarabun';
}
.tab:hover { color: var(--text); }
.tab.active { color: var(--red2); border-bottom-color: var(--red2); }

.tab-panel { display: none; }
.tab-panel.active { display: block; }

/* BADGE */
.badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
}
.badge-red { background: rgba(192,57,43,0.2); color: var(--red2); border: 1px solid var(--red); }
.badge-gold { background: rgba(212,160,23,0.2); color: var(--gold2); border: 1px solid var(--gold); }
.badge-teal { background: rgba(22,160,133,0.2); color: var(--teal2); border: 1px solid var(--teal); }

/* QUIZ SCORE */
.score-display {
  text-align: center;
  padding: 24px;
}
.score-num { font-family: 'Noto Serif JP'; font-size: 64px; color: var(--gold); }
.score-label { font-size: 14px; color: var(--text2); margin-top: 8px; }

/* TOOLTIP */
.tooltip {
  position: fixed;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 8px 12px;
  font-size: 12px;
  color: var(--text);
  z-index: 1000;
  pointer-events: none;
  display: none;
}

/* NOTIFICATION */
.notif {
  position: fixed;
  bottom: 24px;
  right: 24px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px 20px;
  font-size: 13px;
  z-index: 999;
  transform: translateY(80px);
  opacity: 0;
  transition: all 0.3s;
}
.notif.show { transform: translateY(0); opacity: 1; }
.notif.green { border-color: var(--teal); color: var(--teal2); }
.notif.red { border-color: var(--red2); color: var(--red2); }

/* SCROLLBAR */
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

/* SEARCH */
.search-box {
  width: 100%;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 10px 16px;
  color: var(--text);
  font-size: 14px;
  font-family: 'Sarabun';
  margin-bottom: 16px;
}
.search-box:focus { outline: none; border-color: var(--red2); }

/* INFO BOX */
.info-box {
  background: rgba(22,160,133,0.1);
  border: 1px solid var(--teal);
  border-radius: 8px;
  padding: 14px 16px;
  font-size: 13px;
  color: var(--teal2);
  margin-bottom: 16px;
  line-height: 1.6;
}
.warn-box {
  background: rgba(212,160,23,0.1);
  border: 1px solid var(--gold);
  border-radius: 8px;
  padding: 14px 16px;
  font-size: 13px;
  color: var(--gold2);
  margin-bottom: 16px;
  line-height: 1.6;
}

/* LEVEL BADGE */
.level-pill {
  display: inline-block;
  padding: 3px 10px;
  border-radius: 20px;
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 1px;
  margin-right: 6px;
}
.N5 { background: rgba(192,57,43,0.25); color: #e74c3c; border: 1px solid #c0392b; }
.N4 { background: rgba(212,160,23,0.25); color: #f0c040; border: 1px solid #d4a017; }
.N3 { background: rgba(22,160,133,0.25); color: #1abc9c; border: 1px solid #16a085; }

/* SECTION DIVIDER */
.divider { height: 1px; background: var(--border); margin: 24px 0; }

/* ANIMATE KANA */
@keyframes pop { 0%{transform:scale(1)} 50%{transform:scale(1.3)} 100%{transform:scale(1)} }
.kana-cell.pop { animation: pop 0.3s ease; }


/* KANA GAME CARDS */
.kg-game-card {
  background:var(--surface);
  border:2px solid var(--border);
  border-radius:14px;
  padding:20px;
  cursor:pointer;
  transition:all 0.2s;
  position:relative;
  overflow:hidden;
}
.kg-game-card::before {
  content:'';position:absolute;top:0;right:0;width:100px;height:100px;
  background:radial-gradient(circle at top right,rgba(212,160,23,0.08),transparent);
}
.kg-game-card:hover { border-color:var(--gold);transform:translateY(-3px);box-shadow:0 8px 24px rgba(212,160,23,0.15); }
.kg-title { font-size:17px;font-weight:700;color:var(--white);margin-bottom:6px; }
.kg-desc { font-size:12px;color:var(--text2);line-height:1.6; }
.kg-tag { font-size:10px;padding:3px 8px;border-radius:10px;display:inline-block; }
.kg-tag.red { background:rgba(192,57,43,0.2);color:var(--red2);border:1px solid var(--red); }
.kg-tag.gold { background:rgba(212,160,23,0.2);color:var(--gold2);border:1px solid var(--gold); }
.kg-tag.teal { background:rgba(22,160,133,0.2);color:var(--teal2);border:1px solid var(--teal); }
.kg-tag.purple { background:rgba(155,89,182,0.2);color:#bb8fce;border:1px solid #8e44ad; }
.kg-tag.blue { background:rgba(52,152,219,0.2);color:#5dade2;border:1px solid #2980b9; }
.kg-tag.orange { background:rgba(230,126,34,0.2);color:#eb984e;border:1px solid #e67e22; }

/* GAME ANIMATIONS */
@keyframes kgPop { 0%{transform:scale(0.8);opacity:0} 60%{transform:scale(1.1)} 100%{transform:scale(1);opacity:1} }
@keyframes kgShake { 0%{transform:translateX(0)} 25%{transform:translateX(-8px)} 50%{transform:translateX(8px)} 75%{transform:translateX(-4px)} 100%{transform:translateX(0)} }
@keyframes kgFloat { 0%{opacity:1;transform:translateY(0)} 100%{opacity:0;transform:translateY(-36px)} }

</style>
</head>
<body>

<!-- SIDEBAR -->
<nav class="sidebar">
  <div class="logo">
    <div class="jp">Êó•Êú¨Ë™ûÂ≠¶Áøí</div>
    <div class="sub">Japanese Learning</div>
  </div>

  <div class="nav-section">
    <div class="nav-label">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</div>
    <div class="nav-item active" onclick="showPage('dashboard')">
      <span class="icon">üè†</span> ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
    </div>
    <div class="nav-item" onclick="showPage('roadmap')">
      <span class="icon">üó∫Ô∏è</span> ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
    </div>
  </div>

  <div class="nav-section">
    <div class="nav-label">‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
    <div class="nav-item" onclick="showPage('hiragana')">
      <span class="icon">„ÅÇ</span> Hiragana
      <span class="nav-progress" id="np-hira">0/46</span>
    </div>
    <div class="nav-item" onclick="showPage('katakana')">
      <span class="icon">„Ç¢</span> Katakana
      <span class="nav-progress" id="np-kata">0/46</span>
    </div>
  </div>

  <div class="nav-section">
    <div class="nav-label">‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå</div>
    <div class="nav-item" onclick="showPage('grammar')">
      <span class="icon">üìñ</span> Grammar N5-N4
    </div>
    <div class="nav-item" onclick="showPage('particles')">
      <span class="icon">‚ö°</span> Particles
    </div>
  </div>

  <div class="nav-section">
    <div class="nav-label">‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</div>
    <div class="nav-item" onclick="showPage('vocab')">
      <span class="icon">üìö</span> Vocabulary
      <span class="nav-progress" id="np-vocab">0/150</span>
    </div>
    <div class="nav-item" onclick="showPage('kanji')">
      <span class="icon">Êº¢</span> Kanji N5
      <span class="nav-progress" id="np-kanji">0/80</span>
    </div>
  </div>

  <div class="nav-section">
    <div class="nav-label">‡∏ù‡∏∂‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞</div>
    <div class="nav-item" onclick="showPage('quiz')">
      <span class="icon">üéØ</span> Quiz Mode
    </div>
    <div class="nav-item" onclick="showPage('flashcard')">
      <span class="icon">üÉè</span> Flashcards
    </div>
    <div class="nav-item" onclick="showPage('kanagames')" style="background:linear-gradient(90deg,rgba(212,160,23,0.15),transparent);border-left:3px solid var(--gold)">
      <span class="icon">üéÆ</span> <b style="color:var(--gold2)">Kana Games!</b>
      <span class="nav-progress" style="background:var(--gold);color:#000">NEW</span>
    </div>
  </div>

  <div class="nav-section">
    <div class="nav-label">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Manga/Game</div>
    <div class="nav-item" onclick="showPage('mangavocab')">
      <span class="icon">üìï</span> Manga Vocab
    </div>
    <div class="nav-item" onclick="showPage('tools')">
      <span class="icon">üîß</span> Tools & Apps
    </div>
  </div>
</nav>

<!-- MAIN CONTENT -->
<main class="main">

<!-- ===================== DASHBOARD ===================== -->
<div class="page active" id="page-dashboard">
  <div class="page-header">
    <h1>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö üëã</h1>
    <div class="jp-title">„Çà„ÅÜ„Åì„Åù ‚Äî Y≈çkoso</div>
    <p>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
  </div>

  <div class="grid4" style="margin-bottom:24px">
    <div class="stat-card">
      <div class="stat-num" id="s-hira">0</div>
      <div class="stat-label">Hiragana ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÑ‡∏î‡πâ</div>
      <div class="progress-bar" style="margin-top:12px"><div class="progress-fill" id="pb-hira" style="width:0%"></div></div>
    </div>
    <div class="stat-card">
      <div class="stat-num" id="s-kata">0</div>
      <div class="stat-label">Katakana ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÑ‡∏î‡πâ</div>
      <div class="progress-bar" style="margin-top:12px"><div class="progress-fill" id="pb-kata" style="width:0%"></div></div>
    </div>
    <div class="stat-card">
      <div class="stat-num" id="s-vocab">0</div>
      <div class="stat-label">‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å</div>
      <div class="progress-bar" style="margin-top:12px"><div class="progress-fill" id="pb-vocab" style="width:0%"></div></div>
    </div>
    <div class="stat-card">
      <div class="stat-num" id="s-kanji">0</div>
      <div class="stat-label">Kanji N5 ‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å</div>
      <div class="progress-bar" style="margin-top:12px"><div class="progress-fill" id="pb-kanji" style="width:0%"></div></div>
    </div>
  </div>

  <div class="grid2">
    <div class="card">
      <div class="card-title">üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
      <div class="card-sub">‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
      <div id="daily-goals">
        <label style="display:flex;gap:10px;align-items:center;padding:10px 0;border-bottom:1px solid var(--border);cursor:pointer;font-size:14px;color:var(--text2)">
          <input type="checkbox" id="goal1" onchange="checkGoal()" style="accent-color:var(--red2)">
          ‚ö° ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô Anki 15 ‡∏ô‡∏≤‡∏ó‡∏µ
        </label>
        <label style="display:flex;gap:10px;align-items:center;padding:10px 0;border-bottom:1px solid var(--border);cursor:pointer;font-size:14px;color:var(--text2)">
          <input type="checkbox" id="goal2" onchange="checkGoal()" style="accent-color:var(--red2)">
          üìñ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô Grammar 1 ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠
        </label>
        <label style="display:flex;gap:10px;align-items:center;padding:10px 0;border-bottom:1px solid var(--border);cursor:pointer;font-size:14px;color:var(--text2)">
          <input type="checkbox" id="goal3" onchange="checkGoal()" style="accent-color:var(--red2)">
          „ÅÇ ‡∏ù‡∏∂‡∏Å Kana Flashcard
        </label>
        <label style="display:flex;gap:10px;align-items:center;padding:10px 0;cursor:pointer;font-size:14px;color:var(--text2)">
          <input type="checkbox" id="goal4" onchange="checkGoal()" style="accent-color:var(--red2)">
          üéØ ‡∏ó‡∏≥ Quiz 10 ‡∏Ç‡πâ‡∏≠
        </label>
      </div>
      <div id="goal-congrats" style="display:none;text-align:center;padding:20px">
        <div style="font-size:36px">üéâ</div>
        <div style="font-size:14px;color:var(--gold2);margin-top:8px">‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ!</div>
        <div style="font-size:12px;color:var(--text2);margin-top:4px">„Çà„Åè„Åß„Åç„Åæ„Åó„Åü ‚Äî Yoku dekimashita!</div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">üìä Level ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
      <div class="card-sub">‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
      <div id="level-indicator" style="text-align:center;padding:20px">
        <div style="font-size:40px">ü•ö</div>
        <div style="font-size:20px;color:var(--gold);font-weight:700;margin-top:8px">Beginner</div>
        <div style="font-size:12px;color:var(--text2);margin-top:4px">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á ‚Äî ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô Hiragana ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡∏¢!</div>
        <div style="margin-top:16px">
          <button class="btn btn-primary" onclick="showPage('hiragana')" style="font-size:13px">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏¢ ‚Üí Hiragana</button>
        </div>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:0">
    <div class="card-title">üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
    <div id="daily-tip" style="font-size:14px;color:var(--text2);line-height:1.7;padding:12px 0"></div>
  </div>

  <div class="card">
    <div class="card-title">‚ö° ‡∏ó‡∏≤‡∏á‡∏•‡∏±‡∏î ‚Äî ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡πà‡∏ß‡∏ô</div>
    <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:8px">
      <button class="btn btn-primary" onclick="showPage('hiragana')">„ÅÇ Hiragana</button>
      <button class="btn btn-outline" onclick="showPage('katakana')">„Ç¢ Katakana</button>
      <button class="btn btn-gold" onclick="showPage('quiz')">üéØ Quiz</button>
      <button class="btn btn-outline" onclick="showPage('grammar')">üìñ Grammar</button>
      <button class="btn btn-success" onclick="showPage('vocab')">üìö Vocab</button>
      <button class="btn btn-outline" onclick="showPage('tools')">üîß Tools</button>
    </div>
  </div>
</div>

<!-- ===================== ROADMAP ===================== -->
<div class="page" id="page-roadmap">
  <div class="page-header">
    <h1>‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
    <div class="jp-title">Â≠¶ÁøíË®àÁîª ‚Äî Gakush≈´ Keikaku</div>
    <p>‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 12-18 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏™‡∏π‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞ ‡πÄ‡∏Å‡∏°‡∏™‡πå ‡πÅ‡∏•‡∏∞ VN ‡πÑ‡∏î‡πâ‡∏™‡∏ö‡∏≤‡∏¢</p>
  </div>

  <div class="grid2">
    <div class="card">
      <div class="card-title">üó∫Ô∏è Timeline</div>
      <div class="card-sub">‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πà‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏µ‡∏ö</div>
      <div class="roadmap">
        <div class="roadmap-item">
          <div class="roadmap-dot current"></div>
          <div class="roadmap-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 1-2</div>
          <h4>üî§ Hiragana + Katakana</h4>
          <p>‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 92 ‡∏ï‡∏±‡∏ß ‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 2 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á</p>
        </div>
        <div class="roadmap-item">
          <div class="roadmap-dot"></div>
          <div class="roadmap-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 2-4</div>
          <h4>üìñ Grammar N5 + Vocabulary</h4>
          <p>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô grammar ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô particles, verb forms, ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå 500 ‡∏Ñ‡∏≥‡πÅ‡∏£‡∏Å</p>
        </div>
        <div class="roadmap-item">
          <div class="roadmap-dot"></div>
          <div class="roadmap-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 4-6</div>
          <h4>Êº¢ Kanji N5 + Grammar N4</h4>
          <p>Kanji 80 ‡∏ï‡∏±‡∏ß‡∏£‡∏∞‡∏î‡∏±‡∏ö N5, grammar ‡∏Ç‡∏¢‡∏≤‡∏¢, ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡πà‡∏≤‡∏ô manga ‡πÄ‡∏î‡πá‡∏Å‡∏á‡πà‡∏≤‡∏¢‡πÜ</p>
        </div>
        <div class="roadmap-item">
          <div class="roadmap-dot"></div>
          <div class="roadmap-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 6-9</div>
          <h4>üìï ‡∏≠‡πà‡∏≤‡∏ô Manga ‡∏à‡∏£‡∏¥‡∏á</h4>
          <p>‡πÉ‡∏ä‡πâ Yomichan + Mokuro ‡∏≠‡πà‡∏≤‡∏ô manga ‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö ‡πÄ‡∏ô‡πâ‡∏ô input ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡∏±‡∏Å</p>
        </div>
        <div class="roadmap-item">
          <div class="roadmap-dot"></div>
          <div class="roadmap-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 9-12</div>
          <h4>üéÆ ‡πÄ‡∏•‡πà‡∏ô VN / ‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</h4>
          <p>‡πÉ‡∏ä‡πâ Textractor ‡∏î‡∏∂‡∏á text ‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°‡∏™‡πå, ‡∏≠‡πà‡∏≤‡∏ô VN ‡∏î‡πâ‡∏ß‡∏¢ Yomichan</p>
        </div>
        <div class="roadmap-item">
          <div class="roadmap-dot"></div>
          <div class="roadmap-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 12-18</div>
          <h4>üîû Adult Content</h4>
          <p>‡∏≠‡πà‡∏≤‡∏ô adult manga, ‡πÄ‡∏•‡πà‡∏ô adult VN/game ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏ö‡∏≤‡∏¢</p>
        </div>
      </div>
    </div>

    <div>
      <div class="card">
        <div class="card-title">üìÖ Daily Routine</div>
        <div class="card-sub">30-60 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô ‡∏Ñ‡∏∑‡∏≠ ideal</div>
        <div style="display:flex;flex-direction:column;gap:12px;margin-top:8px">
          <div style="display:flex;gap:12px;align-items:flex-start">
            <div style="background:var(--red2);color:white;border-radius:6px;padding:4px 8px;font-size:11px;min-width:70px;text-align:center">15 ‡∏ô‡∏≤‡∏ó‡∏µ</div>
            <div>
              <div style="font-size:13px;font-weight:600;color:var(--white)">Anki SRS</div>
              <div style="font-size:12px;color:var(--text2)">‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå/Kanji ‡πÅ‡∏ö‡∏ö spaced repetition</div>
            </div>
          </div>
          <div style="display:flex;gap:12px;align-items:flex-start">
            <div style="background:var(--gold);color:#000;border-radius:6px;padding:4px 8px;font-size:11px;min-width:70px;text-align:center">15 ‡∏ô‡∏≤‡∏ó‡∏µ</div>
            <div>
              <div style="font-size:13px;font-weight:600;color:var(--white)">Grammar</div>
              <div style="font-size:12px;color:var(--text2)">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå 1 topic ‡∏à‡∏≤‡∏Å Genki / Tae Kim</div>
            </div>
          </div>
          <div style="display:flex;gap:12px;align-items:flex-start">
            <div style="background:var(--teal);color:white;border-radius:6px;padding:4px 8px;font-size:11px;min-width:70px;text-align:center">30 ‡∏ô‡∏≤‡∏ó‡∏µ</div>
            <div>
              <div style="font-size:13px;font-weight:600;color:var(--white)">Immersion</div>
              <div style="font-size:12px;color:var(--text2)">‡∏≠‡πà‡∏≤‡∏ô manga / ‡∏î‡∏π‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏∞ / ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">üìö ‡πÅ‡∏´‡∏•‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</div>
        <div style="font-size:13px;color:var(--text2);line-height:2">
          <div>üìó <b style="color:var(--white)">Genki I & II</b> ‚Äî ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ô Grammar ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
          <div>üåê <b style="color:var(--white)">Tae Kim's Guide</b> ‚Äî ‡πÄ‡∏ß‡πá‡∏ö/App ‡∏ü‡∏£‡∏µ ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</div>
          <div>üé• <b style="color:var(--white)">Cure Dolly</b> ‚Äî YouTube ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à logic ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</div>
          <div>üì± <b style="color:var(--white)">Anki</b> ‚Äî SRS App ‡∏ó‡πà‡∏≠‡∏á vocab/kanji</div>
          <div>üåè <b style="color:var(--white)">Bunpro.jp</b> ‚Äî ‡∏ù‡∏∂‡∏Å grammar ‡πÅ‡∏ö‡∏ö SRS</div>
          <div>üìñ <b style="color:var(--white)">Jisho.org</b> ‚Äî Dictionary ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">üéØ Manga ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</div>
        <div style="font-size:13px;color:var(--text2);line-height:2">
          <div>üåü <b style="color:var(--white)">Yotsubato! („Çà„Å§„Å∞„Å®!)</b> ‚Äî ‡∏†‡∏≤‡∏©‡∏≤‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
          <div>üîµ <b style="color:var(--white)">Doraemon</b> ‚Äî ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</div>
          <div>üü° <b style="color:var(--white)">Shirokuma Cafe</b> ‚Äî ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏™‡∏±‡πâ‡∏ô</div>
          <div>üî¥ <b style="color:var(--white)">Dragon Ball</b> ‚Äî action vocab</div>
          <div>üü£ <b style="color:var(--white)">One Piece</b> ‚Äî ‡∏´‡∏•‡∏±‡∏á N4 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== HIRAGANA ===================== -->
<div class="page" id="page-hiragana">
  <div class="page-header">
    <h1>Hiragana ‚Äî „Å≤„Çâ„Åå„Å™</h1>
    <div class="jp-title">‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô 46 ‡∏ï‡∏±‡∏ß</div>
    <p>‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡πÅ‡∏ó‡πâ ‡πÅ‡∏•‡∏∞ grammar particles ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß</p>
  </div>

  <div class="tabs">
    <div class="tab" onclick="switchTab('hira','daily');dlInit('hira')">üìÖ Daily Learning ‚ú®</div>
    <div class="tab active" onclick="switchTab('hira','chart')">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
    <div class="tab" onclick="switchTab('hira','flash')">üÉè Flashcard</div>
    <div class="tab" onclick="switchTab('hira','quiz')">üéØ Quiz</div>
    <div class="tab" onclick="switchTab('hira','combo')">üî§ Combo chars</div>
  </div>

  <div class="tab-panel" id="hira-daily"><div id="hira-dl-root"></div></div>

  <div class="tab-panel active" id="hira-chart">
    <div class="info-box">üí° ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ "‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß" ‚Äî ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ ‚úì ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏Ñ‡∏∑‡∏≠‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß</div>
    <div class="kana-grid" id="hira-grid"></div>
    <div style="display:flex;gap:12px;margin-top:16px">
      <button class="btn btn-primary" onclick="markAllKana('hira')">‚úì ‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      <button class="btn btn-outline" onclick="clearAllKana('hira')">üóëÔ∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
    </div>
  </div>

  <div class="tab-panel" id="hira-flash">
    <div class="flashcard-container">
      <div style="text-align:center;color:var(--text2);font-size:13px" id="hira-fc-info">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô</div>
      <div class="flashcard" id="hira-fc" onclick="flipCard('hira')">
        <div class="flashcard-inner">
          <div class="card-face card-front">
            <div class="card-char" id="hira-char">„ÅÇ</div>
            <div class="card-hint">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô</div>
          </div>
          <div class="card-face card-back">
            <div class="card-reading" id="hira-read">a</div>
            <div class="card-hint">„Å≤„Çâ„Åå„Å™</div>
          </div>
        </div>
      </div>
      <div class="fc-controls">
        <button class="btn btn-outline" onclick="prevCard('hira')">‚Üê ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
        <button class="btn btn-success" onclick="markKnown('hira')" id="hira-known-btn">‚úì ‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß</button>
        <button class="btn btn-primary" onclick="nextCard('hira')">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
      </div>
      <div style="font-size:12px;color:var(--text2)" id="hira-fc-counter">1 / 46</div>
    </div>
  </div>

  <div class="tab-panel" id="hira-quiz">
    <div id="hira-quiz-area">
      <div class="flashcard-container">
        <div style="font-size:13px;color:var(--text2)">‡πÇ‡∏£‡∏°‡∏≤‡∏à‡∏¥‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</div>
        <div style="font-size:80px;font-family:'Noto Serif JP';text-align:center;padding:20px;background:var(--surface);border-radius:16px;width:200px;border:2px solid var(--border)" id="hira-quiz-char">„ÅÇ</div>
        <div class="quiz-options" id="hira-quiz-opts"></div>
        <div id="hira-quiz-result" style="font-size:16px;font-weight:600;height:24px;text-align:center"></div>
        <div style="display:flex;gap:12px;align-items:center">
          <button class="btn btn-primary" onclick="nextQuizQ('hira')" id="hira-next-btn" style="display:none">‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‚Üí</button>
          <div style="font-size:12px;color:var(--text2)" id="hira-quiz-score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0/0</div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-panel" id="hira-combo">
    <div class="info-box">üî§ ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ú‡∏™‡∏° (Y≈çon) ‚Äî ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏° „ÇÑ, „ÇÜ, „Çà ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å‡∏´‡∏•‡∏±‡∏á consonant</div>
    <div class="kana-grid" style="grid-template-columns:repeat(8,1fr)" id="hira-combo-grid"></div>
  </div>
</div>

<!-- ===================== KATAKANA ===================== -->
<div class="page" id="page-katakana">
  <div class="page-header">
    <h1>Katakana ‚Äî „Ç´„Çø„Ç´„Éä</h1>
    <div class="jp-title">‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏±‡∏ö‡∏®‡∏±‡∏û‡∏ó‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥</div>
    <p>‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏Ñ‡∏≥‡∏ó‡∏±‡∏ö‡∏®‡∏±‡∏û‡∏ó‡πå ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢</p>
  </div>

  <div class="tabs">
    <div class="tab" onclick="switchTab('kata','daily');dlInit('kata')">üìÖ Daily Learning ‚ú®</div>
    <div class="tab active" onclick="switchTab('kata','chart')">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
    <div class="tab" onclick="switchTab('kata','flash')">üÉè Flashcard</div>
    <div class="tab" onclick="switchTab('kata','quiz')">üéØ Quiz</div>
  </div>

  <div class="tab-panel" id="kata-daily"><div id="kata-dl-root"></div></div>

  <div class="tab-panel active" id="kata-chart">
    <div class="info-box">üí° Katakana ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ Hiragana ‡πÅ‡∏ï‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏Å‡∏ß‡πà‡∏≤ ‡πÄ‡∏´‡πá‡∏ô‡∏ö‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞ (‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á) ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥</div>
    <div class="kana-grid" id="kata-grid"></div>
    <div style="display:flex;gap:12px;margin-top:16px">
      <button class="btn btn-primary" onclick="markAllKana('kata')">‚úì ‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      <button class="btn btn-outline" onclick="clearAllKana('kata')">üóëÔ∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
    </div>
  </div>

  <div class="tab-panel" id="kata-flash">
    <div class="flashcard-container">
      <div style="text-align:center;color:var(--text2);font-size:13px">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô</div>
      <div class="flashcard" id="kata-fc" onclick="flipCard('kata')">
        <div class="flashcard-inner">
          <div class="card-face card-front">
            <div class="card-char" id="kata-char">„Ç¢</div>
            <div class="card-hint">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô</div>
          </div>
          <div class="card-face card-back">
            <div class="card-reading" id="kata-read">a</div>
            <div class="card-hint">„Ç´„Çø„Ç´„Éä</div>
          </div>
        </div>
      </div>
      <div class="fc-controls">
        <button class="btn btn-outline" onclick="prevCard('kata')">‚Üê ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
        <button class="btn btn-success" onclick="markKnown('kata')">‚úì ‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß</button>
        <button class="btn btn-primary" onclick="nextCard('kata')">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
      </div>
      <div style="font-size:12px;color:var(--text2)" id="kata-fc-counter">1 / 46</div>
    </div>
  </div>

  <div class="tab-panel" id="kata-quiz">
    <div class="flashcard-container">
      <div style="font-size:13px;color:var(--text2)">‡πÇ‡∏£‡∏°‡∏≤‡∏à‡∏¥‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</div>
      <div style="font-size:80px;font-family:'Noto Serif JP';text-align:center;padding:20px;background:var(--surface);border-radius:16px;width:200px;border:2px solid var(--border)" id="kata-quiz-char">„Ç¢</div>
      <div class="quiz-options" id="kata-quiz-opts"></div>
      <div id="kata-quiz-result" style="font-size:16px;font-weight:600;height:24px;text-align:center"></div>
      <div style="display:flex;gap:12px;align-items:center">
        <button class="btn btn-primary" onclick="nextQuizQ('kata')" id="kata-next-btn" style="display:none">‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‚Üí</button>
        <div style="font-size:12px;color:var(--text2)" id="kata-quiz-score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0/0</div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== GRAMMAR ===================== -->
<div class="page" id="page-grammar">
  <div class="page-header">
    <h1>Grammar ‚Äî ‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå</h1>
    <div class="jp-title">ÊñáÊ≥ï ‚Äî Bunp≈ç (N5 ‚Üí N4)</div>
    <p>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ</p>
  </div>

  <div class="tabs">
    <div class="tab active" onclick="switchTab('gram','n5')">üî¥ N5 Grammar</div>
    <div class="tab" onclick="switchTab('gram','n4')">üü° N4 Grammar</div>
    <div class="tab" onclick="switchTab('gram','verb')">üîµ Verb Forms</div>
  </div>

  <div class="tab-panel active" id="gram-n5" id="gram-n5-content"></div>
  <div class="tab-panel" id="gram-n4" id="gram-n4-content"></div>
  <div class="tab-panel" id="gram-verb" id="gram-verb-content"></div>
</div>

<!-- ===================== PARTICLES ===================== -->
<div class="page" id="page-particles">
  <div class="page-header">
    <h1>Particles ‚Äî ‡∏Ñ‡∏≥‡∏ä‡πà‡∏ß‡∏¢</h1>
    <div class="jp-title">Âä©Ë©û ‚Äî Joshi</div>
    <p>Particles ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô ‡∏ö‡∏≠‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏≥‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ</p>
  </div>
  <div id="particles-content"></div>
</div>

<!-- ===================== VOCAB ===================== -->
<div class="page" id="page-vocab">
  <div class="page-header">
    <h1>Vocabulary ‚Äî ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</h1>
    <div class="jp-title">Ë™ûÂΩô ‚Äî Goi</div>
    <p>‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö N5-N4 ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏±‡∏á‡∏á‡∏∞/‡πÄ‡∏Å‡∏°‡∏™‡πå</p>
  </div>

  <div class="tabs">
    <div class="tab active" onclick="switchTab('voc','n5')">üî¥ N5 Vocab</div>
    <div class="tab" onclick="switchTab('voc','n4')">üü° N4 Vocab</div>
    <div class="tab" onclick="switchTab('voc','manga')">üìï Manga/Game</div>
    <div class="tab" onclick="switchTab('voc','srs')">üé¥ SRS Review</div>
  </div>

  <div class="tab-panel active" id="voc-n5">
    <input class="search-box" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå..." oninput="filterVocab(this.value,'n5')">
    <div class="vocab-list" id="vocab-list-n5"></div>
  </div>
  <div class="tab-panel" id="voc-n4">
    <input class="search-box" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå..." oninput="filterVocab(this.value,'n4')">
    <div class="vocab-list" id="vocab-list-n4"></div>
  </div>
  <div class="tab-panel" id="voc-manga">
    <div class="warn-box">‚ö†Ô∏è ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞ ‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô ‡πÄ‡∏Å‡∏°‡∏™‡πå ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô Adult content</div>
    <input class="search-box" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå..." oninput="filterVocab(this.value,'manga')">
    <div class="vocab-list" id="vocab-list-manga"></div>
  </div>
  <div class="tab-panel" id="voc-srs">
    <div class="flashcard-container">
      <div style="font-size:13px;color:var(--text2);text-align:center">SRS Review ‚Äî ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏°‡πà‡∏ô<br>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢</div>
      <div class="flashcard" id="vocab-srs-fc" onclick="flipCard('vsrs')" style="width:340px;height:220px">
        <div class="flashcard-inner">
          <div class="card-face card-front" style="flex-direction:column;gap:8px">
            <div style="font-family:'Noto Sans JP';font-size:36px;color:white" id="vsrs-jp">È£ü„Åπ„Çã</div>
            <div style="font-size:14px;color:var(--text2)" id="vsrs-ro">taberu</div>
            <div style="font-size:11px;color:var(--text3)">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢</div>
          </div>
          <div class="card-face card-back">
            <div style="font-size:24px;color:white;font-weight:600" id="vsrs-th">‡∏Å‡∏¥‡∏ô</div>
          </div>
        </div>
      </div>
      <div class="fc-controls" id="vsrs-btns" style="display:none">
        <button class="btn btn-outline" onclick="rateSRS('hard')" style="background:rgba(192,57,43,0.2);color:var(--red2);border-color:var(--red)">üò∞ ‡∏¢‡∏≤‡∏Å</button>
        <button class="btn btn-outline" onclick="rateSRS('ok')" style="background:rgba(212,160,23,0.2);color:var(--gold2);border-color:var(--gold)">üòê ‡∏û‡∏≠‡πÑ‡∏î‡πâ</button>
        <button class="btn btn-success" onclick="rateSRS('easy')">üòä ‡∏á‡πà‡∏≤‡∏¢</button>
      </div>
      <div style="font-size:12px;color:var(--text2)" id="vsrs-counter">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 0 ‡∏Ñ‡∏≥</div>
    </div>
  </div>
</div>

<!-- ===================== KANJI ===================== -->
<div class="page" id="page-kanji">
  <div class="page-header">
    <h1>Kanji N5 ‚Äî Êº¢Â≠ó</h1>
    <div class="jp-title">80 Kanji ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</div>
    <p>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡∏•‡∏∞ 5 ‡∏ï‡∏±‡∏ß‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á</p>
  </div>
  <div class="tabs">
    <div class="tab" onclick="switchTab('kj','daily');dlInit('kj')">üìÖ Daily Learning ‚ú®</div>
    <div class="tab active" onclick="switchTab('kj','browse')">üìñ ‡∏î‡∏π Kanji ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
  </div>
  <div class="tab-panel" id="kj-daily"><div id="kj-dl-root"></div></div>
  <div class="tab-panel active" id="kj-browse">
  <div class="grid4" id="kanji-grid" style="grid-template-columns:repeat(auto-fill,minmax(140px,1fr))"></div>
  </div><!-- end kj-browse -->
  <div id="kanji-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:500;display:none;align-items:center;justify-content:center">
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:32px;max-width:400px;width:90%;text-align:center">
      <div style="font-family:'Noto Serif JP';font-size:80px;color:white" id="km-char"></div>
      <div style="font-size:14px;color:var(--red2);margin-top:8px" id="km-on"></div>
      <div style="font-size:14px;color:var(--teal2);margin-top:4px" id="km-kun"></div>
      <div style="font-size:16px;color:white;margin-top:12px;font-weight:600" id="km-meaning"></div>
      <div style="font-size:12px;color:var(--text2);margin-top:8px" id="km-examples"></div>
      <div style="margin-top:20px;display:flex;gap:12px;justify-content:center">
        <button class="btn btn-success" onclick="markKanjiKnown()">‚úì ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß</button>
        <button class="btn btn-outline" onclick="closeKanjiModal()">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </div>
</div>

<!-- ===================== QUIZ ===================== -->
<div class="page" id="page-quiz">
  <div class="page-header">
    <h1>Quiz Mode</h1>
    <div class="jp-title">„ÉÜ„Çπ„Éà ‚Äî Tesuto</div>
    <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏° ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå ‡πÅ‡∏•‡∏∞‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå</p>
  </div>

  <div id="quiz-select">
    <div class="grid3">
      <div class="card" style="cursor:pointer;transition:all 0.2s" onclick="startQuiz('hira')" onmouseover="this.style.borderColor='var(--red2)'" onmouseout="this.style.borderColor='var(--border)'">
        <div style="font-size:40px;text-align:center;margin-bottom:12px">„ÅÇ</div>
        <div class="card-title" style="justify-content:center">Hiragana Quiz</div>
        <div class="card-sub" style="text-align:center">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ Hiragana 46 ‡∏ï‡∏±‡∏ß</div>
      </div>
      <div class="card" style="cursor:pointer;transition:all 0.2s" onclick="startQuiz('kata')" onmouseover="this.style.borderColor='var(--gold)'" onmouseout="this.style.borderColor='var(--border)'">
        <div style="font-size:40px;text-align:center;margin-bottom:12px">„Ç¢</div>
        <div class="card-title" style="justify-content:center">Katakana Quiz</div>
        <div class="card-sub" style="text-align:center">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ Katakana 46 ‡∏ï‡∏±‡∏ß</div>
      </div>
      <div class="card" style="cursor:pointer;transition:all 0.2s" onclick="startQuiz('vocab')" onmouseover="this.style.borderColor='var(--teal)'" onmouseout="this.style.borderColor='var(--border)'">
        <div style="font-size:40px;text-align:center;margin-bottom:12px">üìö</div>
        <div class="card-title" style="justify-content:center">Vocabulary Quiz</div>
        <div class="card-sub" style="text-align:center">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå N5 ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</div>
      </div>
    </div>
  </div>

  <div id="quiz-game" style="display:none">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
        <div style="font-size:14px;color:var(--text2)" id="qg-title">Hiragana Quiz</div>
        <div style="display:flex;gap:16px;align-items:center">
          <div style="font-size:13px;color:var(--text2)" id="qg-progress">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1/10</div>
          <div style="font-size:13px;color:var(--gold)" id="qg-score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0</div>
        </div>
      </div>
      <div class="progress-bar" style="margin-bottom:24px"><div class="progress-fill" id="qg-pb" style="width:10%"></div></div>
      <div style="text-align:center;font-family:'Noto Serif JP';font-size:72px;color:white;padding:20px" id="qg-char"></div>
      <div style="font-size:13px;text-align:center;color:var(--text2);margin-bottom:16px" id="qg-question"></div>
      <div class="quiz-options" id="qg-opts" style="max-width:500px;margin:0 auto"></div>
      <div style="text-align:center;margin-top:16px">
        <div style="font-size:16px;font-weight:600;height:28px" id="qg-result"></div>
        <button class="btn btn-primary" id="qg-next" style="display:none;margin-top:8px" onclick="nextQGQuestion()">‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‚Üí</button>
      </div>
    </div>
  </div>

  <div id="quiz-result" style="display:none">
    <div class="card" style="text-align:center">
      <div style="font-size:48px;margin-bottom:16px" id="qr-emoji">üéâ</div>
      <div class="score-display">
        <div class="score-num" id="qr-score">0</div>
        <div class="score-label" id="qr-label">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
      </div>
      <div style="font-size:16px;color:var(--text2);margin:16px 0" id="qr-msg"></div>
      <div style="display:flex;gap:12px;justify-content:center;margin-top:20px">
        <button class="btn btn-primary" id="qr-retry">üîÑ ‡∏ó‡∏≥‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn btn-outline" onclick="showPage('quiz')">‚Üê ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Quiz ‡πÉ‡∏´‡∏°‡πà</button>
      </div>
    </div>
  </div>
</div>

<!-- ===================== FLASHCARD ===================== -->
<div class="page" id="page-flashcard">
  <div class="page-header">
    <h1>Flashcards</h1>
    <div class="jp-title">„Éï„É©„ÉÉ„Ç∑„É•„Ç´„Éº„Éâ ‚Äî Furashhu kƒÅdo</div>
    <p>‡∏ù‡∏∂‡∏Å‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö flashcard ‡∏û‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</p>
  </div>

  <div class="grid2">
    <div class="card">
      <div class="card-title">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î Flashcard</div>
      <div style="display:flex;flex-direction:column;gap:10px;margin-top:12px">
        <button class="btn btn-outline" onclick="loadFC('hira')" style="text-align:left;padding:14px">„ÅÇ Hiragana (46 ‡∏ï‡∏±‡∏ß)</button>
        <button class="btn btn-outline" onclick="loadFC('kata')" style="text-align:left;padding:14px">„Ç¢ Katakana (46 ‡∏ï‡∏±‡∏ß)</button>
        <button class="btn btn-outline" onclick="loadFC('n5v')" style="text-align:left;padding:14px">üìö N5 Vocabulary</button>
        <button class="btn btn-outline" onclick="loadFC('kj')" style="text-align:left;padding:14px">Êº¢ Kanji N5</button>
      </div>
    </div>

    <div>
      <div class="flashcard-container">
        <div class="flashcard" id="main-fc" onclick="flipCard('main')" style="width:320px;height:220px">
          <div class="flashcard-inner">
            <div class="card-face card-front" style="background:linear-gradient(135deg,#1a1a2e,#22223b)">
              <div class="card-char" id="main-fc-front" style="font-size:56px">?</div>
              <div class="card-hint" id="main-fc-type">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î Flashcard ‡∏Å‡πà‡∏≠‡∏ô</div>
            </div>
            <div class="card-face card-back">
              <div class="card-reading" id="main-fc-back" style="font-size:22px">‚Äî</div>
              <div id="main-fc-extra" style="font-size:13px;color:rgba(255,255,255,0.7);margin-top:8px"></div>
            </div>
          </div>
        </div>
        <div class="fc-controls">
          <button class="btn btn-outline" onclick="mainFC_prev()">‚Üê ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
          <button class="btn btn-primary" onclick="mainFC_next()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
        </div>
        <div style="font-size:12px;color:var(--text2)" id="main-fc-counter">‚Äî</div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== MANGA VOCAB ===================== -->
<div class="page" id="page-mangavocab">
  <div class="page-header">
    <h1>Manga & Game Vocabulary</h1>
    <div class="jp-title">„Éû„É≥„Ç¨„Éª„Ç≤„Éº„É†Ë™ûÂΩô ‚Äî ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞</div>
    <p>‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞ ‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏∞ ‡πÄ‡∏Å‡∏°‡∏™‡πå VN ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á adult content</p>
  </div>

  <div class="tabs">
    <div class="tab active" onclick="switchTab('mv','action')">‚öîÔ∏è Action/Battle</div>
    <div class="tab" onclick="switchTab('mv','emotion')">üí≠ ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å</div>
    <div class="tab" onclick="switchTab('mv','daily')">üè† ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
    <div class="tab" onclick="switchTab('mv','romance')">üíï Romance/Relationship</div>
    <div class="tab" onclick="switchTab('mv','adult')">üîû Adult Content</div>
  </div>

  <div class="tab-panel active" id="mv-action">
    <div class="vocab-list" id="mvc-action"></div>
  </div>
  <div class="tab-panel" id="mv-emotion">
    <div class="vocab-list" id="mvc-emotion"></div>
  </div>
  <div class="tab-panel" id="mv-daily">
    <div class="vocab-list" id="mvc-daily"></div>
  </div>
  <div class="tab-panel" id="mv-romance">
    <div class="vocab-list" id="mvc-romance"></div>
  </div>
  <div class="tab-panel" id="mv-adult">
    <div class="warn-box">‚ö†Ô∏è ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà ‚Äî ‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡πÉ‡∏ô adult manga, doujinshi, VN 18+</div>
    <div class="vocab-list" id="mvc-adult"></div>
  </div>
</div>

<!-- ===================== TOOLS ===================== -->
<div class="page" id="page-tools">
  <div class="page-header">
    <h1>Tools & Resources</h1>
    <div class="jp-title">„ÉÑ„Éº„É´ ‚Äî Ts≈´ru</div>
    <p>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞/‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏™‡πå</p>
  </div>

  <div class="tabs">
    <div class="tab active" onclick="switchTab('tl','essential')">‚≠ê Essential</div>
    <div class="tab" onclick="switchTab('tl','manga')">üìï Manga Tools</div>
    <div class="tab" onclick="switchTab('tl','game')">üéÆ Game Tools</div>
    <div class="tab" onclick="switchTab('tl','dict')">üìñ Dictionary</div>
  </div>

  <div class="tab-panel active" id="tl-essential">
    <div class="grid3" id="tools-essential"></div>
  </div>
  <div class="tab-panel" id="tl-manga">
    <div class="grid3" id="tools-manga"></div>
  </div>
  <div class="tab-panel" id="tl-game">
    <div class="grid3" id="tools-game"></div>
  </div>
  <div class="tab-panel" id="tl-dict">
    <div class="grid3" id="tools-dict"></div>
  </div>
</div>



<!-- ===================== KANA GAMES ===================== -->
<div class="page" id="page-kanagames">
  <div class="page-header">
    <h1>üéÆ Kana Games</h1>
    <div class="jp-title">„Åã„Å™„Ç≤„Éº„É† ‚Äî ‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥ Hiragana &amp; Katakana</div>
    <p>7 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡πÄ‡∏•‡πà‡∏ô‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î ‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏¢!</p>
  </div>

  <div id="kg-lobby">
    <div style="display:flex;gap:12px;margin-bottom:24px;align-items:center;flex-wrap:wrap">
      <span style="font-size:13px;color:var(--text2)">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£:</span>
      <button id="kg-btn-hira" class="btn btn-primary" onclick="setKanaType('hira')" style="min-width:110px">„ÅÇ Hiragana</button>
      <button id="kg-btn-kata" class="btn btn-outline" onclick="setKanaType('kata')" style="min-width:110px">„Ç¢ Katakana</button>
      <button id="kg-btn-both" class="btn btn-outline" onclick="setKanaType('both')" style="min-width:110px">„ÅÇ„Ç¢ ‡∏ú‡∏™‡∏°</button>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px">
      <div class="kg-game-card" onclick="launchGame('speedblitz')">
        <div style="font-size:40px;margin-bottom:10px">‚ö°</div>
        <div class="kg-title">Speed Blitz</div>
        <div class="kg-desc">‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î! COMBO FEVER √ó3 ‚Äî 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div>
        <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap">
          <span class="kg-tag red">‚è±Ô∏è 30 ‡∏ß‡∏¥</span><span class="kg-tag gold">COMBO</span><span class="kg-tag teal">HIGH SCORE</span>
        </div>
      </div>
      <div class="kg-game-card" onclick="launchGame('survival')">
        <div style="font-size:40px;margin-bottom:10px">‚ù§Ô∏è</div>
        <div class="kg-title">Survival Mode</div>
        <div class="kg-desc">‡∏°‡∏µ 3 ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‡∏ú‡∏¥‡∏î‡∏Ñ‡∏£‡∏ö 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á = Game Over ‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ‡∏ô‡∏≤‡∏ô‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô?</div>
        <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap">
          <span class="kg-tag red">‚ù§Ô∏è 3 ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</span><span class="kg-tag gold">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏à‡∏≥‡∏Å‡∏±‡∏î</span>
        </div>
      </div>
      <div class="kg-game-card" onclick="launchGame('kanarain')">
        <div style="font-size:40px;margin-bottom:10px">üåßÔ∏è</div>
        <div class="kg-title">Kana Rain</div>
        <div class="kg-desc">‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ï‡∏Å‡∏à‡∏≤‡∏Å‡∏ü‡πâ‡∏≤! ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ñ‡∏∂‡∏á‡∏û‡∏∑‡πâ‡∏ô</div>
        <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap">
          <span class="kg-tag teal">üåßÔ∏è Arcade</span><span class="kg-tag gold">LEVEL UP</span>
        </div>
      </div>
      <div class="kg-game-card" onclick="launchGame('memory')">
        <div style="font-size:40px;margin-bottom:10px">üß©</div>
        <div class="kg-title">Memory Match</div>
        <div class="kg-desc">‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏≤‡∏Ñ‡∏π‡πà Kana ‚Üî Romaji ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥</div>
        <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap">
          <span class="kg-tag purple">üß© ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà</span><span class="kg-tag gold">TIMER</span>
        </div>
      </div>
      <div class="kg-game-card" onclick="launchGame('typeit')">
        <div style="font-size:40px;margin-bottom:10px">‚å®Ô∏è</div>
        <div class="kg-title">Type It!</div>
        <div class="kg-desc">‡∏û‡∏¥‡∏°‡∏û‡πå Romaji ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î ‚Äî ‡∏ù‡∏∂‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏∑‡∏≠‡πÑ‡∏ß‡∏à‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
        <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap">
          <span class="kg-tag blue">‚å®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå</span><span class="kg-tag red">WPM</span>
        </div>
      </div>
      <div class="kg-game-card" onclick="launchGame('reverse')">
        <div style="font-size:40px;margin-bottom:10px">üîÑ</div>
        <div class="kg-title">Reverse Quiz</div>
        <div class="kg-desc">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏õ‡πá‡∏ô Romaji ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Kana ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚Äî ‡∏¢‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥!</div>
        <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap">
          <span class="kg-tag orange">üîÑ ‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô</span><span class="kg-tag gold">HARD</span>
        </div>
      </div>
      <div class="kg-game-card" onclick="launchGame('boss')">
        <div style="font-size:40px;margin-bottom:10px">üëπ</div>
        <div class="kg-title">Boss Battle</div>
        <div class="kg-desc">‡∏ï‡∏≠‡∏ö Kana ‡∏ñ‡∏π‡∏Å = ‡πÇ‡∏à‡∏°‡∏ï‡∏µ Boss! ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å = CRITICAL HIT!</div>
        <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap">
          <span class="kg-tag red">üëπ RPG</span><span class="kg-tag gold">CRITICAL</span>
        </div>
      </div>
    </div>
    <div class="card" style="margin-top:20px">
      <div class="card-title">üèÜ High Scores</div>
      <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:10px;margin-top:12px" id="kg-hiscores"></div>
    </div>
  </div>

  <div id="kg-arena" style="display:none">
    <div style="display:flex;align-items:center;gap:16px;margin-bottom:24px;flex-wrap:wrap">
      <button class="btn btn-outline" onclick="exitGame()">‚Üê ‡∏≠‡∏≠‡∏Å</button>
      <div style="font-size:18px;font-weight:700;color:var(--white)" id="kg-arena-title"></div>
      <div style="margin-left:auto;display:flex;gap:20px;align-items:center;flex-wrap:wrap" id="kg-hud"></div>
    </div>
    <div id="kg-game-content"></div>
  </div>
</div>

</main>

<!-- NOTIFICATION -->
<div class="notif" id="notif"></div>

<script>
// ============================================================
// DATA
// ============================================================
const HIRAGANA = [
  {jp:'„ÅÇ',ro:'a'},{jp:'„ÅÑ',ro:'i'},{jp:'„ÅÜ',ro:'u'},{jp:'„Åà',ro:'e'},{jp:'„Åä',ro:'o'},
  {jp:'„Åã',ro:'ka'},{jp:'„Åç',ro:'ki'},{jp:'„Åè',ro:'ku'},{jp:'„Åë',ro:'ke'},{jp:'„Åì',ro:'ko'},
  {jp:'„Åï',ro:'sa'},{jp:'„Åó',ro:'shi'},{jp:'„Åô',ro:'su'},{jp:'„Åõ',ro:'se'},{jp:'„Åù',ro:'so'},
  {jp:'„Åü',ro:'ta'},{jp:'„Å°',ro:'chi'},{jp:'„Å§',ro:'tsu'},{jp:'„Å¶',ro:'te'},{jp:'„Å®',ro:'to'},
  {jp:'„Å™',ro:'na'},{jp:'„Å´',ro:'ni'},{jp:'„Å¨',ro:'nu'},{jp:'„Å≠',ro:'ne'},{jp:'„ÅÆ',ro:'no'},
  {jp:'„ÅØ',ro:'ha'},{jp:'„Å≤',ro:'hi'},{jp:'„Åµ',ro:'fu'},{jp:'„Å∏',ro:'he'},{jp:'„Åª',ro:'ho'},
  {jp:'„Åæ',ro:'ma'},{jp:'„Åø',ro:'mi'},{jp:'„ÇÄ',ro:'mu'},{jp:'„ÇÅ',ro:'me'},{jp:'„ÇÇ',ro:'mo'},
  {jp:'„ÇÑ',ro:'ya'},{jp:'„ÇÜ',ro:'yu'},{jp:'„Çà',ro:'yo'},
  {jp:'„Çâ',ro:'ra'},{jp:'„Çä',ro:'ri'},{jp:'„Çã',ro:'ru'},{jp:'„Çå',ro:'re'},{jp:'„Çç',ro:'ro'},
  {jp:'„Çè',ro:'wa'},{jp:'„Çí',ro:'wo'},{jp:'„Çì',ro:'n'}
];

const KATAKANA = [
  {jp:'„Ç¢',ro:'a'},{jp:'„Ç§',ro:'i'},{jp:'„Ç¶',ro:'u'},{jp:'„Ç®',ro:'e'},{jp:'„Ç™',ro:'o'},
  {jp:'„Ç´',ro:'ka'},{jp:'„Ç≠',ro:'ki'},{jp:'„ÇØ',ro:'ku'},{jp:'„Ç±',ro:'ke'},{jp:'„Ç≥',ro:'ko'},
  {jp:'„Çµ',ro:'sa'},{jp:'„Ç∑',ro:'shi'},{jp:'„Çπ',ro:'su'},{jp:'„Çª',ro:'se'},{jp:'„ÇΩ',ro:'so'},
  {jp:'„Çø',ro:'ta'},{jp:'„ÉÅ',ro:'chi'},{jp:'„ÉÑ',ro:'tsu'},{jp:'„ÉÜ',ro:'te'},{jp:'„Éà',ro:'to'},
  {jp:'„Éä',ro:'na'},{jp:'„Éã',ro:'ni'},{jp:'„Éå',ro:'nu'},{jp:'„Éç',ro:'ne'},{jp:'„Éé',ro:'no'},
  {jp:'„Éè',ro:'ha'},{jp:'„Éí',ro:'hi'},{jp:'„Éï',ro:'fu'},{jp:'„Éò',ro:'he'},{jp:'„Éõ',ro:'ho'},
  {jp:'„Éû',ro:'ma'},{jp:'„Éü',ro:'mi'},{jp:'„É†',ro:'mu'},{jp:'„É°',ro:'me'},{jp:'„É¢',ro:'mo'},
  {jp:'„É§',ro:'ya'},{jp:'„É¶',ro:'yu'},{jp:'„É®',ro:'yo'},
  {jp:'„É©',ro:'ra'},{jp:'„É™',ro:'ri'},{jp:'„É´',ro:'ru'},{jp:'„É¨',ro:'re'},{jp:'„É≠',ro:'ro'},
  {jp:'„ÉØ',ro:'wa'},{jp:'„É≤',ro:'wo'},{jp:'„É≥',ro:'n'}
];

const HIRA_COMBO = [
  {jp:'„Åç„ÇÉ',ro:'kya'},{jp:'„Åç„ÇÖ',ro:'kyu'},{jp:'„Åç„Çá',ro:'kyo'},
  {jp:'„Åó„ÇÉ',ro:'sha'},{jp:'„Åó„ÇÖ',ro:'shu'},{jp:'„Åó„Çá',ro:'sho'},
  {jp:'„Å°„ÇÉ',ro:'cha'},{jp:'„Å°„ÇÖ',ro:'chu'},{jp:'„Å°„Çá',ro:'cho'},
  {jp:'„Å´„ÇÉ',ro:'nya'},{jp:'„Å´„ÇÖ',ro:'nyu'},{jp:'„Å´„Çá',ro:'nyo'},
  {jp:'„Å≤„ÇÉ',ro:'hya'},{jp:'„Å≤„ÇÖ',ro:'hyu'},{jp:'„Å≤„Çá',ro:'hyo'},
  {jp:'„Åø„ÇÉ',ro:'mya'},{jp:'„Åø„ÇÖ',ro:'myu'},{jp:'„Åø„Çá',ro:'myo'},
  {jp:'„Çä„ÇÉ',ro:'rya'},{jp:'„Çä„ÇÖ',ro:'ryu'},{jp:'„Çä„Çá',ro:'ryo'},
  {jp:'„Åé„ÇÉ',ro:'gya'},{jp:'„Åé„ÇÖ',ro:'gyu'},{jp:'„Åé„Çá',ro:'gyo'}
];

const VOCAB_N5 = [
  {jp:'È£ü„Åπ„Çã',ro:'taberu',th:'‡∏Å‡∏¥‡∏ô'},
  {jp:'È£≤„ÇÄ',ro:'nomu',th:'‡∏î‡∏∑‡πà‡∏°'},
  {jp:'Ë¶ã„Çã',ro:'miru',th:'‡∏î‡∏π/‡∏°‡∏≠‡∏á'},
  {jp:'Ë°å„Åè',ro:'iku',th:'‡πÑ‡∏õ'},
  {jp:'Êù•„Çã',ro:'kuru',th:'‡∏°‡∏≤'},
  {jp:'„Åô„Çã',ro:'suru',th:'‡∏ó‡∏≥'},
  {jp:'„ÅÇ„Çã',ro:'aru',th:'‡∏°‡∏µ (‡∏Ç‡∏≠‡∏á)'},
  {jp:'„ÅÑ„Çã',ro:'iru',th:'‡∏°‡∏µ (‡∏Ñ‡∏ô/‡∏™‡∏±‡∏ï‡∏ß‡πå)'},
  {jp:'Ë®Ä„ÅÜ',ro:'iu',th:'‡∏û‡∏π‡∏î'},
  {jp:'ËÅû„Åè',ro:'kiku',th:'‡∏ü‡∏±‡∏á/‡∏ñ‡∏≤‡∏°'},
  {jp:'Ë™≠„ÇÄ',ro:'yomu',th:'‡∏≠‡πà‡∏≤‡∏ô'},
  {jp:'Êõ∏„Åè',ro:'kaku',th:'‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô'},
  {jp:'Ë≤∑„ÅÜ',ro:'kau',th:'‡∏ã‡∏∑‡πâ‡∏≠'},
  {jp:'Â£≤„Çã',ro:'uru',th:'‡∏Ç‡∏≤‡∏¢'},
  {jp:'ÂæÖ„Å§',ro:'matsu',th:'‡∏£‡∏≠'},
  {jp:'‰ºö„ÅÜ',ro:'au',th:'‡∏û‡∏ö'},
  {jp:'ÂØù„Çã',ro:'neru',th:'‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö'},
  {jp:'Ëµ∑„Åç„Çã',ro:'okiru',th:'‡∏ï‡∏∑‡πà‡∏ô‡∏ô‡∏≠‡∏ô'},
  {jp:'ÂÉç„Åè',ro:'hataraku',th:'‡∏ó‡∏≥‡∏á‡∏≤‡∏ô'},
  {jp:'ÈÅä„Å∂',ro:'asobu',th:'‡πÄ‡∏•‡πà‡∏ô'},
  {jp:'Ê≠©„Åè',ro:'aruku',th:'‡πÄ‡∏î‡∏¥‡∏ô'},
  {jp:'Ëµ∞„Çã',ro:'hashiru',th:'‡∏ß‡∏¥‡πà‡∏á'},
  {jp:'Ë©±„Åô',ro:'hanasu',th:'‡∏û‡∏π‡∏î/‡∏Ñ‡∏∏‡∏¢'},
  {jp:'Êïô„Åà„Çã',ro:'oshieru',th:'‡∏™‡∏≠‡∏ô'},
  {jp:'Áøí„ÅÜ',ro:'narau',th:'‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'},
  {jp:'Â•Ω„Åç',ro:'suki',th:'‡∏ä‡∏≠‡∏ö'},
  {jp:'Â´å„ÅÑ',ro:'kirai',th:'‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö'},
  {jp:'Â§ß„Åç„ÅÑ',ro:'ookii',th:'‡πÉ‡∏´‡∏ç‡πà'},
  {jp:'Â∞è„Åï„ÅÑ',ro:'chiisai',th:'‡πÄ‡∏•‡πá‡∏Å'},
  {jp:'È´ò„ÅÑ',ro:'takai',th:'‡∏™‡∏π‡∏á/‡πÅ‡∏û‡∏á'},
  {jp:'ÂÆâ„ÅÑ',ro:'yasui',th:'‡∏ñ‡∏π‡∏Å (‡∏£‡∏≤‡∏Ñ‡∏≤)'},
  {jp:'Êñ∞„Åó„ÅÑ',ro:'atarashii',th:'‡πÉ‡∏´‡∏°‡πà'},
  {jp:'Âè§„ÅÑ',ro:'furui',th:'‡πÄ‡∏Å‡πà‡∏≤'},
  {jp:'‰ªäÊó•',ro:'kyou',th:'‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ'},
  {jp:'ÊòéÊó•',ro:'ashita',th:'‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ'},
  {jp:'Êò®Êó•',ro:'kinou',th:'‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô'},
  {jp:'ÊôÇÈñì',ro:'jikan',th:'‡πÄ‡∏ß‡∏•‡∏≤'},
  {jp:'ÂèãÈÅî',ro:'tomodachi',th:'‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô'},
  {jp:'ÂÆ∂Êóè',ro:'kazoku',th:'‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß'},
  {jp:'Â≠¶Ê†°',ro:'gakkou',th:'‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'}
];

const VOCAB_N4 = [
  {jp:'Ê±∫„ÇÅ„Çã',ro:'kimeru',th:'‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à'},
  {jp:'Âßã„Åæ„Çã',ro:'hajimaru',th:'‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô'},
  {jp:'ÁµÇ„Çè„Çã',ro:'owaru',th:'‡∏à‡∏ö/‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î'},
  {jp:'Â§â„Çè„Çã',ro:'kawaru',th:'‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô'},
  {jp:'Á∂ö„Åë„Çã',ro:'tsuzukeru',th:'‡∏ó‡∏≥‡∏ï‡πà‡∏≠'},
  {jp:'ËÄÉ„Åà„Çã',ro:'kangaeru',th:'‡∏Ñ‡∏¥‡∏î'},
  {jp:'ÊÄù„ÅÜ',ro:'omou',th:'‡∏Ñ‡∏¥‡∏î/‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å'},
  {jp:'‰ø°„Åò„Çã',ro:'shinjiru',th:'‡πÄ‡∏ä‡∏∑‡πà‡∏≠'},
  {jp:'Âä©„Åë„Çã',ro:'tasukeru',th:'‡∏ä‡πà‡∏ß‡∏¢'},
  {jp:'ÈõÜ„ÇÅ„Çã',ro:'atsumeru',th:'‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°'},
  {jp:'Ë´¶„ÇÅ„Çã',ro:'akirameru',th:'‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ'},
  {jp:'È†ëÂºµ„Çã',ro:'ganbaru',th:'‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°'},
  {jp:'ÊÑèÂë≥',ro:'imi',th:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢'},
  {jp:'ÁêÜÁî±',ro:'riyuu',th:'‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•'},
  {jp:'Ê∞óÊåÅ„Å°',ro:'kimochi',th:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å'},
  {jp:'ÁµåÈ®ì',ro:'keiken',th:'‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå'},
  {jp:'ÂïèÈ°å',ro:'mondai',th:'‡∏õ‡∏±‡∏ç‡∏´‡∏≤'},
  {jp:'Â§ßÂàá',ro:'taisetsu',th:'‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç'},
  {jp:'ÊôÆÈÄö',ro:'futsuu',th:'‡∏õ‡∏Å‡∏ï‡∏¥'},
  {jp:'ÁâπÂà•',ro:'tokubetsu',th:'‡∏û‡∏¥‡πÄ‡∏®‡∏©'}
];

const VOCAB_MANGA = [
  {jp:'Êà¶„ÅÜ',ro:'tatakau',th:'‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ',tag:'action'},
  {jp:'ÊîªÊíÉ',ro:'kougeki',th:'‡πÇ‡∏à‡∏°‡∏ï‡∏µ',tag:'action'},
  {jp:'Èò≤Âæ°',ro:'bougyo',th:'‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô',tag:'action'},
  {jp:'‰ª≤Èñì',ro:'nakama',th:'‡∏û‡∏ß‡∏Å‡∏û‡πâ‡∏≠‡∏á',tag:'manga'},
  {jp:'Êïµ',ro:'teki',th:'‡∏®‡∏±‡∏ï‡∏£‡∏π',tag:'manga'},
  {jp:'È≠îÊ≥ï',ro:'mahou',th:'‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå',tag:'manga'},
  {jp:'Âäõ',ro:'chikara',th:'‡∏û‡∏•‡∏±‡∏á',tag:'manga'},
  {jp:'Â§¢',ro:'yume',th:'‡∏ù‡∏±‡∏ô',tag:'manga'},
  {jp:'Á¥ÑÊùü',ro:'yakusoku',th:'‡∏™‡∏±‡∏ç‡∏ç‡∏≤',tag:'manga'},
  {jp:'ÈÅãÂëΩ',ro:'unmei',th:'‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤',tag:'manga'},
  {jp:'ÂãáÊ∞ó',ro:'yuuki',th:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡πâ‡∏≤',tag:'manga'},
  {jp:'ÊÄí„Çä',ro:'ikari',th:'‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏Å‡∏£‡∏ò',tag:'emotion'},
  {jp:'Âè´„Å∂',ro:'sakebu',th:'‡∏ï‡∏∞‡πÇ‡∏Å‡∏ô',tag:'manga'},
  {jp:'Á¨ë„ÅÜ',ro:'warau',th:'‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞',tag:'emotion'},
  {jp:'Ê≥£„Åè',ro:'naku',th:'‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ',tag:'emotion'},
  {jp:'„Éâ„Ç≠„Éâ„Ç≠',ro:'dokidoki',th:'‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô',tag:'sfx'},
  {jp:'„ÉØ„ÇØ„ÉØ„ÇØ',ro:'wakuwaku',th:'‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô',tag:'sfx'},
  {jp:'„Ç≠„É©„Ç≠„É©',ro:'kirakira',th:'‡πÅ‡∏ß‡∏ß‡∏ß‡∏≤‡∏ß',tag:'sfx'}
];

const MANGA_ACTION = [
  {jp:'ÊîªÊíÉ„Åô„Çã',ro:'kougeki suru',th:'‡πÇ‡∏à‡∏°‡∏ï‡∏µ'},
  {jp:'Èò≤Âæ°„Åô„Çã',ro:'bougyo suru',th:'‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô'},
  {jp:'Êà¶„ÅÜ',ro:'tatakau',th:'‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ'},
  {jp:'ÈÄÉ„Åí„Çã',ro:'nigeru',th:'‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏ô‡∏µ'},
  {jp:'Ê≠ª„Å¨',ro:'shinu',th:'‡∏ï‡∏≤‡∏¢'},
  {jp:'ÂÄí„Åô',ro:'taosu',th:'ÊâìË¥•/‡∏•‡πâ‡∏°‡∏•‡πâ‡∏≤‡∏á'},
  {jp:'Ë≤†„Åë„Çã',ro:'makeru',th:'‡πÅ‡∏û‡πâ'},
  {jp:'Âãù„Å§',ro:'katsu',th:'‡∏ä‡∏ô‡∏∞'},
  {jp:'Âäõ',ro:'chikara',th:'‡∏û‡∏•‡∏±‡∏á'},
  {jp:'È≠îÊ≥ï',ro:'mahou',th:'‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå'},
  {jp:'ÊäÄ',ro:'waza',th:'‡∏ó‡πà‡∏≤‡πÑ‡∏°‡πâ‡∏ï‡∏≤‡∏¢'},
  {jp:'ÂøÖÊÆ∫ÊäÄ',ro:'hissatsuwaza',th:'‡∏ó‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î'},
  {jp:'‰ª≤Èñì',ro:'nakama',th:'‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏ó‡∏≤‡∏á'},
  {jp:'Êïµ',ro:'teki',th:'‡∏®‡∏±‡∏ï‡∏£‡∏π'},
  {jp:'„Éú„Çπ',ro:'bosu',th:'‡∏ö‡∏≠‡∏™'},
  {jp:'„É¨„Éô„É´',ro:'reberu',th:'‡πÄ‡∏•‡πÄ‡∏ß‡∏•'},
  {jp:'HP',ro:'HP',th:'‡∏û‡∏•‡∏±‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï'},
  {jp:'„ÉÄ„É°„Éº„Ç∏',ro:'damƒìji',th:'‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢'},
];

const MANGA_EMOTION = [
  {jp:'Â•Ω„Åç',ro:'suki',th:'‡∏ä‡∏≠‡∏ö/‡∏£‡∏±‡∏Å'},
  {jp:'Â´å„ÅÑ',ro:'kirai',th:'‡πÄ‡∏Å‡∏•‡∏µ‡∏¢‡∏î'},
  {jp:'Â¨â„Åó„ÅÑ',ro:'ureshii',th:'‡∏î‡∏µ‡πÉ‡∏à'},
  {jp:'ÊÇ≤„Åó„ÅÑ',ro:'kanashii',th:'‡πÄ‡∏®‡∏£‡πâ‡∏≤'},
  {jp:'ÊÄí„Çã',ro:'okoru',th:'‡πÇ‡∏Å‡∏£‡∏ò'},
  {jp:'È©ö„Åè',ro:'odoroku',th:'‡∏ï‡∏Å‡πÉ‡∏à'},
  {jp:'ÊÄñ„ÅÑ',ro:'kowai',th:'‡∏Å‡∏•‡∏±‡∏ß'},
  {jp:'ÊÅ•„Åö„Åã„Åó„ÅÑ',ro:'hazukashii',th:'‡∏≠‡∏≤‡∏¢'},
  {jp:'„Éâ„Ç≠„Éâ„Ç≠',ro:'doki doki',th:'‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô'},
  {jp:'„ÉØ„ÇØ„ÉØ„ÇØ',ro:'waku waku',th:'‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô (‡πÅ‡∏ö‡∏ö‡∏î‡∏µ)'},
  {jp:'„Ç¨„Éº„É≥',ro:'gaan',th:'‡∏≠‡πâ‡∏≤‡∏ß! (‡∏ï‡∏Å‡πÉ‡∏à)'},
  {jp:'„Ç≠„É£„Éº',ro:'kyaa',th:'‡∏Å‡∏£‡∏µ‡πä‡∏î'},
  {jp:'Ê≥£„Åè',ro:'naku',th:'‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ'},
  {jp:'Á¨ë„ÅÜ',ro:'warau',th:'‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞'},
  {jp:'Âè´„Å∂',ro:'sakebu',th:'‡∏ï‡∏∞‡πÇ‡∏Å‡∏ô'},
];

const MANGA_DAILY = [
  {jp:'È£Ø',ro:'meshi',th:'‡∏Ç‡πâ‡∏≤‡∏ß/‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡πÅ‡∏™‡∏•‡∏á)'},
  {jp:'„ÅÜ„Åæ„ÅÑ',ro:'umai',th:'‡∏≠‡∏£‡πà‡∏≠‡∏¢ (‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢)'},
  {jp:'„ÇÑ„Å∞„ÅÑ',ro:'„ÇÑ„Å∞„ÅÑ',th:'‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ/‡∏´‡πà‡∏ß‡∏¢/‡πÄ‡∏à‡πã‡∏á'},
  {jp:'„Éû„Ç∏„Åã',ro:'maji ka',th:'‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏´‡∏£‡∏≠?'},
  {jp:'„Åô„Åî„ÅÑ',ro:'sugoi',th:'‡πÄ‡∏Å‡πà‡∏á/‡∏ß‡πâ‡∏≤‡∏ß'},
  {jp:'„Åã„Çè„ÅÑ„ÅÑ',ro:'kawaii',th:'‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å'},
  {jp:'„Åã„Å£„Åì„ÅÑ„ÅÑ',ro:'kakkoii',th:'‡πÄ‡∏ó‡πà'},
  {jp:'„ÅÜ„Çã„Åï„ÅÑ',ro:'urusai',th:'‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á/‡πÄ‡∏á‡∏µ‡∏¢‡∏ö!'},
  {jp:'„Éê„Ç´',ro:'baka',th:'‡πÇ‡∏á‡πà (‡∏Ñ‡∏≥‡∏î‡πà‡∏≤)'},
  {jp:'„Ç¢„Éõ',ro:'aho',th:'‡πÇ‡∏á‡πà (‡πÇ‡∏≠‡∏ã‡∏≤‡∏Å‡πâ‡∏≤)'},
  {jp:'„Å°„ÇÉ„Çì„Å®',ro:'chanto',th:'‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'},
  {jp:'„Å†„ÅÑ„Åò„Çá„ÅÜ„Å∂',ro:'daijoubu',th:'‡πÇ‡∏≠‡πÄ‡∏Ñ/‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£'},
];

const MANGA_ROMANCE = [
  {jp:'Â•Ω„Åç„Åß„Åô',ro:'suki desu',th:'‡∏â‡∏±‡∏ô‡∏ä‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì'},
  {jp:'ÊÑõ„Åó„Å¶„Çã',ro:'aishiteru',th:'‡∏â‡∏±‡∏ô‡∏£‡∏±‡∏Å‡∏Ñ‡∏∏‡∏ì'},
  {jp:'ÂëäÁôΩ„Åô„Çã',ro:'kokuhaku suru',th:'‡∏™‡∏≤‡∏£‡∏†‡∏≤‡∏û‡∏£‡∏±‡∏Å'},
  {jp:'‰ªò„ÅçÂêà„ÅÜ',ro:'tsukiau',th:'‡∏Ñ‡∏ö‡∏Å‡∏±‡∏ô (‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å)'},
  {jp:'„Éá„Éº„Éà',ro:'deeto',th:'‡πÄ‡∏î‡∏ï'},
  {jp:'„Ç≠„Çπ',ro:'kisu',th:'‡∏à‡∏π‡∏ö'},
  {jp:'„Éè„Ç∞',ro:'hagu',th:'‡∏Å‡∏≠‡∏î'},
  {jp:'Êâã„ÇíÁπã„Åê',ro:'te wo tsunagu',th:'‡∏à‡∏±‡∏ö‡∏°‡∏∑‡∏≠'},
  {jp:'ÂΩºÊ∞è',ro:'kareshi',th:'‡πÅ‡∏ü‡∏ô‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢'},
  {jp:'ÂΩºÂ•≥',ro:'kanojo',th:'‡πÅ‡∏ü‡∏ô‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á'},
  {jp:'Â´âÂ¶¨',ro:'shitto',th:'‡∏≠‡∏¥‡∏à‡∏â‡∏≤'},
  {jp:'„Éâ„Ç≠„Éâ„Ç≠„Åô„Çã',ro:'doki doki suru',th:'‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô‡πÅ‡∏£‡∏á'},
  {jp:'Â§¢‰∏≠„Å´„Å™„Çã',ro:'muchuu ni naru',th:'‡∏´‡∏•‡∏á‡πÉ‡∏´‡∏•'},
  {jp:'ÈÅãÂëΩ„ÅÆ‰∫∫',ro:'unmei no hito',th:'‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏∞‡∏ï‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î'},
];

const MANGA_ADULT = [
  {jp:'ËÑ±„Åê',ro:'nugu',th:'‡∏ñ‡∏≠‡∏î (‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤)'},
  {jp:'Ë£∏',ro:'hadaka',th:'‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏¢/‡πÑ‡∏°‡πà‡∏™‡∏ß‡∏°‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤'},
  {jp:'ËÉ∏',ro:'mune',th:'‡∏≠‡∏Å/‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å'},
  {jp:'Ëß¶„Çã',ro:'sawaru',th:'‡πÅ‡∏ï‡∏∞‡∏ï‡πâ‡∏≠‡∏á'},
  {jp:'ÊÑü„Åò„Çã',ro:'kanjiru',th:'‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å'},
  {jp:'Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ',ro:'kimochi ii',th:'‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏î‡∏µ'},
  {jp:'„ÇÇ„Å£„Å®',ro:'motto',th:'‡∏≠‡∏µ‡∏Å/‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ'},
  {jp:'„ÇÑ„ÇÅ„Å¶',ro:'yamete',th:'‡∏´‡∏¢‡∏∏‡∏î!'},
  {jp:'„ÅÑ„ÇÑ',ro:'iya',th:'‡πÑ‡∏°‡πà!'},
  {jp:'ÊÅ•„Åö„Åã„Åó„ÅÑ',ro:'hazukashii',th:'‡∏≠‡∏≤‡∏¢'},
  {jp:'„Å†„ÇÅ',ro:'dame',th:'‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ!'},
  {jp:'„ÅÇ„Çì',ro:'an',th:'‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏£‡∏ß‡∏ç‡∏Ñ‡∏£‡∏≤‡∏á'},
  {jp:'„Åä„Åã„Åó„ÅÑ',ro:'okashii',th:'‡πÅ‡∏õ‡∏•‡∏Å‡πÜ'},
  {jp:'Âàù„ÇÅ„Å¶',ro:'hajimete',th:'‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å'},
  {jp:'ÂÑ™„Åó„Åè„Åó„Å¶',ro:'yasashiku shite',th:'‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡∏∏‡πà‡∏°‡∏ô‡∏ß‡∏•‡∏´‡∏ô‡πà‡∏≠‡∏¢'},
  {jp:'ÊÑõÊí´',ro:'aibu',th:'‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏ö‡πÑ‡∏•‡πâ'},
  {jp:'Âø´ÊÑü',ro:'kaikan',th:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à'},
  {jp:'Áµ∂È†Ç',ro:'zecchou',th:'‡∏à‡∏∏‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î/‡∏≠‡∏≠‡∏£‡πå‡πÅ‡∏Å‡∏™‡∏ã‡∏∂‡∏°'},
  {jp:'‰∏≠Âá∫„Åó',ro:'nakadashi',th:'‡πÉ‡∏ô (‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå adult)'},
  {jp:'‰∏ãÁùÄ',ro:'shitagi',th:'‡∏ä‡∏∏‡∏î‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ô'},
  {jp:'Âà∂Êúç',ro:'seifuku',th:'‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'},
  {jp:'„É°„Ç§„Éâ',ro:'meido',th:'‡∏™‡∏≤‡∏ß‡πÉ‡∏ä‡πâ/‡πÄ‡∏°‡∏î'},
  {jp:'„Åî‰∏ª‰∫∫Êßò',ro:'goshujin-sama',th:'‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏≤‡∏¢ (‡∏Ñ‡∏≥ submission)'},
  {jp:'„ÅäÂ¨¢Êßò',ro:'ojou-sama',th:'‡∏Ñ‡∏∏‡∏ì‡∏´‡∏ô‡∏π (‡∏Ñ‡∏≥ formal)'},
];

const KANJI_N5 = [
  {k:'‰∏Ä',on:'„Ç§„ÉÅ',kun:'„Å≤„Å®',m:'‡∏´‡∏ô‡∏∂‡πà‡∏á',ex:'‰∏Ä„Å§ (hitotsu)'},
  {k:'‰∫å',on:'„Éã',kun:'„Åµ„Åü',m:'‡∏™‡∏≠‡∏á',ex:'‰∫å„Å§ (futatsu)'},
  {k:'‰∏â',on:'„Çµ„É≥',kun:'„Åø',m:'‡∏™‡∏≤‡∏°',ex:'‰∏â„Å§ (mittsu)'},
  {k:'Âõõ',on:'„Ç∑',kun:'„Çà',m:'‡∏™‡∏µ‡πà',ex:'Âõõ„Å§ (yottsu)'},
  {k:'‰∫î',on:'„Ç¥',kun:'„ÅÑ„Å§',m:'‡∏´‡πâ‡∏≤',ex:'‰∫î„Å§ (itsutsu)'},
  {k:'ÂÖ≠',on:'„É≠„ÇØ',kun:'„ÇÄ',m:'‡∏´‡∏Å',ex:'ÂÖ≠„Å§ (muttsu)'},
  {k:'‰∏É',on:'„Ç∑„ÉÅ',kun:'„Å™„Å™',m:'‡πÄ‡∏à‡πá‡∏î',ex:'‰∏É„Å§ (nanatsu)'},
  {k:'ÂÖ´',on:'„Éè„ÉÅ',kun:'„ÇÑ„Å£',m:'‡πÅ‡∏õ‡∏î',ex:'ÂÖ´„Å§ (yattsu)'},
  {k:'‰πù',on:'„ÇØ„Éª„Ç≠„É•„Ç¶',kun:'„Åì„Åì„ÅÆ',m:'‡πÄ‡∏Å‡πâ‡∏≤',ex:'‰πù„Å§ (kokonotsu)'},
  {k:'ÂçÅ',on:'„Ç∏„É•„Ç¶',kun:'„Å®„Åä',m:'‡∏™‡∏¥‡∏ö',ex:'ÂçÅ (juu)'},
  {k:'Áôæ',on:'„Éí„É£„ÇØ',kun:'-',m:'‡∏£‡πâ‡∏≠‡∏¢',ex:'ÁôæÂÜÜ (hyakuen)'},
  {k:'ÂçÉ',on:'„Çª„É≥',kun:'-',m:'‡∏û‡∏±‡∏ô',ex:'ÂçÉÂÜÜ (senen)'},
  {k:'‰∏á',on:'„Éû„É≥',kun:'-',m:'‡∏´‡∏°‡∏∑‡πà‡∏ô',ex:'‰∏Ä‰∏á (ichiman)'},
  {k:'Êó•',on:'„Éã„ÉÅ„Éª„Ç∏„ÉÑ',kun:'„Å≤',m:'‡∏ß‡∏±‡∏ô/‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå',ex:'‰ªäÊó• (kyou)'},
  {k:'Êúà',on:'„Ç≤„ÉÑ„Éª„Ç¨„ÉÑ',kun:'„Å§„Åç',m:'‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏û‡∏£‡∏∞‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå',ex:'‰ªäÊúà (kongetsu)'},
  {k:'Âπ¥',on:'„Éç„É≥',kun:'„Å®„Åó',m:'‡∏õ‡∏µ',ex:'‰ªäÂπ¥ (kotoshi)'},
  {k:'ÊôÇ',on:'„Ç∏',kun:'„Å®„Åç',m:'‡πÄ‡∏ß‡∏•‡∏≤',ex:'ÊôÇÈñì (jikan)'},
  {k:'ÂàÜ',on:'„Éï„É≥„Éª„Éó„É≥',kun:'„Çè',m:'‡∏ô‡∏≤‡∏ó‡∏µ/‡πÅ‡∏ö‡πà‡∏á',ex:'‰∫îÂàÜ (gofun)'},
  {k:'‰∫∫',on:'„Ç∏„É≥„Éª„Éã„É≥',kun:'„Å≤„Å®',m:'‡∏Ñ‡∏ô',ex:'‰∫∫Èñì (ningen)'},
  {k:'Â±±',on:'„Çµ„É≥',kun:'„ÇÑ„Åæ',m:'‡∏†‡∏π‡πÄ‡∏Ç‡∏≤',ex:'ÂØåÂ£´Â±± (Fujisan)'},
  {k:'Â∑ù',on:'„Çª„É≥',kun:'„Åã„Çè',m:'‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥',ex:'Â∑ù (kawa)'},
  {k:'Êú®',on:'„É¢„ÇØ„Éª„Éú„ÇØ',kun:'„Åç',m:'‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ',ex:'Êú®ÊõúÊó• (mokuyoubi)'},
  {k:'ÁÅ´',on:'„Ç´',kun:'„Å≤',m:'‡πÑ‡∏ü',ex:'ÁÅ´ÊõúÊó• (kayoubi)'},
  {k:'Ê∞¥',on:'„Çπ„Ç§',kun:'„Åø„Åö',m:'‡∏ô‡πâ‡∏≥',ex:'Ê∞¥ÊõúÊó• (suiyoubi)'},
  {k:'Èáë',on:'„Ç≠„É≥„Éª„Ç≥„É≥',kun:'„Åã„Å≠',m:'‡∏ó‡∏≠‡∏á/‡πÄ‡∏á‡∏¥‡∏ô',ex:'„ÅäÈáë (okane)'},
  {k:'Âúü',on:'„Éâ„Éª„Éà',kun:'„Å§„Å°',m:'‡∏î‡∏¥‡∏ô',ex:'ÂúüÊõúÊó• (doyoubi)'},
  {k:'Â§ß',on:'„ÉÄ„Ç§„Éª„Çø„Ç§',kun:'„Åä„Åä',m:'‡πÉ‡∏´‡∏ç‡πà',ex:'Â§ßÂ≠¶ (daigaku)'},
  {k:'Â∞è',on:'„Ç∑„Éß„Ç¶',kun:'„Å°„ÅÑ„Éª„Åì',m:'‡πÄ‡∏•‡πá‡∏Å',ex:'Â∞èÂ≠¶Ê†° (shougakkou)'},
  {k:'‰∏ä',on:'„Ç∏„Éß„Ç¶',kun:'„ÅÜ„Åà„Éª„ÅÇ',m:'‡∏ö‡∏ô/‡∏Ç‡∏∂‡πâ‡∏ô',ex:'‰∏äÊâã (jouzu)'},
  {k:'‰∏ã',on:'„Ç´„Éª„Ç≤',kun:'„Åó„Åü„Éª„Åä',m:'‡∏•‡πà‡∏≤‡∏á/‡∏•‡∏á',ex:'‰∏ãÊâã (heta)'},
  {k:'‰∏≠',on:'„ÉÅ„É•„Ç¶',kun:'„Å™„Åã',m:'‡πÉ‡∏ô/‡∏Å‡∏•‡∏≤‡∏á',ex:'‰∏≠ÂõΩ (chuugoku)'},
  {k:'ÂõΩ',on:'„Ç≥„ÇØ',kun:'„Åè„Å´',m:'‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®',ex:'Â§ñÂõΩ (gaikoku)'},
  {k:'Â≠¶',on:'„Ç¨„ÇØ',kun:'„Åæ„Å™',m:'‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',ex:'Â≠¶Ê†° (gakkou)'},
  {k:'Áîü',on:'„Çª„Ç§„Éª„Ç∑„Éß„Ç¶',kun:'„ÅÑ„Éª„ÅÜ„Éª„Å™„Åæ',m:'‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï/‡πÄ‡∏Å‡∏¥‡∏î',ex:'Â≠¶Áîü (gakusei)'},
  {k:'ÂÖà',on:'„Çª„É≥',kun:'„Åï„Åç',m:'‡∏Å‡πà‡∏≠‡∏ô/‡∏´‡∏ô‡πâ‡∏≤',ex:'ÂÖàÁîü (sensei)'},
  {k:'Â≠ê',on:'„Ç∑',kun:'„Åì',m:'‡πÄ‡∏î‡πá‡∏Å',ex:'Â≠ê‰æõ (kodomo)'},
  {k:'Â•≥',on:'„Ç∏„Éß',kun:'„Åä„Çì„Å™',m:'‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á',ex:'Â•≥ÊÄß (josei)'},
  {k:'Áî∑',on:'„ÉÄ„É≥',kun:'„Åä„Å®„Åì',m:'‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢',ex:'Áî∑ÊÄß (dansei)'},
  {k:'ÊØç',on:'„Éú',kun:'„ÅØ„ÅØ',m:'‡πÅ‡∏°‡πà',ex:'„ÅäÊØç„Åï„Çì (okaasan)'},
  {k:'Áà∂',on:'„Éï',kun:'„Å°„Å°',m:'‡∏û‡πà‡∏≠',ex:'„ÅäÁà∂„Åï„Çì (otousan)'},
  {k:'Ë¶ã',on:'„Ç±„É≥',kun:'„Åø',m:'‡∏î‡∏π',ex:'Ë¶ã„Çã (miru)'},
  {k:'ËÅû',on:'„Éñ„É≥„Éª„É¢„É≥',kun:'„Åç',m:'‡∏ü‡∏±‡∏á/‡∏ñ‡∏≤‡∏°',ex:'ËÅû„Åè (kiku)'},
  {k:'Ë®Ä',on:'„Ç≤„É≥„Éª„Ç¥„É≥',kun:'„ÅÑ',m:'‡∏û‡∏π‡∏î',ex:'Ë®Ä„ÅÜ (iu)'},
  {k:'Êõ∏',on:'„Ç∑„Éß',kun:'„Åã',m:'‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô',ex:'Êõ∏„Åè (kaku)'},
  {k:'Ë™≠',on:'„Éâ„ÇØ',kun:'„Çà',m:'‡∏≠‡πà‡∏≤‡∏ô',ex:'Ë™≠„ÇÄ (yomu)'},
  {k:'È£ü',on:'„Ç∑„Éß„ÇØ',kun:'„Åü',m:'‡∏Å‡∏¥‡∏ô',ex:'È£ü„Åπ„Çã (taberu)'},
  {k:'È£≤',on:'„Ç§„É≥',kun:'„ÅÆ',m:'‡∏î‡∏∑‡πà‡∏°',ex:'È£≤„ÇÄ (nomu)'},
  {k:'Ë°å',on:'„Ç≥„Ç¶',kun:'„ÅÑ„Éª„Åä„Åì„Å™',m:'‡πÑ‡∏õ',ex:'Ë°å„Åè (iku)'},
  {k:'Êù•',on:'„É©„Ç§',kun:'„Åè',m:'‡∏°‡∏≤',ex:'Êù•„Çã (kuru)'},
  {k:'Âá∫',on:'„Ç∑„É•„ÉÑ',kun:'„Åß',m:'‡∏≠‡∏≠‡∏Å',ex:'Âá∫„Çã (deru)'},
  {k:'ÂÖ•',on:'„Éã„É•„Ç¶',kun:'„ÅÑ„Éª„ÅØ„ÅÑ',m:'‡πÄ‡∏Ç‡πâ‡∏≤',ex:'ÂÖ•„Çã (hairu)'},
  {k:'Ë≤∑',on:'„Éê„Ç§',kun:'„Åã',m:'‡∏ã‡∏∑‡πâ‡∏≠',ex:'Ë≤∑„ÅÜ (kau)'},
  {k:'ÁôΩ',on:'„Éè„ÇØ„Éª„Éì„É£„ÇØ',kun:'„Åó„Çç',m:'‡∏Ç‡∏≤‡∏ß',ex:'ÁôΩ„ÅÑ (shiroi)'},
  {k:'Èªí',on:'„Ç≥„ÇØ',kun:'„Åè„Çç',m:'‡∏î‡∏≥',ex:'Èªí„ÅÑ (kuroi)'},
  {k:'Ëµ§',on:'„Çª„Ç≠',kun:'„ÅÇ„Åã',m:'‡πÅ‡∏î‡∏á',ex:'Ëµ§„ÅÑ (akai)'},
  {k:'Èùí',on:'„Çª„Ç§',kun:'„ÅÇ„Åä',m:'‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô',ex:'Èùí„ÅÑ (aoi)'},
  {k:'Êú¨',on:'„Éõ„É≥',kun:'„ÇÇ„Å®',m:'‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠/‡∏ï‡πâ‡∏ô',ex:'Êú¨ (hon)'},
  {k:'Êâã',on:'„Ç∑„É•',kun:'„Å¶',m:'‡∏°‡∏∑‡∏≠',ex:'Êâã (te)'},
  {k:'ÁõÆ',on:'„É¢„ÇØ',kun:'„ÇÅ',m:'‡∏ï‡∏≤',ex:'ÁõÆ (me)'},
  {k:'Âè£',on:'„Ç≥„Ç¶„Éª„ÇØ',kun:'„Åè„Å°',m:'‡∏õ‡∏≤‡∏Å',ex:'Âè£ (kuchi)'},
  {k:'ËÄ≥',on:'„Ç∏',kun:'„Åø„Åø',m:'‡∏´‡∏π',ex:'ËÄ≥ (mimi)'},
  {k:'Ë∂≥',on:'„ÇΩ„ÇØ',kun:'„ÅÇ„Åó',m:'‡∏Ç‡∏≤/‡πÄ‡∏ó‡πâ‡∏≤',ex:'Ë∂≥ (ashi)'},
  {k:'ÂøÉ',on:'„Ç∑„É≥',kun:'„Åì„Åì„Çç',m:'‡πÉ‡∏à/‡∏´‡∏±‡∏ß‡πÉ‡∏à',ex:'ÂøÉÈÖç (shinpai)'},
  {k:'Ê∞ó',on:'„Ç≠„Éª„Ç±',kun:'-',m:'‡∏•‡∏°/‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå',ex:'ÂÖÉÊ∞ó (genki)'},
  {k:'Â•Ω',on:'„Ç≥„Ç¶',kun:'„Åô„Éª„Åì„ÅÆ',m:'‡∏ä‡∏≠‡∏ö',ex:'Â•Ω„Åç (suki)'},
  {k:'Âèã',on:'„É¶„Ç¶',kun:'„Å®„ÇÇ',m:'‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô',ex:'ÂèãÈÅî (tomodachi)'},
  {k:'ÂÆ∂',on:'„Ç´„Éª„Ç±',kun:'„ÅÑ„Åà„Éª„ÅÜ„Å°',m:'‡∏ö‡πâ‡∏≤‡∏ô',ex:'ÂÆ∂Êóè (kazoku)'},
  {k:'Ëªä',on:'„Ç∑„É£',kun:'„Åè„Çã„Åæ',m:'‡∏£‡∏ñ',ex:'ÈõªËªä (densha)'},
  {k:'Èõª',on:'„Éá„É≥',kun:'-',m:'‡πÑ‡∏ü‡∏ü‡πâ‡∏≤',ex:'ÈõªË©± (denwa)'},
  {k:'Ë©±',on:'„ÉØ',kun:'„ÅØ„Å™',m:'‡∏û‡∏π‡∏î/‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á',ex:'Ë©±„Åô (hanasu)'},
  {k:'Ë™û',on:'„Ç¥',kun:'„Åã„Åü',m:'‡∏†‡∏≤‡∏©‡∏≤/‡∏Ñ‡∏≥',ex:'Êó•Êú¨Ë™û (nihongo)'},
  {k:'Ëä±',on:'„Ç´',kun:'„ÅØ„Å™',m:'‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ',ex:'Ëä± (hana)'},
  {k:'Â§©',on:'„ÉÜ„É≥',kun:'„ÅÇ„Åæ',m:'‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤/‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå',ex:'Â§©Ê∞ó (tenki)'},
  {k:'Á©∫',on:'„ÇØ„Ç¶',kun:'„Åù„Çâ„Éª„ÅÇ',m:'‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤/‡∏ß‡πà‡∏≤‡∏á',ex:'Á©∫ (sora)'},
  {k:'Èõ®',on:'„Ç¶',kun:'„ÅÇ„ÇÅ',m:'‡∏ù‡∏ô',ex:'Èõ® (ame)'},
  {k:'È¢®',on:'„Éï„Ç¶„Éª„Éï',kun:'„Åã„Åú',m:'‡∏•‡∏°',ex:'Âè∞È¢® (taifuu)'},
  {k:'ÈÅì',on:'„Éâ„Ç¶',kun:'„Åø„Å°',m:'‡∏ñ‡∏ô‡∏ô/‡∏ó‡∏≤‡∏á',ex:'ÈÅì (michi)'},
  {k:'ÈñÄ',on:'„É¢„É≥',kun:'„Åã„Å©',m:'‡∏õ‡∏£‡∏∞‡∏ï‡∏π',ex:'ÈñÄ (mon)'},
  {k:'Âäõ',on:'„É™„Éß„ÇØ„Éª„É™„Ç≠',kun:'„Å°„Åã„Çâ',m:'‡∏û‡∏•‡∏±‡∏á',ex:'Âäõ (chikara)'},
  {k:'Áéã',on:'„Ç™„Ç¶',kun:'-',m:'‡∏Å‡∏©‡∏±‡∏ï‡∏£‡∏¥‡∏¢‡πå',ex:'ÁéãÊßò (ousama)'},
];

const GRAMMAR_N5 = [
  {
    pattern: '„ÅØ (wa) ‚Äî Topic particle',
    meaning: '‡∏ö‡∏≠‡∏Å "‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏û‡∏π‡∏î‡∏ñ‡∏∂‡∏á" ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô',
    exp: '‡πÉ‡∏ä‡πâ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ ‡πÄ‡∏õ‡πá‡∏ô particle ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô',
    examples: [
      {jp:'ÁßÅ„ÅØÂ≠¶Áîü„Åß„Åô', ro:'Watashi wa gakusei desu', th:'‡∏â‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'},
      {jp:'„Åì„Çå„ÅØÊú¨„Åß„Åô', ro:'Kore wa hon desu', th:'‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠'},
      {jp:'ÂΩºÂ•≥„ÅØÊó•Êú¨‰∫∫„Åß„Åô', ro:'Kanojo wa nihonjin desu', th:'‡πÄ‡∏ò‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô'},
    ]
  },
  {
    pattern: '„Åå (ga) ‚Äî Subject particle',
    meaning: '‡∏ö‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏ô‡πâ‡∏ô‡∏ß‡πà‡∏≤ "‡πÉ‡∏Ñ‡∏£/‡∏≠‡∏∞‡πÑ‡∏£ ‡∏ó‡∏≥"',
    exp: '‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å „ÅØ ‡∏ï‡∏£‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô subject ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö verb ‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ',
    examples: [
      {jp:'Áå´„Åå„ÅÑ„Åæ„Åô', ro:'Neko ga imasu', th:'‡∏°‡∏µ‡πÅ‡∏°‡∏ß‡∏≠‡∏¢‡∏π‡πà'},
      {jp:'Êó•Êú¨Ë™û„ÅåÂ•Ω„Åç„Åß„Åô', ro:'Nihongo ga suki desu', th:'‡∏â‡∏±‡∏ô‡∏ä‡∏≠‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô'},
      {jp:'Ë™∞„ÅåÊù•„Åæ„Åó„Åü„Åã', ro:'Dare ga kimashita ka', th:'‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤?'},
    ]
  },
  {
    pattern: '„Åß„Åô / „Å† ‚Äî to be',
    meaning: '‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ "‡∏Ñ‡∏∑‡∏≠/‡πÄ‡∏õ‡πá‡∏ô" ‡πÉ‡∏ä‡πâ‡∏ó‡πâ‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ö‡∏≠‡∏Å‡∏™‡∏†‡∏≤‡∏û',
    exp: '„Åß„Åô ‡πÉ‡∏ä‡πâ formal, „Å† ‡πÉ‡∏ä‡πâ casual ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö verb ‡∏õ‡∏Å‡∏ï‡∏¥',
    examples: [
      {jp:'„Åì„Çå„ÅØ„Éö„É≥„Åß„Åô', ro:'Kore wa pen desu', th:'‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤'},
      {jp:'‰ªäÊó•„ÅØÊúàÊõúÊó•„Å†', ro:'Kyou wa getsuyoubi da', th:'‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå (casual)'},
      {jp:'ÁßÅ„ÅØÂÖàÁîü„Åß„Åô', ro:'Watashi wa sensei desu', th:'‡∏â‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏π'},
    ]
  },
  {
    pattern: '„Å™„ÅÑ (nai) ‚Äî ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò',
    meaning: '‡∏£‡∏π‡∏õ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò = ‡πÑ‡∏°‡πà... (‡πÑ‡∏°‡πà‡∏ó‡∏≥, ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà)',
    exp: '‡πÄ‡∏ï‡∏¥‡∏° „Å™„ÅÑ ‡∏´‡∏•‡∏±‡∏á verb stem ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô',
    examples: [
      {jp:'È£ü„Åπ„Å™„ÅÑ', ro:'tabenai', th:'‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô'},
      {jp:'ÂàÜ„Åã„Çâ„Å™„ÅÑ', ro:'wakaranai', th:'‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à'},
      {jp:'Ë°å„Åã„Å™„ÅÑ', ro:'ikanai', th:'‡πÑ‡∏°‡πà‡πÑ‡∏õ'},
    ]
  },
  {
    pattern: '„Å¶-form ‚Äî ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á',
    meaning: '‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠ verb ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß ‡∏´‡∏£‡∏∑‡∏≠ request (-„Å¶„Åè„Å†„Åï„ÅÑ)',
    exp: '„Å¶-form ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ verb ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏´‡∏•‡∏≤‡∏¢‡πÜ ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô',
    examples: [
      {jp:'È£ü„Åπ„Å¶„Åè„Å†„Åï„ÅÑ', ro:'tabete kudasai', th:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏¥‡∏ô'},
      {jp:'Ëµ∑„Åç„Å¶„ÄÅÈ£ü„Åπ„Å¶„ÄÅË°å„Åè', ro:'okite, tabete, iku', th:'‡∏ï‡∏∑‡πà‡∏ô ‡∏Å‡∏¥‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÑ‡∏õ'},
      {jp:'Ë¶ã„Å¶„Åø„Çã', ro:'mite miru', th:'‡∏•‡∏≠‡∏á‡∏î‡∏π'},
    ]
  },
  {
    pattern: '„Åü„ÅÑ (tai) ‚Äî ‡∏≠‡∏¢‡∏≤‡∏Å‡∏à‡∏∞...',
    meaning: '‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å',
    exp: '‡πÄ‡∏ï‡∏¥‡∏° „Åü„ÅÑ ‡∏´‡∏•‡∏±‡∏á verb stem ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£',
    examples: [
      {jp:'È£ü„Åπ„Åü„ÅÑ', ro:'tabetai', th:'‡∏≠‡∏¢‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô'},
      {jp:'Êó•Êú¨„Å´Ë°å„Åç„Åü„ÅÑ', ro:'nihon ni ikitai', th:'‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏õ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô'},
      {jp:'„ÇÇ„Å£„Å®Áü•„Çä„Åü„ÅÑ', ro:'motto shiritai', th:'‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ'},
    ]
  },
  {
    pattern: '„Åì„Å®„Åå„Åß„Åç„Çã ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ...',
    meaning: '‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ ‡∏ó‡∏≥‡πÑ‡∏î‡πâ',
    exp: '‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö verb + „Åì„Å® ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥ verb ‡πÄ‡∏õ‡πá‡∏ô noun ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ „Åå„Åß„Åç„Çã',
    examples: [
      {jp:'Êó•Êú¨Ë™û„ÇíË©±„Åô„Åì„Å®„Åå„Åß„Åç„Åæ„Åô', ro:'nihongo wo hanasu koto ga dekimasu', th:'‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏π‡∏î‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡πÑ‡∏î‡πâ'},
      {jp:'Ê≥≥„Åê„Åì„Å®„Åå„Åß„Åç„Çã', ro:'oyogu koto ga dekiru', th:'‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡πÑ‡∏î‡πâ'},
    ]
  },
  {
    pattern: '„ÇÇ„ÅÜ / „Åæ„Å† ‚Äî already / still/not yet',
    meaning: '„ÇÇ„ÅÜ = ‡πÅ‡∏•‡πâ‡∏ß / ‡πÑ‡∏°‡πà‡∏≠‡∏µ‡∏Å‡πÅ‡∏•‡πâ‡∏ß, „Åæ„Å† = ‡∏¢‡∏±‡∏á / ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà',
    exp: '‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡πÉ‡∏ô manga ‡∏™‡∏ô‡∏ó‡∏ô‡∏≤ ‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å',
    examples: [
      {jp:'„ÇÇ„ÅÜÈ£ü„Åπ„Åü', ro:'mou tabeta', th:'‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß'},
      {jp:'„Åæ„Å†È£ü„Åπ„Å¶„Å™„ÅÑ', ro:'mada tabeteinai', th:'‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏¥‡∏ô'},
      {jp:'„ÇÇ„ÅÜË´¶„ÇÅ„Åü', ro:'mou akirameta', th:'‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ‡πÅ‡∏•‡πâ‡∏ß'},
    ]
  },
];

const GRAMMAR_N4 = [
  {
    pattern: '„Äú„Å∞ / „Åü„Çâ / „Å® ‚Äî ‡∏ñ‡πâ‡∏≤ (Conditional)',
    meaning: '‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç "‡∏ñ‡πâ‡∏≤...‡∏Å‡πá..."',
    exp: '‡∏°‡∏µ 3 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: „Å® (‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥), „Åü„Çâ (‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå), „Å∞ (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)',
    examples: [
      {jp:'Êò•„Å´„Å™„Çã„Å®Ëä±„ÅåÂí≤„Åè', ro:'haru ni naru to hana ga saku', th:'‡∏ñ‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏§‡∏î‡∏π‡πÉ‡∏ö‡πÑ‡∏°‡πâ‡∏ú‡∏•‡∏¥ ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏Å‡πá‡∏ö‡∏≤‡∏ô'},
      {jp:'„ÅäÈáë„Åå„ÅÇ„Å£„Åü„ÇâÊóÖË°å„Åô„Çã', ro:'okane ga attara ryokou suru', th:'‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á'},
      {jp:'Êó©„ÅèËµ∑„Åç„Çå„Å∞Èñì„Å´Âêà„ÅÜ', ro:'hayaku okireba ma ni au', th:'‡∏ñ‡πâ‡∏≤‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏£‡πá‡∏ß‡∏Å‡πá‡∏ó‡∏±‡∏ô'},
    ]
  },
  {
    pattern: '„Äú„Å¶„ÅÑ„Çã ‚Äî ‡∏Å‡∏≥‡∏•‡∏±‡∏á... / ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà...',
    meaning: 'Continuous ‡∏´‡∏£‡∏∑‡∏≠ Resultant state',
    exp: '‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö motion verb = resultant state, ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö action verb = ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥',
    examples: [
      {jp:'È£ü„Åπ„Å¶„ÅÑ„Çã', ro:'tabete iru', th:'‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà'},
      {jp:'ÁµêÂ©ö„Åó„Å¶„ÅÑ„Çã', ro:'kekkon shite iru', th:'‡πÅ‡∏ï‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß (‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏†‡∏≤‡∏û)'},
      {jp:'Áü•„Å£„Å¶„ÅÑ„Çã', ro:'shitte iru', th:'‡∏£‡∏π‡πâ/‡∏ó‡∏£‡∏≤‡∏ö'},
    ]
  },
  {
    pattern: '„Äú„Å¶„Åó„Åæ„ÅÜ ‚Äî ‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß (‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à/‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î)',
    meaning: '‡∏ó‡∏≥‡∏à‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß',
    exp: '‡πÉ‡∏ô manga ‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å ‡∏™‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤ "‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á"',
    examples: [
      {jp:'È£ü„Åπ„Å¶„Åó„Åæ„Å£„Åü', ro:'tabete shimatta', th:'‡∏Å‡∏¥‡∏ô‡∏´‡∏°‡∏î‡πÄ‡∏•‡∏¢ (‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à)'},
      {jp:'Âøò„Çå„Å¶„Åó„Åæ„Å£„Åü', ro:'wasurete shimatta', th:'‡∏•‡∏∑‡∏°‡∏ã‡∏∞‡πÅ‡∏•‡πâ‡∏ß!'},
      {jp:'Ê≠ª„Çì„Åß„Åó„Åæ„ÅÜÔºÅ', ro:'shinde shimau!', th:'‡∏â‡∏±‡∏ô‡∏à‡∏∞‡∏ï‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß!'},
    ]
  },
  {
    pattern: '„Äú„Åü„ÇÅ„Å´ ‚Äî ‡πÄ‡∏û‡∏∑‡πà‡∏≠',
    meaning: '‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏´‡∏ï‡∏∏',
    exp: '‡πÉ‡∏ä‡πâ‡∏ö‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥',
    examples: [
      {jp:'Êó•Êú¨Ë™û„ÇíÂãâÂº∑„Åô„Çã„Åü„ÇÅ„Å´Êù•„Åü', ro:'nihongo wo benkyou suru tame ni kita', th:'‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô'},
      {jp:'Âêõ„ÅÆ„Åü„ÇÅ„Å´Êà¶„ÅÜ', ro:'kimi no tame ni tatakau', th:'‡∏â‡∏±‡∏ô‡∏™‡∏π‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ò‡∏≠'},
    ]
  },
  {
    pattern: '„Äú„Åã„ÇÇ„Åó„Çå„Å™„ÅÑ ‚Äî ‡∏≠‡∏≤‡∏à‡∏à‡∏∞',
    meaning: '‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à',
    exp: '‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÉ‡∏ô‡∏™‡∏ô‡∏ó‡∏ô‡∏≤ ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì "maybe"',
    examples: [
      {jp:'Èõ®„ÅåÈôç„Çã„Åã„ÇÇ„Åó„Çå„Å™„ÅÑ', ro:'ame ga furu kamoshirenai', th:'‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ù‡∏ô‡∏ï‡∏Å'},
      {jp:'Â•Ω„Åç„Åã„ÇÇ„Åó„Çå„Å™„ÅÑ', ro:'suki kamoshirenai', th:'‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ä‡∏≠‡∏ö‡∏Å‡πá‡πÑ‡∏î‡πâ'},
    ]
  },
];

const GRAMMAR_VERB = [
  {
    pattern: '„Çã-verb conjugation (‰∏ÄÊÆµÂãïË©û)',
    meaning: 'Verb ‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ -eru ‡∏´‡∏£‡∏∑‡∏≠ -iru',
    exp: '‡∏ï‡∏±‡∏î‡∏Å‡πâ‡∏≤‡∏ô „Çã ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ï‡∏¥‡∏° ending ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢',
    examples: [
      {jp:'È£ü„Åπ„Çã ‚Üí È£ü„Åπ„Åæ„Åô / È£ü„Åπ„Å™„ÅÑ / È£ü„Åπ„Åü / È£ü„Åπ„Å¶', ro:'taberu ‚Üí tabemasu / tabenai / tabeta / tabete', th:'‡∏Å‡∏¥‡∏ô ‚Üí ‡∏Å‡∏¥‡∏ô(formal) / ‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô / ‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß / ‡∏Å‡∏¥‡∏ô(te-form)'},
      {jp:'Ë¶ã„Çã ‚Üí Ë¶ã„Åæ„Åô / Ë¶ã„Å™„ÅÑ / Ë¶ã„Åü / Ë¶ã„Å¶', ro:'miru ‚Üí mimasu / minai / mita / mite', th:'‡∏î‡∏π ‚Üí ‡∏î‡∏π(formal) / ‡πÑ‡∏°‡πà‡∏î‡∏π / ‡∏î‡∏π‡πÅ‡∏•‡πâ‡∏ß / ‡∏î‡∏π(te-form)'},
    ]
  },
  {
    pattern: '„ÅÜ-verb conjugation (‰∫îÊÆµÂãïË©û)',
    meaning: 'Verb ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà eru/iru',
    exp: '‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏ß‡πà‡∏≤ ‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πâ‡∏≤‡∏ô',
    examples: [
      {jp:'È£≤„ÇÄ ‚Üí È£≤„Åø„Åæ„Åô / È£≤„Åæ„Å™„ÅÑ / È£≤„Çì„Å† / È£≤„Çì„Åß', ro:'nomu ‚Üí nomimasu / nomanai / nonda / nonde', th:'‡∏î‡∏∑‡πà‡∏° ‚Üí ‡∏î‡∏∑‡πà‡∏°(formal) / ‡πÑ‡∏°‡πà‡∏î‡∏∑‡πà‡∏° / ‡∏î‡∏∑‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß / ‡∏î‡∏∑‡πà‡∏°(te-form)'},
      {jp:'Êõ∏„Åè ‚Üí Êõ∏„Åç„Åæ„Åô / Êõ∏„Åã„Å™„ÅÑ / Êõ∏„ÅÑ„Åü / Êõ∏„ÅÑ„Å¶', ro:'kaku ‚Üí kakimasu / kakanai / kaita / kaite', th:'‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô ‚Üí ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô(formal) / ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô / ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß / ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô(te-form)'},
    ]
  },
  {
    pattern: 'irregular verbs ‚Äî „Åô„Çã / „Åè„Çã',
    meaning: 'Verb ‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≥‡πÅ‡∏¢‡∏Å',
    exp: '‡∏°‡∏µ‡πÅ‡∏Ñ‡πà 2 ‡∏ï‡∏±‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏ï‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å',
    examples: [
      {jp:'„Åô„Çã ‚Üí „Åó„Åæ„Åô / „Åó„Å™„ÅÑ / „Åó„Åü / „Åó„Å¶', ro:'suru ‚Üí shimasu / shinai / shita / shite', th:'‡∏ó‡∏≥ ‚Üí ‡∏ó‡∏≥(formal) / ‡πÑ‡∏°‡πà‡∏ó‡∏≥ / ‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß / ‡∏ó‡∏≥(te-form)'},
      {jp:'„Åè„Çã ‚Üí „Åç„Åæ„Åô / „Åì„Å™„ÅÑ / „Åç„Åü / „Åç„Å¶', ro:'kuru ‚Üí kimasu / konai / kita / kite', th:'‡∏°‡∏≤ ‚Üí ‡∏°‡∏≤(formal) / ‡πÑ‡∏°‡πà‡∏°‡∏≤ / ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß / ‡∏°‡∏≤(te-form)'},
    ]
  },
];

const PARTICLES_DATA = [
  {p:'„ÅØ',ro:'wa',m:'Topic marker ‚Äî ‡∏ö‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ',ex:[
    {jp:'ÁßÅ„ÅØÁî∞‰∏≠„Åß„Åô',ro:'Watashi wa Tanaka desu',th:'‡∏â‡∏±‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏≤‡∏ô‡∏≤‡∏Å‡∏∞'}
  ]},
  {p:'„Åå',ro:'ga',m:'Subject marker ‚Äî ‡πÄ‡∏ô‡πâ‡∏ô subject, ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö like/want',ex:[
    {jp:'Áå´„ÅåÂ•Ω„Åç„Åß„Åô',ro:'Neko ga suki desu',th:'‡∏ä‡∏≠‡∏ö‡πÅ‡∏°‡∏ß'},
    {jp:'Èõ®„ÅåÈôç„Å£„Å¶„ÅÑ„Çã',ro:'Ame ga futte iru',th:'‡∏ù‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏Å'}
  ]},
  {p:'„Çí',ro:'wo',m:'Object marker ‚Äî ‡∏£‡∏±‡∏ö direct object',ex:[
    {jp:'„ÅîÈ£Ø„ÇíÈ£ü„Åπ„Çã',ro:'Gohan wo taberu',th:'‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß'}
  ]},
  {p:'„Å´',ro:'ni',m:'Direction/Time/Location ‚Äî ‡πÑ‡∏õ‡∏ó‡∏µ‡πà, ‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤, ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà',ex:[
    {jp:'Êù±‰∫¨„Å´Ë°å„Åè',ro:'Toukyou ni iku',th:'‡πÑ‡∏õ‡πÇ‡∏ï‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß'},
    {jp:'‰∏âÊôÇ„Å´Êù•„Å¶',ro:'Sanji ni kite',th:'‡∏°‡∏≤‡∏ï‡∏≠‡∏ô‡∏ö‡πà‡∏≤‡∏¢‡∏™‡∏≤‡∏°'}
  ]},
  {p:'„Åß',ro:'de',m:'At/By means of ‚Äî ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô, ‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡πÑ‡∏´‡∏ô',ex:[
    {jp:'Â≠¶Ê†°„ÅßÂãâÂº∑„Åô„Çã',ro:'Gakkou de benkyou suru',th:'‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'},
    {jp:'„Éê„Çπ„ÅßË°å„Åè',ro:'Basu de iku',th:'‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏ñ‡∏ö‡∏±‡∏™'}
  ]},
  {p:'„ÅÆ',ro:'no',m:'Possessive/Modifier ‚Äî ‡∏Ç‡∏≠‡∏á, ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á',ex:[
    {jp:'ÁßÅ„ÅÆÊú¨',ro:'Watashi no hon',th:'‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô'}
  ]},
  {p:'„Å®',ro:'to',m:'And/With ‚Äî ‡πÅ‡∏•‡∏∞, ‡∏Å‡∏±‡∏ö',ex:[
    {jp:'ÂèãÈÅî„Å®ÈÅä„Å∂',ro:'Tomodachi to asobu',th:'‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô'}
  ]},
  {p:'„Åã„Çâ',ro:'kara',m:'From/Because ‚Äî ‡∏à‡∏≤‡∏Å, ‡πÄ‡∏û‡∏£‡∏≤‡∏∞',ex:[
    {jp:'Â≠¶Ê†°„Åã„ÇâÂÆ∂„Åæ„Åß',ro:'Gakkou kara ie made',th:'‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ñ‡∏∂‡∏á‡∏ö‡πâ‡∏≤‡∏ô'}
  ]},
  {p:'„Åæ„Åß',ro:'made',m:'Until/To ‚Äî ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á',ex:[
    {jp:'ÈßÖ„Åæ„ÅßÊ≠©„Åè',ro:'Eki made aruku',th:'‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏õ‡∏ñ‡∏∂‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ'}
  ]},
  {p:'„ÇÇ',ro:'mo',m:'Also/Either ‚Äî ‡∏î‡πâ‡∏ß‡∏¢, ‡∏Å‡πá',ex:[
    {jp:'ÁßÅ„ÇÇË°å„Åè',ro:'Watashi mo iku',th:'‡∏â‡∏±‡∏ô‡∏Å‡πá‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢'}
  ]},
  {p:'„Åã',ro:'ka',m:'Question marker ‚Äî ‡πÉ‡∏ä‡πâ‡∏ó‡πâ‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°',ex:[
    {jp:'È£ü„Åπ„Åæ„Åó„Åü„ÅãÔºü',ro:'Tabemashita ka?',th:'‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?'}
  ]},
  {p:'„Çà',ro:'yo',m:'Assertion ‚Äî ‡πÄ‡∏ô‡πâ‡∏ô ‡∏ö‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà',ex:[
    {jp:'„Åì„Çå„ÅØÂç±„Å™„ÅÑ„Çà',ro:'Kore wa abunai yo',th:'‡∏ô‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ô‡∏∞'}
  ]},
  {p:'„Å≠',ro:'ne',m:'Agreement/Confirmation ‚Äî ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°, ‡∏ô‡∏∞',ex:[
    {jp:'„ÅÑ„ÅÑÂ§©Ê∞ó„Åß„Åô„Å≠',ro:'Ii tenki desu ne',th:'‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏î‡∏µ‡∏ô‡∏∞'}
  ]},
];

const TOOLS_ESSENTIAL = [
  {icon:'üÉè',name:'Anki',desc:'App ‡∏ó‡πà‡∏≠‡∏á‡∏à‡∏≥‡πÅ‡∏ö‡∏ö Spaced Repetition ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å ‡∏ü‡∏£‡∏µ‡∏ö‡∏ô PC/Android',url:'https://apps.ankiweb.net'},
  {icon:'üìñ',name:'Jisho.org',desc:'Dictionary ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô-‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö kanji search',url:'https://jisho.org'},
  {icon:'üåê',name:'Yomitan (Extension)',desc:'Hover ‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÑ‡∏õ‡∏Ñ‡∏≥‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÅ‡∏õ‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö',url:'https://github.com/themoeway/yomitan'},
  {icon:'üìù',name:'Tae Kim\'s Guide',desc:'‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ grammar ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏ü‡∏£‡∏µ ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö self-study',url:'https://guidetojapanese.org'},
  {icon:'üìä',name:'Bunpro.jp',desc:'‡∏ù‡∏∂‡∏Å grammar ‡πÅ‡∏ö‡∏ö SRS ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Anki ‡πÅ‡∏ï‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞ grammar',url:'https://bunpro.jp'},
  {icon:'üé•',name:'Cure Dolly (YouTube)',desc:'‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ grammar ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡πÅ‡∏ö‡∏ö conceptual ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à logic ‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤',url:'https://www.youtube.com/@CureDolly'},
];

const TOOLS_MANGA = [
  {icon:'üì∏',name:'Mokuro',desc:'‡πÅ‡∏õ‡∏•‡∏á manga image ‡πÄ‡∏õ‡πá‡∏ô HTML ‡πÉ‡∏´‡πâ hover ‡∏≠‡πà‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Yomitan ‡πÑ‡∏î‡πâ',url:'https://github.com/kha-white/mokuro'},
  {icon:'üîç',name:'Manga OCR',desc:'OCR ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ manga ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô text copy ‡πÑ‡∏î‡πâ',url:'https://github.com/kha-white/manga-ocr'},
  {icon:'üì±',name:'Bilingual Manga',desc:'‡πÄ‡∏ß‡πá‡∏ö‡∏≠‡πà‡∏≤‡∏ô manga ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á Japanese ‡πÅ‡∏•‡∏∞ English ‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ô',url:'https://bilingualmanga.org'},
  {icon:'üóÇÔ∏è',name:'Itazuraneko',desc:'‡πÅ‡∏´‡∏•‡πà‡∏á raw manga ‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏∂‡∏Å‡∏≠‡πà‡∏≤‡∏ô',url:'https://itazuraneko.neocities.org'},
  {icon:'üëÅÔ∏è',name:'KanjiTomo',desc:'‡∏ä‡∏µ‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà manga ‡πÅ‡∏•‡πâ‡∏ß OCR + ‡πÅ‡∏õ‡∏•‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (Windows)',url:'http://kanjitomo.net'},
  {icon:'üìö',name:'Bookwalker JP',desc:'‡∏£‡πâ‡∏≤‡∏ô‡∏ã‡∏∑‡πâ‡∏≠ digital manga ‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î',url:'https://bookwalker.jp'},
];

const TOOLS_GAME = [
  {icon:'‚ö°',name:'Textractor',desc:'‡∏î‡∏∂‡∏á text ‡∏à‡∏≤‡∏Å VN/‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö Yomitan ‡πÑ‡∏î‡πâ',url:'https://github.com/Artikash/Textractor'},
  {icon:'üéÆ',name:'ITH / ITHVNR',desc:'Hook text ‡∏à‡∏≤‡∏Å Visual Novel ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö translator',url:'https://github.com/zxyacb/ntlea'},
  {icon:'üîß',name:'Locale Emulator',desc:'Run ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏ö‡∏ô Windows ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô locale',url:'https://github.com/xupefei/Locale-Emulator'},
  {icon:'üí¨',name:'JL (JL App)',desc:'‡∏£‡∏∞‡∏ö‡∏ö lookup ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡πÅ‡∏ö‡∏ö real-time ‡∏à‡∏≤‡∏Å clipboard',url:'https://github.com/rampaa/JL'},
  {icon:'üåê',name:'Agent (VN reader)',desc:'App ‡∏≠‡πà‡∏≤‡∏ô VN ‡∏û‡∏£‡πâ‡∏≠‡∏° popup dictionary ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß',url:'https://github.com/kfox111/agent'},
  {icon:'üéØ',name:'JP Games on Steam',desc:'‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏ö‡∏ô Steam ‡∏°‡∏±‡∏Å‡∏°‡∏µ‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å',url:'https://store.steampowered.com'},
];

const TOOLS_DICT = [
  {icon:'üìñ',name:'Jisho.org',desc:'Dictionary ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö stroke order ‡πÅ‡∏•‡∏∞ radical search',url:'https://jisho.org'},
  {icon:'üî§',name:'Weblio',desc:'Dictionary ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô-‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏•‡∏≤‡∏á-‡∏™‡∏π‡∏á',url:'https://www.weblio.jp'},
  {icon:'üìù',name:'DeepL',desc:'‡πÅ‡∏õ‡∏•‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ Google Translate ‡∏°‡∏≤‡∏Å',url:'https://www.deepl.com'},
  {icon:'üîç',name:'ichi.moe',desc:'‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå grammar ‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ ‡∏ö‡∏≠‡∏Å particle, verb form ‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß',url:'https://ichi.moe'},
  {icon:'Êº¢',name:'Kanji.sh',desc:'‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ kanji ‡πÅ‡∏ö‡∏ö visual ‡∏û‡∏£‡πâ‡∏≠‡∏° stroke order animation',url:'https://kanji.sh'},
  {icon:'üéå',name:'Kanshudo',desc:'‡πÄ‡∏£‡∏µ‡∏¢‡∏ô kanji ‡πÅ‡∏ö‡∏ö gamified ‡πÄ‡∏ô‡πâ‡∏ô recognition',url:'https://www.kanshudo.com'},
];

// ============================================================
// STATE
// ============================================================
const state = {
  hiraLearned: JSON.parse(localStorage.getItem('hiraLearned') || '[]'),
  kataLearned: JSON.parse(localStorage.getItem('kataLearned') || '[]'),
  vocabKnown: JSON.parse(localStorage.getItem('vocabKnown') || '[]'),
  kanjiKnown: JSON.parse(localStorage.getItem('kanjiKnown') || '[]'),
  hiraIdx: 0, kataIdx: 0,
  mainFCData: [], mainFCIdx: 0, mainFlipped: false,
  quizType: '', quizIdx: 0, quizScore: 0, quizData: [],
  vsrsQueue: [], vsrsIdx: 0, vsrsFlipped: false,
  currentKanjiIdx: -1,
};

function save() {
  localStorage.setItem('hiraLearned', JSON.stringify(state.hiraLearned));
  localStorage.setItem('kataLearned', JSON.stringify(state.kataLearned));
  localStorage.setItem('vocabKnown', JSON.stringify(state.vocabKnown));
  localStorage.setItem('kanjiKnown', JSON.stringify(state.kanjiKnown));
}

// ============================================================
// NAVIGATION
// ============================================================
function showPage(id) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('page-' + id).classList.add('active');
  updateStats();
}

function switchTab(group, tab) {
  document.querySelectorAll(`[id^="${group}-"]`).forEach(el => {
    if (el.classList.contains('tab-panel')) el.classList.remove('active');
  });
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  const panel = document.getElementById(`${group}-${tab}`);
  if (panel) panel.classList.add('active');
  event.target.classList.add('active');
}

// ============================================================
// STATS
// ============================================================
function updateStats() {
  const hl = state.hiraLearned.length;
  const kl = state.kataLearned.length;
  const vl = state.vocabKnown.length;
  const kjl = state.kanjiKnown.length;
  
  setText('s-hira', hl);
  setText('s-kata', kl);
  setText('s-vocab', vl);
  setText('s-kanji', kjl);
  
  setPW('pb-hira', hl/46*100);
  setPW('pb-kata', kl/46*100);
  setPW('pb-vocab', vl/150*100);
  setPW('pb-kanji', kjl/80*100);
  
  setText('np-hira', `${hl}/46`);
  setText('np-kata', `${kl}/46`);
  setText('np-vocab', `${vl}/150`);
  setText('np-kanji', `${kjl}/80`);
  
  // Update kana grids
  updateKanaGrid('hira');
  updateKanaGrid('kata');
  
  // Level
  const total = hl + kl + vl*0.5 + kjl*0.5;
  let level, emoji;
  if (total < 20) { level='Beginner'; emoji='ü•ö'; }
  else if (total < 60) { level='N5 Student'; emoji='üê£'; }
  else if (total < 120) { level='Kana Master'; emoji='üìñ'; }
  else if (total < 200) { level='N4 Learner'; emoji='üéì'; }
  else { level='Manga Reader!'; emoji='üìï'; }
  const li = document.getElementById('level-indicator');
  if (li) li.innerHTML = `<div style="font-size:40px">${emoji}</div><div style="font-size:20px;color:var(--gold);font-weight:700;margin-top:8px">${level}</div><div style="font-size:12px;color:var(--text2);margin-top:4px">‡∏£‡∏ß‡∏° ${Math.round(total)} points</div>`;
}

function setText(id, val) { const el = document.getElementById(id); if(el) el.textContent = val; }
function setPW(id, pct) { const el = document.getElementById(id); if(el) el.style.width = Math.min(100,pct)+'%'; }

// ============================================================
// KANA GRID
// ============================================================
function buildKanaGrid(type) {
  const data = type === 'hira' ? HIRAGANA : KATAKANA;
  const grid = document.getElementById(`${type}-grid`);
  if (!grid) return;
  grid.innerHTML = '';
  data.forEach((k, i) => {
    const div = document.createElement('div');
    div.className = 'kana-cell' + (state[`${type}Learned`].includes(i) ? ' learned' : '');
    div.innerHTML = `<div class="kana-jp">${k.jp}</div><div class="kana-ro">${k.ro}</div>`;
    div.onclick = () => toggleKana(type, i, div);
    grid.appendChild(div);
  });
}

function buildComboGrid() {
  const grid = document.getElementById('hira-combo-grid');
  if (!grid) return;
  grid.innerHTML = '';
  HIRA_COMBO.forEach(k => {
    const div = document.createElement('div');
    div.className = 'kana-cell';
    div.innerHTML = `<div class="kana-jp" style="font-size:16px">${k.jp}</div><div class="kana-ro">${k.ro}</div>`;
    grid.appendChild(div);
  });
}

function toggleKana(type, idx, el) {
  const arr = state[`${type}Learned`];
  const pos = arr.indexOf(idx);
  if (pos === -1) { arr.push(idx); el.classList.add('learned'); showNotif('‚úì ‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß!', 'green'); }
  else { arr.splice(pos, 1); el.classList.remove('learned'); }
  el.classList.add('pop');
  setTimeout(() => el.classList.remove('pop'), 300);
  save(); updateStats();
}

function updateKanaGrid(type) {
  const data = type === 'hira' ? HIRAGANA : KATAKANA;
  const grid = document.getElementById(`${type}-grid`);
  if (!grid) return;
  grid.querySelectorAll('.kana-cell').forEach((el, i) => {
    el.classList.toggle('learned', state[`${type}Learned`].includes(i));
  });
}

function markAllKana(type) {
  const data = type === 'hira' ? HIRAGANA : KATAKANA;
  state[`${type}Learned`] = data.map((_,i) => i);
  save(); buildKanaGrid(type); updateStats();
  showNotif('‚úì ‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß!', 'green');
}

function clearAllKana(type) {
  state[`${type}Learned`] = [];
  save(); buildKanaGrid(type); updateStats();
}

// ============================================================
// FLASHCARD (kana)
// ============================================================
function flipCard(type) {
  const fc = document.getElementById(type === 'hira' ? 'hira-fc' : type === 'kata' ? 'kata-fc' : type === 'vsrs' ? 'vocab-srs-fc' : 'main-fc');
  fc.classList.toggle('flipped');
  if (type === 'vsrs') {
    state.vsrsFlipped = fc.classList.contains('flipped');
    document.getElementById('vsrs-btns').style.display = state.vsrsFlipped ? 'flex' : 'none';
  }
}

function nextCard(type) {
  const data = type === 'hira' ? HIRAGANA : KATAKANA;
  state[`${type}Idx`] = (state[`${type}Idx`] + 1) % data.length;
  updateFC(type);
}

function prevCard(type) {
  const data = type === 'hira' ? HIRAGANA : KATAKANA;
  state[`${type}Idx`] = (state[`${type}Idx`] - 1 + data.length) % data.length;
  updateFC(type);
}

function markKnown(type) {
  const idx = state[`${type}Idx`];
  if (!state[`${type}Learned`].includes(idx)) {
    state[`${type}Learned`].push(idx);
    save(); updateStats();
    showNotif('‚úì ‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß!', 'green');
  }
  nextCard(type);
}

function updateFC(type) {
  const data = type === 'hira' ? HIRAGANA : KATAKANA;
  const idx = state[`${type}Idx`];
  const fc = document.getElementById(`${type}-fc`);
  fc.classList.remove('flipped');
  setText(`${type}-char`, data[idx].jp);
  setText(`${type}-read`, data[idx].ro);
  setText(`${type}-fc-counter`, `${idx+1} / ${data.length}`);
}

// ============================================================
// KANA QUIZ
// ============================================================
let quizState = { type: '', idx: 0, score: 0, total: 0, answered: false };

function initKanaQuiz(type) {
  const data = type === 'hira' ? HIRAGANA : KATAKANA;
  const shuffled = [...data].sort(() => Math.random() - 0.5);
  quizState = { type, data: shuffled, idx: 0, score: 0, total: 0, answered: false };
  showKanaQuizQ(type);
}

function showKanaQuizQ(type) {
  const qs = quizState;
  const curr = qs.data[qs.idx];
  setText(`${type}-quiz-char`, curr.jp);
  
  // 4 options
  const opts = [curr.ro];
  const pool = (type === 'hira' ? HIRAGANA : KATAKANA).filter(k => k.ro !== curr.ro);
  while (opts.length < 4) {
    const r = pool[Math.floor(Math.random()*pool.length)].ro;
    if (!opts.includes(r)) opts.push(r);
  }
  opts.sort(() => Math.random() - 0.5);
  
  const container = document.getElementById(`${type}-quiz-opts`);
  container.innerHTML = '';
  opts.forEach(opt => {
    const div = document.createElement('div');
    div.className = 'quiz-opt';
    div.textContent = opt;
    div.onclick = () => checkKanaAnswer(type, opt, curr.ro, div);
    container.appendChild(div);
  });
  
  setText(`${type}-quiz-result`, '');
  const nb = document.getElementById(`${type}-next-btn`);
  if (nb) nb.style.display = 'none';
  quizState.answered = false;
}

function checkKanaAnswer(type, chosen, correct, el) {
  if (quizState.answered) return;
  quizState.answered = true;
  quizState.total++;
  
  const container = document.getElementById(`${type}-quiz-opts`);
  container.querySelectorAll('.quiz-opt').forEach(opt => {
    if (opt.textContent === correct) opt.classList.add('correct');
    else if (opt === el && chosen !== correct) opt.classList.add('wrong');
  });
  
  if (chosen === correct) {
    quizState.score++;
    setText(`${type}-quiz-result`, '‚úì ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!');
    document.getElementById(`${type}-quiz-result`).style.color = 'var(--teal2)';
  } else {
    setText(`${type}-quiz-result`, `‚úó ‡∏ú‡∏¥‡∏î ‚Äî ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏≠: ${correct}`);
    document.getElementById(`${type}-quiz-result`).style.color = 'var(--red2)';
  }
  
  setText(`${type}-quiz-score`, `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${quizState.score}/${quizState.total}`);
  const nb = document.getElementById(`${type}-next-btn`);
  if (nb) nb.style.display = 'block';
}

function nextQuizQ(type) {
  quizState.idx = (quizState.idx + 1) % quizState.data.length;
  showKanaQuizQ(type);
}

// ============================================================
// FULL QUIZ GAME
// ============================================================
let gq = { type:'', data:[], idx:0, score:0, total:10, answered:false };

function startQuiz(type) {
  document.getElementById('quiz-select').style.display = 'none';
  document.getElementById('quiz-game').style.display = 'block';
  document.getElementById('quiz-result').style.display = 'none';
  
  let data, questionText;
  if (type === 'hira') { data = [...HIRAGANA].sort(() => Math.random()-0.5).slice(0,10); questionText = 'Romaji ‡∏Ç‡∏≠‡∏á Hiragana ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?'; }
  else if (type === 'kata') { data = [...KATAKANA].sort(() => Math.random()-0.5).slice(0,10); questionText = 'Romaji ‡∏Ç‡∏≠‡∏á Katakana ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?'; }
  else { data = [...VOCAB_N5].sort(() => Math.random()-0.5).slice(0,10); questionText = '‡∏Ñ‡∏≥‡∏ô‡∏µ‡πâ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?'; }
  
  gq = { type, data, idx:0, score:0, total:10, answered:false, questionText };
  setText('qg-title', type === 'hira' ? 'Hiragana Quiz' : type === 'kata' ? 'Katakana Quiz' : 'Vocabulary Quiz');
  showGQQuestion();
}

function showGQQuestion() {
  const curr = gq.data[gq.idx];
  const isVocab = gq.type === 'vocab';
  
  setText('qg-char', isVocab ? curr.jp : curr.jp);
  document.getElementById('qg-char').style.fontSize = isVocab ? '40px' : '72px';
  setText('qg-question', gq.questionText);
  setText('qg-progress', `‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${gq.idx+1}/${gq.total}`);
  setText('qg-score', `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${gq.score}`);
  setPW('qg-pb', (gq.idx/gq.total)*100);
  
  const correct = isVocab ? curr.th : curr.ro;
  const pool = isVocab ? VOCAB_N5 : (gq.type === 'hira' ? HIRAGANA : KATAKANA);
  const opts = [correct];
  const poolFiltered = pool.filter(k => (isVocab ? k.th : k.ro) !== correct);
  while (opts.length < 4) {
    const r = poolFiltered[Math.floor(Math.random()*poolFiltered.length)];
    const val = isVocab ? r.th : r.ro;
    if (!opts.includes(val)) opts.push(val);
  }
  opts.sort(() => Math.random()-0.5);
  
  const container = document.getElementById('qg-opts');
  container.innerHTML = '';
  opts.forEach(opt => {
    const div = document.createElement('div');
    div.className = 'quiz-opt';
    div.textContent = opt;
    div.onclick = () => checkGQAnswer(opt, correct, div);
    container.appendChild(div);
  });
  
  setText('qg-result', '');
  document.getElementById('qg-next').style.display = 'none';
  gq.answered = false;
}

function checkGQAnswer(chosen, correct, el) {
  if (gq.answered) return;
  gq.answered = true;
  
  document.getElementById('qg-opts').querySelectorAll('.quiz-opt').forEach(opt => {
    if (opt.textContent === correct) opt.classList.add('correct');
    else if (opt === el && chosen !== correct) opt.classList.add('wrong');
  });
  
  if (chosen === correct) {
    gq.score++;
    setText('qg-result', '‚úì ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!');
    document.getElementById('qg-result').style.color = 'var(--teal2)';
  } else {
    setText('qg-result', `‚úó ‡∏ú‡∏¥‡∏î ‚Äî ‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏≠: ${correct}`);
    document.getElementById('qg-result').style.color = 'var(--red2)';
  }
  setText('qg-score', `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${gq.score}`);
  document.getElementById('qg-next').style.display = gq.idx < gq.total-1 ? 'block' : 'none';
  
  if (gq.idx >= gq.total-1) {
    setTimeout(() => showQuizResult(), 1200);
  }
}

function nextQGQuestion() {
  gq.idx++;
  if (gq.idx >= gq.total) { showQuizResult(); return; }
  showGQQuestion();
}

function showQuizResult() {
  document.getElementById('quiz-game').style.display = 'none';
  document.getElementById('quiz-result').style.display = 'block';
  
  const pct = gq.score / gq.total;
  let emoji, msg;
  if (pct >= 0.9) { emoji='üèÜ'; msg='‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! Á¥†Êô¥„Çâ„Åó„ÅÑÔºÅ'; }
  else if (pct >= 0.7) { emoji='üéâ'; msg='‡∏î‡∏µ‡∏°‡∏≤‡∏Å! „Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅ'; }
  else if (pct >= 0.5) { emoji='üòä'; msg='‡∏û‡∏≠‡πÑ‡∏î‡πâ! ‡∏ù‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á‡∏ô‡∏∞'; }
  else { emoji='üí™'; msg='‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏°‡πà‡∏ô ‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á! È†ëÂºµ„ÇåÔºÅ'; }
  
  setText('qr-emoji', emoji);
  setText('qr-score', `${gq.score}/${gq.total}`);
  setText('qr-msg', msg);
  setText('qr-label', '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì');
  
  const retryBtn = document.getElementById('qr-retry');
  retryBtn.onclick = () => startQuiz(gq.type);
}

// ============================================================
// GRAMMAR
// ============================================================
function buildGrammar() {
  buildGramSection('gram-n5', GRAMMAR_N5);
  buildGramSection('gram-n4', GRAMMAR_N4);
  buildGramSection('gram-verb', GRAMMAR_VERB);
}

function buildGramSection(containerId, data) {
  const container = document.getElementById(containerId);
  if (!container) return;
  container.innerHTML = '';
  data.forEach((g, i) => {
    const div = document.createElement('div');
    div.className = 'grammar-card';
    div.innerHTML = `
      <div class="grammar-header" onclick="toggleGram(${i}, '${containerId}')">
        <div>
          <div class="grammar-pattern">${g.pattern}</div>
          <div class="grammar-meaning">${g.meaning}</div>
        </div>
        <span style="color:var(--text3);font-size:18px" id="gram-arrow-${containerId}-${i}">‚ñº</span>
      </div>
      <div class="grammar-body" id="gram-body-${containerId}-${i}">
        <p style="font-size:13px;color:var(--text2);padding-top:16px;line-height:1.7">${g.exp}</p>
        <div style="margin-top:16px">
          <div style="font-size:11px;color:var(--text3);letter-spacing:1px;margin-bottom:8px">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</div>
          ${g.examples.map(ex => `
            <div class="example">
              <div class="example-jp">${ex.jp}</div>
              <div class="example-ro">${ex.ro}</div>
              <div class="example-th">üáπüá≠ ${ex.th}</div>
            </div>
          `).join('')}
        </div>
      </div>
    `;
    container.appendChild(div);
  });
}

function toggleGram(idx, cid) {
  const body = document.getElementById(`gram-body-${cid}-${idx}`);
  const arrow = document.getElementById(`gram-arrow-${cid}-${idx}`);
  body.classList.toggle('open');
  arrow.textContent = body.classList.contains('open') ? '‚ñ≤' : '‚ñº';
}

// ============================================================
// PARTICLES
// ============================================================
function buildParticles() {
  const container = document.getElementById('particles-content');
  if (!container) return;
  container.innerHTML = `<div class="info-box">üí° Particles ‡∏Ñ‡∏∑‡∏≠ "‡∏Å‡∏≤‡∏ß" ‡∏ó‡∏µ‡πà‡∏¢‡∏∂‡∏î‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏≥‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏∞‡πÑ‡∏£ ‚Äî ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</div>`;
  
  const grid = document.createElement('div');
  grid.className = 'grid2';
  
  PARTICLES_DATA.forEach(p => {
    const div = document.createElement('div');
    div.className = 'grammar-card';
    div.innerHTML = `
      <div class="grammar-header" onclick="this.nextSibling.classList.toggle('open')">
        <div style="display:flex;align-items:center;gap:16px">
          <div style="font-family:'Noto Serif JP';font-size:32px;color:var(--gold);min-width:40px">${p.p}</div>
          <div>
            <div class="grammar-pattern">${p.ro}</div>
            <div class="grammar-meaning">${p.m}</div>
          </div>
        </div>
        <span style="color:var(--text3)">‚ñº</span>
      </div>
      <div class="grammar-body">
        ${p.ex.map(e => `
          <div class="example">
            <div class="example-jp">${e.jp}</div>
            <div class="example-ro">${e.ro}</div>
            <div class="example-th">üáπüá≠ ${e.th}</div>
          </div>
        `).join('')}
      </div>
    `;
    grid.appendChild(div);
  });
  container.appendChild(grid);
}

// ============================================================
// VOCAB
// ============================================================
function buildVocab() {
  buildVocabList('vocab-list-n5', VOCAB_N5, 'N5');
  buildVocabList('vocab-list-n4', VOCAB_N4, 'N4');
  buildVocabList('vocab-list-manga', VOCAB_MANGA, 'manga');
  
  buildMangaVocab('mvc-action', MANGA_ACTION, 'action');
  buildMangaVocab('mvc-emotion', MANGA_EMOTION, 'emotion');
  buildMangaVocab('mvc-daily', MANGA_DAILY, 'daily');
  buildMangaVocab('mvc-romance', MANGA_ROMANCE, 'romance');
  buildMangaVocab('mvc-adult', MANGA_ADULT, 'adult');
  
  initSRS();
}

function buildVocabList(containerId, data, tagClass) {
  const container = document.getElementById(containerId);
  if (!container) return;
  container.innerHTML = '';
  data.forEach((v, i) => {
    container.appendChild(makeVocabCard(v, i, tagClass));
  });
}

function makeVocabCard(v, i, tagClass) {
  const div = document.createElement('div');
  div.className = 'vocab-item' + (state.vocabKnown.includes(v.jp) ? ' known' : '');
  div.dataset.jp = v.jp;
  div.innerHTML = `
    <div class="vocab-jp">${v.jp}</div>
    <div class="vocab-ro">${v.ro}</div>
    <div class="vocab-th">${v.th}</div>
    <div><span class="vocab-tag ${tagClass}">${tagClass.toUpperCase()}</span></div>
    ${state.vocabKnown.includes(v.jp) ? '<span style="position:absolute;top:8px;right:8px;font-size:12px;color:var(--teal2)">‚úì</span>' : ''}
  `;
  div.style.position = 'relative';
  div.onclick = () => toggleVocab(v.jp, div);
  return div;
}

function buildMangaVocab(containerId, data, tag) {
  const container = document.getElementById(containerId);
  if (!container) return;
  container.innerHTML = '';
  data.forEach(v => {
    const div = document.createElement('div');
    div.className = 'vocab-item' + (state.vocabKnown.includes(v.jp) ? ' known' : '');
    div.style.position = 'relative';
    div.innerHTML = `
      <div class="vocab-jp">${v.jp}</div>
      <div class="vocab-ro">${v.ro}</div>
      <div class="vocab-th">${v.th}</div>
      <div><span class="vocab-tag ${tag}">${tag.toUpperCase()}</span></div>
      ${state.vocabKnown.includes(v.jp) ? '<span style="position:absolute;top:8px;right:8px;font-size:12px;color:var(--teal2)">‚úì</span>' : ''}
    `;
    div.onclick = () => toggleVocab(v.jp, div);
    container.appendChild(div);
  });
}

function toggleVocab(jp, el) {
  const idx = state.vocabKnown.indexOf(jp);
  if (idx === -1) {
    state.vocabKnown.push(jp);
    el.classList.add('known');
    showNotif('‚úì ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß!', 'green');
    let badge = el.querySelector('span:last-child');
    if (!badge || !badge.textContent.includes('‚úì')) {
      const b = document.createElement('span');
      b.style.cssText = 'position:absolute;top:8px;right:8px;font-size:12px;color:var(--teal2)';
      b.textContent = '‚úì';
      el.appendChild(b);
    }
  } else {
    state.vocabKnown.splice(idx, 1);
    el.classList.remove('known');
    const badge = el.querySelector('span[style*="teal"]');
    if (badge) badge.remove();
  }
  save(); updateStats();
}

function filterVocab(q, type) {
  const containerId = `vocab-list-${type}`;
  const container = document.getElementById(containerId);
  if (!container) return;
  container.querySelectorAll('.vocab-item').forEach(el => {
    const match = el.dataset.jp && (el.textContent.toLowerCase().includes(q.toLowerCase()));
    el.style.display = match || !q ? '' : 'none';
  });
}

// ============================================================
// SRS
// ============================================================
function initSRS() {
  const allVocab = [...VOCAB_N5, ...VOCAB_N4];
  state.vsrsQueue = allVocab.filter(v => !state.vocabKnown.includes(v.jp))
    .sort(() => Math.random()-0.5).slice(0, 20);
  state.vsrsIdx = 0;
  showSRSCard();
}

function showSRSCard() {
  const fc = document.getElementById('vocab-srs-fc');
  if (fc) fc.classList.remove('flipped');
  document.getElementById('vsrs-btns').style.display = 'none';
  
  const q = state.vsrsQueue;
  if (!q || q.length === 0) {
    setText('vsrs-jp', '‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!');
    setText('vsrs-ro', '');
    setText('vsrs-th', '‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß!');
    setText('vsrs-counter', '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß üéâ');
    return;
  }
  const curr = q[state.vsrsIdx % q.length];
  setText('vsrs-jp', curr.jp);
  setText('vsrs-ro', curr.ro);
  setText('vsrs-th', curr.th);
  setText('vsrs-counter', `‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${q.length} ‡∏Ñ‡∏≥`);
}

function rateSRS(rating) {
  if (rating === 'easy') {
    const curr = state.vsrsQueue[state.vsrsIdx % state.vsrsQueue.length];
    state.vocabKnown.push(curr.jp);
    state.vsrsQueue.splice(state.vsrsIdx % state.vsrsQueue.length, 1);
    save(); updateStats();
    showNotif('‚úì ‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏ó‡∏µ‡πà "‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß"', 'green');
  } else {
    state.vsrsIdx++;
  }
  const fc = document.getElementById('vocab-srs-fc');
  if (fc) fc.classList.remove('flipped');
  document.getElementById('vsrs-btns').style.display = 'none';
  showSRSCard();
}

// ============================================================
// KANJI
// ============================================================
function buildKanji() {
  const grid = document.getElementById('kanji-grid');
  if (!grid) return;
  grid.innerHTML = '';
  KANJI_N5.forEach((k, i) => {
    const div = document.createElement('div');
    div.className = 'kanji-card' + (state.kanjiKnown.includes(k.k) ? ' learned' : '');
    div.style.cssText = state.kanjiKnown.includes(k.k) ? 'border-color:var(--teal);position:relative' : 'position:relative';
    div.innerHTML = `
      <div class="kanji-char">${k.k}</div>
      <div class="kanji-on">On: ${k.on}</div>
      <div class="kanji-kun">Kun: ${k.kun}</div>
      <div class="kanji-meaning">${k.m}</div>
      ${state.kanjiKnown.includes(k.k) ? '<div style="position:absolute;top:8px;right:8px;font-size:12px;color:var(--teal2)">‚úì</div>' : ''}
    `;
    div.onclick = () => openKanjiModal(i);
    grid.appendChild(div);
  });
}

function openKanjiModal(i) {
  state.currentKanjiIdx = i;
  const k = KANJI_N5[i];
  setText('km-char', k.k);
  setText('km-on', `Èü≥Ë™≠„Åø (On-yomi): ${k.on}`);
  setText('km-kun', `Ë®ìË™≠„Åø (Kun-yomi): ${k.kun}`);
  setText('km-meaning', k.m);
  setText('km-examples', `‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ${k.ex}`);
  
  const modal = document.getElementById('kanji-modal');
  modal.style.display = 'flex';
  modal.onclick = (e) => { if(e.target === modal) closeKanjiModal(); };
}

function closeKanjiModal() {
  document.getElementById('kanji-modal').style.display = 'none';
}

function markKanjiKnown() {
  const k = KANJI_N5[state.currentKanjiIdx];
  if (!state.kanjiKnown.includes(k.k)) {
    state.kanjiKnown.push(k.k);
    save(); updateStats();
    showNotif('‚úì Kanji ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß!', 'green');
  }
  closeKanjiModal();
  buildKanji();
}

// ============================================================
// MAIN FLASHCARD
// ============================================================
function loadFC(type) {
  let data;
  if (type === 'hira') data = HIRAGANA.map(k => ({front:k.jp, back:k.ro, extra:'„Å≤„Çâ„Åå„Å™'}));
  else if (type === 'kata') data = KATAKANA.map(k => ({front:k.jp, back:k.ro, extra:'„Ç´„Çø„Ç´„Éä'}));
  else if (type === 'n5v') data = VOCAB_N5.map(v => ({front:v.jp, back:v.th, extra:v.ro}));
  else if (type === 'kj') data = KANJI_N5.map(k => ({front:k.k, back:k.m, extra:`${k.on} / ${k.kun}`}));
  
  state.mainFCData = data.sort(() => Math.random()-0.5);
  state.mainFCIdx = 0;
  updateMainFC();
}

function updateMainFC() {
  const d = state.mainFCData;
  if (!d || d.length === 0) return;
  const fc = document.getElementById('main-fc');
  if (fc) fc.classList.remove('flipped');
  const curr = d[state.mainFCIdx];
  setText('main-fc-front', curr.front);
  setText('main-fc-back', curr.back);
  setText('main-fc-extra', curr.extra || '');
  setText('main-fc-type', '‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö');
  setText('main-fc-counter', `${state.mainFCIdx+1} / ${d.length}`);
}

function mainFC_next() {
  if (!state.mainFCData.length) return;
  state.mainFCIdx = (state.mainFCIdx+1) % state.mainFCData.length;
  updateMainFC();
}

function mainFC_prev() {
  if (!state.mainFCData.length) return;
  state.mainFCIdx = (state.mainFCIdx-1+state.mainFCData.length) % state.mainFCData.length;
  updateMainFC();
}

// ============================================================
// TOOLS
// ============================================================
function buildTools() {
  buildToolGrid('tools-essential', TOOLS_ESSENTIAL);
  buildToolGrid('tools-manga', TOOLS_MANGA);
  buildToolGrid('tools-game', TOOLS_GAME);
  buildToolGrid('tools-dict', TOOLS_DICT);
}

function buildToolGrid(containerId, data) {
  const container = document.getElementById(containerId);
  if (!container) return;
  container.innerHTML = '';
  data.forEach(t => {
    const div = document.createElement('div');
    div.className = 'tool-card';
    div.innerHTML = `
      <div class="tool-icon">${t.icon}</div>
      <div class="tool-name">${t.name}</div>
      <div class="tool-desc">${t.desc}</div>
      <a href="${t.url}" target="_blank" class="tool-link">üîó ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö ‚Üí</a>
    `;
    container.appendChild(div);
  });
}

// ============================================================
// DAILY TIP
// ============================================================
const TIPS = [
  'üí° <b>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</b> ‡πÅ‡∏°‡πâ‡πÅ‡∏Ñ‡πà 15 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ 3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
  'üí° <b>‡∏≠‡∏¢‡πà‡∏≤‡∏ó‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö brute force</b> ‚Äî ‡πÉ‡∏ä‡πâ Anki SRS ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥',
  'üí° <b>Hiragana ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</b> ‚Äî ‡∏à‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡πÅ‡∏£‡∏Å ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å',
  'üí° <b>Yomitan</b> ‡∏Ñ‡∏∑‡∏≠ extension ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‚Äî ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ô Chrome ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ‡∏Ñ‡∏≥‡πÑ‡∏´‡∏ô‡∏Å‡πá‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ',
  'üí° <b>Immersion</b> ‚Äî ‡∏≠‡πà‡∏≤‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3 ‡πÅ‡∏°‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏™‡∏°‡∏≠‡∏á‡∏à‡∏∞‡∏î‡∏π‡∏î‡∏ã‡∏∂‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ï‡∏±‡∏ß',
  'üí° <b>Particles „ÅØ vs „Åå</b> ‚Äî „ÅØ ‡πÄ‡∏ô‡πâ‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠, „Åå ‡πÄ‡∏ô‡πâ‡∏ô subject ‚Äî ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å',
  'üí° <b>Textractor + Yomitan</b> = ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡∏£‡∏π‡πâ‡∏†‡∏≤‡∏©‡∏≤‡∏ô‡πâ‡∏≠‡∏¢ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ hover ‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡∏•‡∏≠‡∏î',
  'üí° ‡πÉ‡∏ô‡∏°‡∏±‡∏á‡∏á‡∏∞ ‡∏ï‡∏±‡∏ß <b>Katakana</b> ‡∏°‡∏±‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á ‡πÄ‡∏ä‡πà‡∏ô „Éâ„Ç≠„Éâ„Ç≠ (‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô), „Ç≠„É£„Éº (‡∏Å‡∏£‡∏µ‡πä‡∏î)',
];

// ============================================================
// NOTIFICATION
// ============================================================
function showNotif(msg, type = 'green') {
  const el = document.getElementById('notif');
  el.textContent = msg;
  el.className = `notif ${type} show`;
  setTimeout(() => el.classList.remove('show'), 2000);
}

// ============================================================
// GOALS
// ============================================================
function checkGoal() {
  const goals = ['goal1','goal2','goal3','goal4'];
  const done = goals.every(id => document.getElementById(id)?.checked);
  if (done) {
    document.getElementById('daily-goals').style.display = 'none';
    document.getElementById('goal-congrats').style.display = 'block';
    showNotif('üéâ ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ!', 'green');
  }
}

// ============================================================
// INIT
// ============================================================
window.onload = () => {
  buildKanaGrid('hira');
  buildKanaGrid('kata');
  buildComboGrid();
  buildGrammar();
  buildParticles();
  buildVocab();
  buildKanji();
  buildTools();
  
  // Daily tip
  const tipEl = document.getElementById('daily-tip');
  if (tipEl) tipEl.innerHTML = TIPS[new Date().getDay() % TIPS.length];
  
  updateStats();
  initKanaQuiz('hira');
  initKanaQuiz('kata');
  initSRS();
  
  // Lazy update flashcard display
  updateFC('hira');
  updateFC('kata');
  buildHiScores();
};


// ============================================================
// KANA GAMES ENGINE
// ============================================================
let kgKanaType = 'hira';
let kgGameInterval = null;

function getKanaPool() {
  if (kgKanaType==='hira') return [...HIRAGANA];
  if (kgKanaType==='kata') return [...KATAKANA];
  return [...HIRAGANA,...KATAKANA];
}

function setKanaType(t) {
  kgKanaType=t;
  ['hira','kata','both'].forEach(x=>{
    const b=document.getElementById('kg-btn-'+x);
    if(b) b.className=x===t?'btn btn-primary':'btn btn-outline';
  });
}

function launchGame(id) {
  clearKGTimers();
  document.getElementById('kg-lobby').style.display='none';
  document.getElementById('kg-arena').style.display='block';
  const titles={speedblitz:'‚ö° Speed Blitz',survival:'‚ù§Ô∏è Survival Mode',kanarain:'üåßÔ∏è Kana Rain',memory:'üß© Memory Match',typeit:'‚å®Ô∏è Type It!',reverse:'üîÑ Reverse Quiz',boss:'üëπ Boss Battle'};
  document.getElementById('kg-arena-title').textContent=titles[id]||id;
  ({speedblitz:startSB,survival:startSV,kanarain:startKR,memory:startMM,typeit:startTI,reverse:startRV,boss:startBB})[id]?.();
}

function exitGame() {
  clearKGTimers();
  document.getElementById('kg-lobby').style.display='block';
  document.getElementById('kg-arena').style.display='none';
  document.getElementById('kg-hud').innerHTML='';
  document.getElementById('kg-game-content').innerHTML='';
  buildHiScores();
}

function clearKGTimers() {
  if(kgGameInterval){clearInterval(kgGameInterval);kgGameInterval=null;}
}

function kgSaveHS(game,score) {
  const s=JSON.parse(localStorage.getItem('kg_hs')||'{}');
  const k=game+'_'+kgKanaType;
  if(!s[k]||score>s[k]) s[k]=score;
  localStorage.setItem('kg_hs',JSON.stringify(s));
}
function kgGetHS(game) {
  const s=JSON.parse(localStorage.getItem('kg_hs')||'{}');
  return Math.max(s[game+'_hira']||0,s[game+'_kata']||0,s[game+'_both']||0);
}

function buildHiScores() {
  const el=document.getElementById('kg-hiscores');
  if(!el) return;
  const games=[{id:'speedblitz',n:'Speed Blitz',i:'‚ö°'},{id:'survival',n:'Survival',i:'‚ù§Ô∏è'},{id:'kanarain',n:'Kana Rain',i:'üåßÔ∏è'},{id:'memory',n:'Memory',i:'üß©'},{id:'typeit',n:'Type It',i:'‚å®Ô∏è'},{id:'reverse',n:'Reverse',i:'üîÑ'},{id:'boss',n:'Boss Battle',i:'üëπ'}];
  el.innerHTML=games.map(g=>`<div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:12px;text-align:center"><div style="font-size:20px">${g.i}</div><div style="font-size:11px;font-weight:600;color:var(--white);margin-top:4px">${g.n}</div><div style="font-size:22px;color:var(--gold);font-family:'Noto Serif JP';font-weight:700">${kgGetHS(g.id)||'‚Äî'}</div></div>`).join('');
}

function kgShuffle(a){return [...a].sort(()=>Math.random()-0.5);}

function kg4Opts(pool,correct,field) {
  const opts=[correct[field]];
  const others=kgShuffle(pool.filter(k=>k[field]!==correct[field]));
  for(let i=0;opts.length<4&&i<others.length;i++) if(!opts.includes(others[i][field])) opts.push(others[i][field]);
  return kgShuffle(opts);
}

function kgGameOver(id,score,extra) {
  clearKGTimers();
  const hs=kgGetHS(id),isNew=score>=hs&&score>0;
  document.getElementById('kg-game-content').innerHTML=`
    <div style="text-align:center;max-width:380px;margin:0 auto;padding:20px">
      <div style="font-size:64px">${isNew?'üèÜ':'üéÆ'}</div>
      <div style="font-size:${isNew?'16':'13'}px;color:${isNew?'var(--gold2)':'var(--text2)'};font-weight:700;letter-spacing:2px;margin:12px 0">${isNew?'üéâ NEW HIGH SCORE!':'GAME OVER'}</div>
      <div style="font-family:'Noto Serif JP';font-size:80px;color:${isNew?'var(--gold)':'white'};font-weight:900;line-height:1">${score}</div>
      ${extra?`<div style="font-size:13px;color:var(--text2);margin-top:8px">${extra}</div>`:''}
      <div style="font-size:11px;color:var(--text3);margin-top:4px">Best: ${hs}</div>
      <div style="display:flex;gap:12px;justify-content:center;margin-top:24px">
        <button class="btn btn-primary" onclick="launchGame('${id}')">üîÑ ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn btn-outline" onclick="exitGame()">‚Üê ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏°‡∏™‡πå</button>
      </div>
    </div>`;
  document.getElementById('kg-hud').innerHTML='';
}

function kgOptBtn(text,onClick,jpStyle=false) {
  const b=document.createElement('button');
  b.style.cssText=`padding:${jpStyle?'12px 6px':'14px'};background:var(--surface2);border:2px solid var(--border);border-radius:12px;color:white;font-size:${jpStyle?'28px':'17px'};cursor:pointer;transition:all 0.15s;font-family:${jpStyle?'"Noto Serif JP"':'"Sarabun"'}`;
  b.textContent=text;
  b.onmouseover=()=>{if(!b.dataset.done)b.style.borderColor='var(--gold)';};
  b.onmouseout=()=>{if(!b.dataset.done)b.style.borderColor='var(--border)';};
  b.onclick=onClick;
  return b;
}

// ============================================================
// GAME 1: SPEED BLITZ
// ============================================================
let sb={};
function startSB() {
  sb={pool:kgShuffle(getKanaPool()),idx:0,score:0,combo:0,maxCombo:0,tLeft:30,fever:false,fTime:0,ans:false};
  document.getElementById('kg-hud').innerHTML=`
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">TIME</div><div style="font-size:26px;color:var(--gold);font-weight:900;font-family:'Noto Serif JP'" id="sb-t">30</div></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">SCORE</div><div style="font-size:26px;color:var(--red2);font-weight:900;font-family:'Noto Serif JP'" id="sb-s">0</div></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">COMBO</div><div style="font-size:26px;color:var(--teal2);font-weight:900;font-family:'Noto Serif JP'" id="sb-c">x1</div></div>`;
  document.getElementById('kg-game-content').innerHTML=`
    <div style="max-width:480px;margin:0 auto">
      <div id="sb-fever" style="display:none;text-align:center;padding:8px;background:linear-gradient(90deg,var(--gold),var(--red2),var(--gold));border-radius:8px;margin-bottom:12px;font-weight:700;font-size:14px">üî• FEVER TIME! √ó3 POINTS! üî•</div>
      <div style="height:8px;background:var(--surface2);border-radius:4px;margin-bottom:16px;overflow:hidden"><div id="sb-pb" style="height:100%;width:100%;background:linear-gradient(90deg,var(--teal),var(--gold));transition:width 0.1s;border-radius:4px"></div></div>
      <div style="text-align:center;margin-bottom:16px">
        <div id="sb-char" style="font-family:'Noto Serif JP';font-size:96px;color:white;line-height:1;text-shadow:0 0 40px rgba(231,76,60,0.4)">?</div>
        <div id="sb-ca" style="height:22px;font-size:15px;font-weight:700;color:var(--gold)"></div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;max-width:420px;margin:0 auto" id="sb-opts"></div>
      <div id="sb-rf" style="text-align:center;height:28px;font-size:18px;font-weight:700;margin-top:10px"></div>
    </div>`;
  renderSBQ();
  kgGameInterval=setInterval(()=>{
    sb.tLeft-=0.1;
    const t=document.getElementById('sb-t'),pb=document.getElementById('sb-pb');
    if(t){t.textContent=Math.ceil(sb.tLeft);if(sb.tLeft<=10)t.style.color='var(--red2)';}
    if(pb) pb.style.width=(sb.tLeft/30*100)+'%';
    if(sb.fever){sb.fTime-=0.1;if(sb.fTime<=0){sb.fever=false;const f=document.getElementById('sb-fever');if(f)f.style.display='none';}}
    if(sb.tLeft<=0){kgSaveHS('speedblitz',sb.score);kgGameOver('speedblitz',sb.score,'Combo ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: '+sb.maxCombo);}
  },100);
}

function renderSBQ() {
  if(!document.getElementById('sb-opts'))return;
  sb.ans=false;
  const curr=sb.pool[sb.idx%sb.pool.length]; sb.idx++; sb.curr=curr;
  const el=document.getElementById('sb-char');
  if(el){el.textContent=curr.jp;el.style.animation='kgPop 0.2s';setTimeout(()=>{if(el)el.style.animation='';},200);}
  const opts=kg4Opts(getKanaPool(),curr,'ro');
  const c=document.getElementById('sb-opts'); if(!c)return; c.innerHTML='';
  opts.forEach(o=>{
    const b=kgOptBtn(o,()=>checkSB(o,curr.ro,b,c));
    c.appendChild(b);
  });
}

function checkSB(chosen,correct,btn,container) {
  if(sb.ans)return; sb.ans=true;
  container.querySelectorAll('button').forEach(b=>{b.onclick=null;if(b.textContent===correct){b.style.borderColor='var(--teal2)';b.style.background='rgba(26,188,156,0.2)';}});
  const rf=document.getElementById('sb-rf');
  if(chosen===correct){
    sb.combo++;if(sb.combo>sb.maxCombo)sb.maxCombo=sb.combo;
    const m=sb.fever?3:sb.combo>=5?2:1,pts=10*m; sb.score+=pts;
    if(sb.combo===5&&!sb.fever){sb.fever=true;sb.fTime=8;const f=document.getElementById('sb-fever');if(f)f.style.display='block';}
    btn.style.borderColor='var(--teal2)';btn.style.background='rgba(26,188,156,0.2)';
    if(rf){rf.textContent='+'+pts+(m>1?' √ó'+m:'');rf.style.color='var(--teal2)';}
    if(sb.combo>=3){const ca=document.getElementById('sb-ca');if(ca){ca.textContent=sb.combo>=10?'üî• '+sb.combo+' COMBO!!':sb.combo>=5?'‚ö° '+sb.combo+' COMBO!':'';ca.style.animation='kgFloat 0.8s forwards';setTimeout(()=>{if(ca){ca.style.animation='';ca.textContent='';}},800);}}
  }else{
    sb.combo=0;btn.style.borderColor='var(--red2)';btn.style.background='rgba(231,76,60,0.15)';
    if(rf){rf.textContent='‚úó '+correct;rf.style.color='var(--red2)';}
  }
  const ss=document.getElementById('sb-s'),sc=document.getElementById('sb-c');
  if(ss)ss.textContent=sb.score;if(sc)sc.textContent='x'+(sb.combo||1);
  setTimeout(()=>{if(rf)rf.textContent='';renderSBQ();},380);
}

// ============================================================
// GAME 2: SURVIVAL
// ============================================================
let sv={};
function startSV() {
  sv={pool:kgShuffle(getKanaPool()),idx:0,score:0,lives:3,streak:0,ans:false};
  document.getElementById('kg-hud').innerHTML=`
    <div id="sv-lv" style="display:flex;gap:6px"></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">SCORE</div><div style="font-size:26px;color:var(--gold);font-weight:900;font-family:'Noto Serif JP'" id="sv-s">0</div></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">STREAK</div><div style="font-size:26px;color:var(--teal2);font-weight:900;font-family:'Noto Serif JP'" id="sv-st">0</div></div>`;
  svUpdateLives();
  document.getElementById('kg-game-content').innerHTML=`
    <div style="text-align:center;max-width:480px;margin:0 auto">
      <div id="sv-char" style="font-family:'Noto Serif JP';font-size:110px;color:white;line-height:1;margin-bottom:20px;text-shadow:0 0 40px rgba(192,57,43,0.4)">?</div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px" id="sv-opts"></div>
      <div id="sv-f" style="height:28px;font-size:16px;font-weight:700;margin-top:12px"></div>
    </div>`;
  renderSVQ();
}

function renderSVQ() {
  if(!document.getElementById('sv-opts'))return;
  sv.ans=false;
  const curr=sv.pool[sv.idx%sv.pool.length];sv.idx++;sv.curr=curr;
  document.getElementById('sv-char').textContent=curr.jp;
  const opts=kg4Opts(getKanaPool(),curr,'ro');
  const c=document.getElementById('sv-opts');c.innerHTML='';
  opts.forEach(o=>{c.appendChild(kgOptBtn(o,()=>checkSV(o,curr.ro,c.querySelector('[data-opt="'+o+'"]'),c)));});
  c.querySelectorAll('button').forEach((b,i)=>{b.dataset.opt=opts[i];});
}

function checkSV(chosen,correct,btn,container) {
  if(sv.ans)return;sv.ans=true;
  const allBtns=container.querySelectorAll('button');
  allBtns.forEach(b=>{b.onclick=null;if(b.textContent===correct){b.style.borderColor='var(--teal2)';b.style.background='rgba(26,188,156,0.15)';}});
  const f=document.getElementById('sv-f');
  if(chosen===correct){
    sv.streak++;sv.score+=10+Math.floor(sv.streak/5)*5;
    allBtns.forEach(b=>{if(b.textContent===chosen){b.style.borderColor='var(--teal2)';b.style.background='rgba(26,188,156,0.15)';}});
    if(f){f.textContent='‚úì ‡∏ñ‡∏π‡∏Å!';f.style.color='var(--teal2)';}
  }else{
    sv.lives--;sv.streak=0;
    allBtns.forEach(b=>{if(b.textContent===chosen){b.style.borderColor='var(--red2)';b.style.background='rgba(231,76,60,0.15)';}});
    if(f){f.textContent='‚úó '+correct;f.style.color='var(--red2)';}
    svUpdateLives();
    if(sv.lives<=0){setTimeout(()=>{kgSaveHS('survival',sv.score);kgGameOver('survival',sv.score,'‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å '+(sv.score/10|0)+' ‡∏Ç‡πâ‡∏≠');},600);return;}
  }
  const ss=document.getElementById('sv-s'),sst=document.getElementById('sv-st');
  if(ss)ss.textContent=sv.score;if(sst)sst.textContent=sv.streak;
  setTimeout(()=>{if(f)f.textContent='';renderSVQ();},460);
}

function svUpdateLives(){
  const el=document.getElementById('sv-lv');
  if(el)el.innerHTML=[1,2,3].map(i=>'<span style="font-size:22px">'+(i<=sv.lives?'‚ù§Ô∏è':'üñ§')+'</span>').join('');
}

// ============================================================
// GAME 3: KANA RAIN
// ============================================================
let kr={};
function startKR() {
  kr={pool:getKanaPool(),score:0,lives:5,level:1,drops:[],spawnMs:3200,ans:false};
  document.getElementById('kg-hud').innerHTML=`
    <div id="kr-lv" style="display:flex;gap:3px"></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">SCORE</div><div style="font-size:26px;color:var(--gold);font-weight:900;font-family:'Noto Serif JP'" id="kr-s">0</div></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">LEVEL</div><div style="font-size:26px;color:var(--teal2);font-weight:900;font-family:'Noto Serif JP'" id="kr-lev">1</div></div>`;
  krUpdateLives();
  document.getElementById('kg-game-content').innerHTML=`
    <div style="max-width:580px;margin:0 auto">
      <div id="kr-arena" style="height:300px;background:var(--bg3);border:1px solid var(--border);border-radius:12px;position:relative;overflow:hidden;margin-bottom:12px">
        <div id="kr-drops"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:3px;background:rgba(231,76,60,0.6)"></div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px" id="kr-btns"></div>
      <div id="kr-fb" style="text-align:center;height:24px;margin-top:8px;font-size:14px;font-weight:700"></div>
    </div>`;
  krSpawn();
  kgGameInterval=setInterval(krSpawn,kr.spawnMs);
}

function krSpawn() {
  const dropsEl=document.getElementById('kr-drops');
  if(!dropsEl)return;
  const pool=getKanaPool();
  const kana=pool[Math.floor(Math.random()*pool.length)];
  const opts=kg4Opts(pool,kana,'ro');
  const left=10+Math.random()*70;
  const dur=Math.max(1600,3500-kr.level*300);

  const d=document.createElement('div');
  d.style.cssText=`position:absolute;left:${left}%;top:-60px;transform:translateX(-50%);text-align:center;transition:top ${dur}ms linear`;
  d.innerHTML=`<div style="font-family:'Noto Serif JP';font-size:32px;color:white;background:rgba(8,8,16,0.85);border:2px solid var(--red2);border-radius:50%;width:60px;height:60px;display:flex;align-items:center;justify-content:center;text-shadow:0 0 10px var(--red2)">${kana.jp}</div>`;
  dropsEl.appendChild(d);

  const dropObj={el:d,kana,opts,landed:false};
  kr.drops.push(dropObj);
  renderKRBtns(kana,opts,dropObj);

  requestAnimationFrame(()=>{d.style.top='270px';});

  setTimeout(()=>{
    if(!dropObj.landed){
      dropObj.landed=true; d.remove();
      kr.drops=kr.drops.filter(x=>x!==dropObj);
      kr.lives--;krUpdateLives();
      krShake();
      if(kr.lives<=0){clearKGTimers();kgSaveHS('kanarain',kr.score);kgGameOver('kanarain',kr.score,'‡∏ñ‡∏∂‡∏á Level '+kr.level);}
      else{const f=document.getElementById('kr-fb');if(f){f.innerHTML='<span style="color:var(--red2)">‡∏ä‡πâ‡∏≤‡πÑ‡∏õ!</span>';setTimeout(()=>{if(f)f.textContent='';},500);}}
    }
  },dur+100);
}

function renderKRBtns(kana,opts,dropObj) {
  const c=document.getElementById('kr-btns');if(!c)return;
  c.innerHTML='';
  opts.forEach(o=>{
    const b=document.createElement('button');
    b.style.cssText='padding:12px 6px;background:var(--surface2);border:2px solid var(--border);border-radius:10px;color:var(--text);font-size:15px;cursor:pointer;transition:all 0.15s;font-family:"Sarabun"';
    b.textContent=o;
    b.onmouseover=()=>b.style.borderColor='var(--gold)';
    b.onmouseout=()=>b.style.borderColor='var(--border)';
    b.onclick=()=>{
      if(dropObj.landed)return;
      if(o===kana.ro){
        dropObj.landed=true;dropObj.el.style.opacity='0';setTimeout(()=>dropObj.el.remove(),200);
        kr.drops=kr.drops.filter(x=>x!==dropObj);
        kr.score+=10+kr.level*2;
        const ss=document.getElementById('kr-s');if(ss)ss.textContent=kr.score;
        const f=document.getElementById('kr-fb');if(f){f.innerHTML='<span style="color:var(--teal2)">‚úì</span>';setTimeout(()=>{if(f)f.textContent='';},300);}
        if(kr.score>=kr.level*120){
          kr.level++;clearKGTimers();
          const lev=document.getElementById('kr-lev');if(lev)lev.textContent=kr.level;
          kgGameInterval=setInterval(krSpawn,Math.max(700,kr.spawnMs-kr.level*250));
          krLevelUp(kr.level);
        }
        const next=kr.drops[kr.drops.length-1];
        if(next) renderKRBtns(next.kana,next.opts,next);
        else c.innerHTML='';
      }else{
        b.style.borderColor='var(--red2)';b.style.background='rgba(231,76,60,0.15)';
        setTimeout(()=>{b.style.borderColor='var(--border)';b.style.background='var(--surface2)';},300);
      }
    };
    c.appendChild(b);
  });
}

function krUpdateLives(){const el=document.getElementById('kr-lv');if(el)el.innerHTML=[1,2,3,4,5].map(i=>'<span style="font-size:14px">'+(i<=kr.lives?'üíô':'üñ§')+'</span>').join('');}
function krShake(){const a=document.getElementById('kr-arena');if(a){a.style.animation='kgShake 0.3s';setTimeout(()=>a.style.animation='',300);}}
function krLevelUp(l){
  const a=document.getElementById('kr-arena');if(!a)return;
  const d=document.createElement('div');
  d.style.cssText='position:absolute;inset:0;background:rgba(212,160,23,0.15);display:flex;align-items:center;justify-content:center;z-index:5;border-radius:12px;animation:kgPop 0.3s';
  d.innerHTML=`<div style="text-align:center"><div style="font-size:36px">üéâ</div><div style="font-size:24px;font-weight:700;color:var(--gold)">LEVEL ${l}!</div></div>`;
  a.appendChild(d);setTimeout(()=>d.remove(),1100);
}

// ============================================================
// GAME 4: MEMORY MATCH
// ============================================================
let mm={};
function startMM() {
  const pool=kgShuffle(getKanaPool()).slice(0,8);
  const cards=kgShuffle([
    ...pool.map(k=>({id:'j'+k.jp,val:k.jp,match:k.ro,isJP:true})),
    ...pool.map(k=>({id:'r'+k.ro,val:k.ro,match:k.jp,isJP:false}))
  ]);
  mm={cards,flipped:[],matched:[],moves:0,t0:Date.now()};
  document.getElementById('kg-hud').innerHTML=`
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">MOVES</div><div style="font-size:26px;color:var(--gold);font-weight:900;font-family:'Noto Serif JP'" id="mm-m">0</div></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">PAIRS</div><div style="font-size:26px;color:var(--teal2);font-weight:900;font-family:'Noto Serif JP'" id="mm-p">0/8</div></div>`;
  document.getElementById('kg-game-content').innerHTML=`
    <div id="mm-grid" style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;max-width:500px;margin:0 auto"></div>
    <div id="mm-st" style="text-align:center;margin-top:12px;font-size:13px;color:var(--text2)">‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏≤‡∏Ñ‡∏π‡πà Kana ‚Üî Romaji</div>`;
  const css='style="--mh:80px"';
  renderMM();
}

function renderMM() {
  const g=document.getElementById('mm-grid');if(!g)return;
  g.innerHTML='';
  mm.cards.forEach((c,i)=>{
    const isMatched=mm.matched.includes(c.id);
    const div=document.createElement('div');
    div.style.cssText='height:78px;perspective:600px;cursor:pointer';
    div.innerHTML=`
      <div style="width:100%;height:100%;transform-style:preserve-3d;transition:transform 0.4s;${(isMatched||mm.flipped.includes(i))?'transform:rotateY(180deg)':''}">
        <div style="position:absolute;width:100%;height:100%;backface-visibility:hidden;background:var(--surface2);border:2px solid ${isMatched?'var(--teal)':'var(--border)'};border-radius:10px;display:flex;align-items:center;justify-content:center">
          <span style="font-size:20px;color:var(--text3)">?</span>
        </div>
        <div style="position:absolute;width:100%;height:100%;backface-visibility:hidden;transform:rotateY(180deg);background:${c.isJP?'linear-gradient(135deg,var(--surface),var(--surface2))':'linear-gradient(135deg,#1a0a2e,#2a1055)'};border:2px solid ${isMatched?'var(--teal2)':'var(--border)'};border-radius:10px;display:flex;align-items:center;justify-content:center">
          <span style="font-family:${c.isJP?'"Noto Serif JP"':'"Sarabun"'};font-size:${c.isJP?'26px':'16px'};color:white;font-weight:${c.isJP?'900':'400'};text-align:center;padding:4px">${c.val}</span>
        </div>
      </div>`;
    if(!isMatched) div.onclick=()=>flipMM(i);
    g.appendChild(div);
  });
}

function flipMM(i) {
  if(mm.flipped.length===2||mm.flipped.includes(i))return;
  mm.flipped.push(i);renderMM();
  if(mm.flipped.length===2){
    mm.moves++;const m=document.getElementById('mm-m');if(m)m.textContent=mm.moves;
    const [a,b]=mm.flipped;
    const ca=mm.cards[a],cb=mm.cards[b];
    const ok=(ca.val===cb.match||cb.val===ca.match);
    setTimeout(()=>{
      if(ok){
        mm.matched.push(ca.id,cb.id);
        const p=document.getElementById('mm-p');if(p)p.textContent=(mm.matched.length/2)+'/8';
        const s=document.getElementById('mm-st');if(s){s.innerHTML='<span style="color:var(--teal2)">‚úì ‡∏Ñ‡∏π‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!</span>';setTimeout(()=>{if(s)s.textContent='‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏≤‡∏Ñ‡∏π‡πà Kana ‚Üî Romaji';},600);}
        if(mm.matched.length===16){
          const t=Math.round((Date.now()-mm.t0)/1000);
          const sc=Math.max(0,1000-mm.moves*20-t*4);
          kgSaveHS('memory',sc);setTimeout(()=>kgGameOver('memory',sc,mm.moves+' moves, '+t+' ‡∏ß‡∏¥'),400);return;
        }
      }else{
        const s=document.getElementById('mm-st');if(s){s.innerHTML='<span style="color:var(--red2)">‚úó ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ô</span>';setTimeout(()=>{if(s)s.textContent='‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏≤‡∏Ñ‡∏π‡πà Kana ‚Üî Romaji';},600);}
      }
      mm.flipped=[];renderMM();
    },ok?350:800);
  }
}

// ============================================================
// GAME 5: TYPE IT
// ============================================================
let ti={};
function startTI() {
  ti={pool:kgShuffle(getKanaPool()),idx:0,score:0,ok:0,total:0,streak:0,tLeft:60,ans:false};
  document.getElementById('kg-hud').innerHTML=`
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">TIME</div><div style="font-size:26px;color:var(--gold);font-weight:900;font-family:'Noto Serif JP'" id="ti-t">60</div></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">SCORE</div><div style="font-size:26px;color:var(--red2);font-weight:900;font-family:'Noto Serif JP'" id="ti-s">0</div></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">ACC</div><div style="font-size:26px;color:var(--teal2);font-weight:900;font-family:'Noto Serif JP'" id="ti-acc">‚Äî</div></div>`;
  document.getElementById('kg-game-content').innerHTML=`
    <div style="text-align:center;max-width:440px;margin:0 auto">
      <div style="height:8px;background:var(--surface2);border-radius:4px;margin-bottom:20px;overflow:hidden"><div id="ti-pb" style="height:100%;width:100%;background:linear-gradient(90deg,var(--teal),var(--gold));transition:width 0.1s;border-radius:4px"></div></div>
      <div id="ti-char" style="font-family:'Noto Serif JP';font-size:108px;color:white;line-height:1;margin-bottom:6px;text-shadow:0 0 40px rgba(52,152,219,0.5)">?</div>
      <div style="font-size:12px;color:var(--text3);margin-bottom:16px">‡∏û‡∏¥‡∏°‡∏û‡πå romaji ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Enter (‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</div>
      <input id="ti-inp" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
        style="width:100%;max-width:280px;padding:14px 20px;background:var(--surface2);border:2px solid var(--border);border-radius:12px;color:white;font-size:22px;text-align:center;font-family:'Sarabun';outline:none;letter-spacing:2px;display:block;margin:0 auto"
        placeholder="romaji..."
        oninput="tiCheck(this)"
        onkeydown="if(event.key==='Enter')tiSubmit()">
      <div id="ti-fb" style="height:28px;margin-top:10px;font-size:16px;font-weight:700"></div>
      <div style="margin-top:10px;display:flex;gap:6px;justify-content:center;flex-wrap:wrap" id="ti-rec"></div>
    </div>`;
  renderTIQ();
  setTimeout(()=>document.getElementById('ti-inp')?.focus(),80);
  kgGameInterval=setInterval(()=>{
    ti.tLeft-=0.1;
    const t=document.getElementById('ti-t'),pb=document.getElementById('ti-pb');
    if(t){t.textContent=Math.ceil(ti.tLeft);if(ti.tLeft<=10)t.style.color='var(--red2)';}
    if(pb)pb.style.width=(ti.tLeft/60*100)+'%';
    if(ti.tLeft<=0){kgSaveHS('typeit',ti.score);kgGameOver('typeit',ti.score,'‡∏ñ‡∏π‡∏Å '+ti.ok+'/'+ti.total+' ('+(ti.total?Math.round(ti.ok/ti.total*100):0)+'%)');}
  },100);
}

function renderTIQ() {
  if(!document.getElementById('ti-char'))return;
  ti.ans=false;
  const c=ti.pool[ti.idx%ti.pool.length];ti.idx++;ti.curr=c;
  const ch=document.getElementById('ti-char');if(ch)ch.textContent=c.jp;
  const inp=document.getElementById('ti-inp');if(inp){inp.value='';inp.style.borderColor='var(--border)';inp.style.background='var(--surface2)';inp.focus();}
  const fb=document.getElementById('ti-fb');if(fb)fb.textContent='';
}

function tiCheck(inp) {
  if(inp.value.toLowerCase()===ti.curr?.ro) tiSubmit();
}

function tiSubmit() {
  if(ti.ans)return;
  const inp=document.getElementById('ti-inp');if(!inp)return;
  const v=inp.value.toLowerCase().trim(),correct=ti.curr?.ro;
  ti.ans=true;ti.total++;
  const fb=document.getElementById('ti-fb');
  if(v===correct){
    ti.ok++;ti.streak++;ti.score+=15+Math.min(ti.streak*3,30);
    inp.style.borderColor='var(--teal2)';inp.style.background='rgba(26,188,156,0.1)';
    if(fb){fb.textContent='‚úì';fb.style.color='var(--teal2)';}
    tiAddRec(correct,true);
  }else{
    ti.streak=0;inp.style.borderColor='var(--red2)';inp.style.background='rgba(231,76,60,0.1)';
    if(fb){fb.textContent='‚úó '+correct;fb.style.color='var(--red2)';}
    tiAddRec(correct,false);
  }
  const ss=document.getElementById('ti-s'),acc=document.getElementById('ti-acc');
  if(ss)ss.textContent=ti.score;if(acc)acc.textContent=Math.round(ti.ok/ti.total*100)+'%';
  setTimeout(()=>renderTIQ(),280);
}

function tiAddRec(ro,ok){
  const el=document.getElementById('ti-rec');if(!el)return;
  const s=document.createElement('span');
  s.style.cssText='font-size:11px;padding:2px 7px;border-radius:10px;'+(ok?'background:rgba(26,188,156,0.2);color:var(--teal2);border:1px solid var(--teal)':'background:rgba(231,76,60,0.2);color:var(--red2);border:1px solid var(--red)');
  s.textContent=(ok?'‚úì ':'‚úó ')+ro;
  el.insertBefore(s,el.firstChild);
  if(el.children.length>8)el.removeChild(el.lastChild);
}

// ============================================================
// GAME 6: REVERSE QUIZ
// ============================================================
let rv={};
function startRV() {
  rv={pool:kgShuffle(getKanaPool()),idx:0,score:0,lives:5,ans:false};
  document.getElementById('kg-hud').innerHTML=`
    <div id="rv-lv" style="display:flex;gap:3px"></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">SCORE</div><div style="font-size:26px;color:var(--gold);font-weight:900;font-family:'Noto Serif JP'" id="rv-s">0</div></div>`;
  rvUpdateLives();
  document.getElementById('kg-game-content').innerHTML=`
    <div style="text-align:center;max-width:480px;margin:0 auto">
      <div style="font-size:11px;color:var(--text2);letter-spacing:2px;margin-bottom:10px">ROMAJI ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å KANA ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</div>
      <div id="rv-ro" style="font-size:52px;font-weight:900;color:var(--gold);font-family:'Noto Serif JP';margin-bottom:24px;text-shadow:0 0 24px rgba(212,160,23,0.4)">?</div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;max-width:400px;margin:0 auto" id="rv-opts"></div>
      <div id="rv-f" style="height:28px;margin-top:14px;font-size:16px;font-weight:700"></div>
    </div>`;
  renderRVQ();
}

function renderRVQ() {
  if(!document.getElementById('rv-opts'))return;
  rv.ans=false;
  const c=rv.pool[rv.idx%rv.pool.length];rv.idx++;rv.curr=c;
  document.getElementById('rv-ro').textContent=c.ro;
  const opts=kg4Opts(getKanaPool(),c,'jp');
  const cont=document.getElementById('rv-opts');cont.innerHTML='';
  opts.forEach(o=>cont.appendChild(kgOptBtn(o,()=>checkRV(o,c.jp,cont),true)));
}

function checkRV(chosen,correct,container) {
  if(rv.ans)return;rv.ans=true;
  container.querySelectorAll('button').forEach(b=>{b.onclick=null;if(b.textContent===correct){b.style.borderColor='var(--teal2)';b.style.background='rgba(26,188,156,0.15)';}});
  const f=document.getElementById('rv-f');
  if(chosen===correct){
    rv.score+=15;
    container.querySelectorAll('button').forEach(b=>{if(b.textContent===chosen){b.style.borderColor='var(--teal2)';b.style.background='rgba(26,188,156,0.15)';}});
    if(f){f.textContent='‚úì ‡∏ñ‡∏π‡∏Å!';f.style.color='var(--teal2)';}
  }else{
    rv.lives--;
    container.querySelectorAll('button').forEach(b=>{if(b.textContent===chosen){b.style.borderColor='var(--red2)';b.style.background='rgba(231,76,60,0.15)';}});
    if(f){f.textContent='‚úó ‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏≠: '+correct;f.style.color='var(--red2)';}
    rvUpdateLives();
    if(rv.lives<=0){setTimeout(()=>{kgSaveHS('reverse',rv.score);kgGameOver('reverse',rv.score,'');},600);return;}
  }
  const ss=document.getElementById('rv-s');if(ss)ss.textContent=rv.score;
  setTimeout(()=>{if(f)f.textContent='';renderRVQ();},460);
}

function rvUpdateLives(){const el=document.getElementById('rv-lv');if(el)el.innerHTML=[1,2,3,4,5].map(i=>'<span style="font-size:15px">'+(i<=rv.lives?'üíö':'üñ§')+'</span>').join('');}

// ============================================================
// GAME 7: BOSS BATTLE
// ============================================================
let bb={};
const BB_BOSSES=[
  {name:'„Çπ„É©„Ç§„É† Slime',e:'üü¢',hp:80,atk:4},
  {name:'„Ç¥„Éñ„É™„É≥ Goblin',e:'üë∫',hp:160,atk:7},
  {name:'„Éâ„É©„Ç¥„É≥ Dragon',e:'üêâ',hp:280,atk:11},
  {name:'È≠îÁéã Demon King',e:'üëπ',hp:420,atk:15}
];

function startBB() {
  bb={pool:kgShuffle(getKanaPool()),idx:0,score:0,bIdx:0,boss:BB_BOSSES[0],bHp:BB_BOSSES[0].hp,pHp:100,combo:0,ans:false,tRef:0};
  document.getElementById('kg-hud').innerHTML=`
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">SCORE</div><div style="font-size:22px;color:var(--gold);font-weight:900;font-family:'Noto Serif JP'" id="bb-s">0</div></div>
    <div style="text-align:center"><div style="font-size:10px;color:var(--text2)">BOSS</div><div style="font-size:22px;font-weight:900" id="bb-be">üü¢</div></div>`;
  document.getElementById('kg-game-content').innerHTML=`
    <div style="max-width:520px;margin:0 auto">
      <div style="background:var(--bg3);border:1px solid var(--border);border-radius:16px;padding:16px;text-align:center;margin-bottom:12px">
        <div style="font-family:'Noto Serif JP';font-size:13px;color:var(--red2);margin-bottom:2px" id="bb-bn">„Çπ„É©„Ç§„É† Slime</div>
        <div id="bb-be2" style="font-size:56px;display:inline-block;transition:all 0.2s">üü¢</div>
        <div style="margin-top:8px"><div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text2);margin-bottom:3px"><span>BOSS HP</span><span id="bb-bht">80/80</span></div>
        <div style="height:10px;background:var(--surface2);border-radius:5px;overflow:hidden"><div id="bb-bhb" style="height:100%;width:100%;background:linear-gradient(90deg,var(--red2),var(--red));border-radius:5px;transition:width 0.3s"></div></div></div>
        <div id="bb-df" style="height:24px;font-size:18px;font-weight:700;color:var(--red2)"></div>
      </div>
      <div style="background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:10px;margin-bottom:12px">
        <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text2);margin-bottom:3px"><span>üë§ Player HP</span><span id="bb-pht">100/100</span></div>
        <div style="height:7px;background:var(--surface2);border-radius:4px;overflow:hidden"><div id="bb-phb" style="height:100%;width:100%;background:linear-gradient(90deg,var(--teal),var(--teal2));border-radius:4px;transition:width 0.3s"></div></div>
      </div>
      <div style="text-align:center;margin-bottom:12px">
        <div style="font-size:11px;color:var(--text2);margin-bottom:6px">‚öîÔ∏è ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏à‡∏°‡∏ï‡∏µ Boss! ‡πÄ‡∏£‡πá‡∏ß = CRITICAL!</div>
        <div id="bb-char" style="font-family:'Noto Serif JP';font-size:80px;color:white;line-height:1;text-shadow:0 0 30px rgba(192,57,43,0.5)">?</div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px" id="bb-opts"></div>
      <div id="bb-f" style="height:24px;text-align:center;margin-top:8px;font-size:14px;font-weight:700"></div>
    </div>`;
  renderBBQ();
}

function renderBBQ() {
  if(!document.getElementById('bb-opts'))return;
  bb.ans=false;bb.tRef=Date.now();
  const c=bb.pool[bb.idx%bb.pool.length];bb.idx++;bb.curr=c;
  document.getElementById('bb-char').textContent=c.jp;
  const opts=kg4Opts(getKanaPool(),c,'ro');
  const cont=document.getElementById('bb-opts');cont.innerHTML='';
  opts.forEach(o=>{
    const b=kgOptBtn(o,()=>checkBB(o,c.ro,b,cont));
    b.onmouseover=()=>{if(!b.dataset.done)b.style.borderColor='var(--red2)';};
    cont.appendChild(b);
  });
}

function checkBB(chosen,correct,btn,container) {
  if(bb.ans)return;bb.ans=true;
  const tb=Math.max(0,2800-(Date.now()-bb.tRef));
  container.querySelectorAll('button').forEach(b=>{b.onclick=null;if(b.textContent===correct){b.style.borderColor='var(--teal2)';b.style.background='rgba(26,188,156,0.15)';}});
  const f=document.getElementById('bb-f');
  if(chosen===correct){
    bb.combo++;
    const crit=tb>2000||bb.combo>=3;
    const dmg=crit?Math.floor(Math.random()*15)+18:Math.floor(Math.random()*8)+8;
    bb.bHp=Math.max(0,bb.bHp-dmg);bb.score+=dmg*2;
    btn.style.borderColor='var(--teal2)';btn.style.background='rgba(26,188,156,0.15)';
    const df=document.getElementById('bb-df');
    if(df){df.textContent=(crit?'üí• CRITICAL -':'‚öîÔ∏è -')+dmg;df.style.color=crit?'var(--gold2)':'var(--red2)';setTimeout(()=>{if(df)df.textContent='';},600);}
    if(crit){const be=document.getElementById('bb-be2');if(be){be.style.animation='kgShake 0.3s';setTimeout(()=>be.style.animation='',300);}}
    if(f){f.textContent=crit?'üí• CRITICAL! Combo√ó'+bb.combo:'‚öîÔ∏è Hit!';f.style.color=crit?'var(--gold2)':'var(--teal2)';}
    bbUpdateBars();const ss=document.getElementById('bb-s');if(ss)ss.textContent=bb.score;
    if(bb.bHp<=0){
      bb.bIdx++;
      if(bb.bIdx>=BB_BOSSES.length){setTimeout(()=>{kgSaveHS('boss',bb.score);kgGameOver('boss',bb.score,'üèÜ ‡∏Å‡∏≥‡∏à‡∏±‡∏î Boss ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î!');},600);return;}
      bb.boss=BB_BOSSES[bb.bIdx];bb.bHp=bb.boss.hp;
      const be=document.getElementById('bb-be'),be2=document.getElementById('bb-be2'),bn=document.getElementById('bb-bn'),bhe=document.getElementById('bb-be');
      if(be)be.textContent=bb.boss.e;if(be2)be2.textContent=bb.boss.e;if(bn)bn.textContent=bb.boss.name;
      bbUpdateBars();bbShowBossArrival();
    }
  }else{
    bb.combo=0;btn.style.borderColor='var(--red2)';btn.style.background='rgba(231,76,60,0.15)';
    bb.pHp=Math.max(0,bb.pHp-bb.boss.atk);
    if(f){f.textContent='‚úó ‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏≠ '+correct+' ‚Äî Boss ‡πÇ‡∏à‡∏°‡∏ï‡∏µ -'+bb.boss.atk+'HP';f.style.color='var(--red2)';}
    bbUpdateBars();
    if(bb.pHp<=0){setTimeout(()=>{kgSaveHS('boss',bb.score);kgGameOver('boss',bb.score,'‡πÅ‡∏û‡πâ‡∏ó‡∏µ‡πà Boss '+(bb.bIdx+1));},600);return;}
  }
  setTimeout(()=>{if(f)f.textContent='';renderBBQ();},480);
}

function bbUpdateBars(){
  const bhb=document.getElementById('bb-bhb'),bht=document.getElementById('bb-bht');
  const phb=document.getElementById('bb-phb'),pht=document.getElementById('bb-pht');
  if(bhb)bhb.style.width=(bb.bHp/bb.boss.hp*100)+'%';if(bht)bht.textContent=bb.bHp+'/'+bb.boss.hp;
  if(phb)phb.style.width=(bb.pHp/100*100)+'%';if(pht)pht.textContent=bb.pHp+'/100';
}

function bbShowBossArrival(){
  const d=document.createElement('div');
  d.style.cssText='position:fixed;inset:0;background:rgba(0,0,0,0.75);z-index:9999;display:flex;align-items:center;justify-content:center';
  d.innerHTML=`<div style="text-align:center;animation:kgPop 0.4s"><div style="font-size:72px">${bb.boss.e}</div><div style="font-size:24px;color:var(--red2);font-weight:700;font-family:'Noto Serif JP'">${bb.boss.name}</div><div style="font-size:14px;color:var(--text2);margin-top:6px">Boss ‡πÉ‡∏´‡∏°‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ï‡∏±‡∏ß!</div></div>`;
  document.body.appendChild(d);setTimeout(()=>d.remove(),1400);
}

</script>

<style>
/* ‚ïê‚ïê DAILY LEARNING ‚ïê‚ïê */
.dl-wrap{max-width:520px;margin:0 auto;padding:2px 0 20px}
.dl-hero{background:linear-gradient(135deg,rgba(22,160,133,.12),rgba(0,100,200,.08));border:1px solid rgba(22,160,133,.3);border-radius:16px;padding:20px 22px;margin-bottom:14px;text-align:center;position:relative;overflow:hidden}
.dl-hero::before{content:'';position:absolute;top:-30px;right:-30px;width:120px;height:120px;background:radial-gradient(#16a085,transparent 70%);opacity:.15;border-radius:50%;pointer-events:none}
.dl-badge{display:inline-block;background:rgba(22,160,133,.18);color:#1abc9c;border:1px solid rgba(22,160,133,.4);border-radius:20px;padding:3px 14px;font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;font-family:'Noto Sans JP',sans-serif}
.dl-hero-title{font-size:18px;font-weight:700;color:#fff;margin-bottom:4px}
.dl-hero-sub{font-size:12px;color:rgba(200,200,240,.5)}
.dl-progbar{background:rgba(0,0,0,.2);border-radius:6px;height:5px;overflow:hidden;margin:12px 0 5px}
.dl-progbar-fill{height:100%;background:linear-gradient(90deg,#16a085,#1abc9c);border-radius:6px;transition:width .6s}
.dl-prog-label{font-size:10px;color:rgba(200,220,200,.4);font-family:'Noto Sans JP',sans-serif}

/* Char strip */
.dl-strip{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin:12px 0}
.dl-chip{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.12);border-radius:10px;padding:10px 12px;text-align:center;min-width:56px;transition:all .2s}
.dl-chip .jp{font-size:26px;font-family:'Noto Serif JP';color:#fff;font-weight:700;line-height:1.2}
.dl-chip .ro{font-size:10px;color:rgba(180,220,180,.6);margin-top:3px;font-family:'Noto Sans JP'}
.dl-chip .th{font-size:9px;color:rgba(180,200,180,.4);margin-top:1px}
.dl-chip.mastered{border-color:rgba(26,188,156,.6);background:rgba(26,188,156,.12)}
.dl-chip.today{border-color:rgba(26,188,156,.9);background:rgba(26,188,156,.2);box-shadow:0 0 12px rgba(26,188,156,.2)}

/* Phase block */
.dl-phase{background:rgba(10,10,22,.5);border:1px solid rgba(255,255,255,.07);border-radius:14px;padding:18px;margin-bottom:12px}
.dl-phase-lbl{font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(200,200,240,.35);margin-bottom:12px;font-family:'Noto Sans JP'}

/* Study card */
.dl-card{background:rgba(255,255,255,.04);border:2px solid rgba(255,255,255,.1);border-radius:18px;padding:24px;text-align:center;margin-bottom:14px;transition:all .3s;position:relative}
.dl-card:hover{border-color:rgba(26,188,156,.4)}
.dl-char{font-family:'Noto Serif JP';font-size:86px;color:#fff;font-weight:900;line-height:1;text-shadow:0 0 40px rgba(26,188,156,.25)}
.dl-char-kj{font-size:74px}
.dl-ro{font-size:20px;color:#1abc9c;margin-top:8px;font-family:'Noto Sans JP';font-weight:700}
.dl-meaning{font-size:16px;color:#f0c040;margin-top:6px;font-weight:600}
.dl-tip{font-size:12px;color:rgba(200,200,240,.4);margin-top:8px;line-height:1.7;font-style:italic;max-width:320px;margin-left:auto;margin-right:auto}
.dl-on{font-size:11px;color:rgba(200,200,240,.35);margin-top:4px}
/* nav dots */
.dl-dots{display:flex;gap:7px;justify-content:center;margin-bottom:12px}
.dl-dot{width:9px;height:9px;border-radius:50%;background:rgba(255,255,255,.12);transition:all .25s}
.dl-dot.cur{background:#1abc9c;transform:scale(1.35)}.dl-dot.ok{background:rgba(26,188,156,.45)}
/* nav buttons */
.dl-btn{padding:9px 20px;border:none;border-radius:9px;cursor:pointer;font-size:13px;font-weight:700;transition:all .2s;font-family:'Sarabun',sans-serif}
.dl-btn-g{background:linear-gradient(135deg,#16a085,#1abc9c);color:#000}.dl-btn-g:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(26,188,156,.35)}
.dl-btn-gold{background:linear-gradient(135deg,#d4a017,#f0c040);color:#000}.dl-btn-gold:hover{transform:translateY(-2px)}
.dl-btn-o{background:transparent;border:1px solid rgba(255,255,255,.15);color:rgba(200,200,240,.6)}.dl-btn-o:hover{border-color:rgba(255,255,255,.3);color:#fff}
.dl-btn-row{display:flex;gap:9px;justify-content:center;flex-wrap:wrap;margin-top:12px}
/* Quiz */
.dl-qprog{height:3px;background:rgba(255,255,255,.07);border-radius:2px;margin-bottom:14px;overflow:hidden}
.dl-qprogf{height:100%;background:linear-gradient(90deg,#1abc9c,#3498db);border-radius:2px;transition:width .35s}
.dl-q-char{font-family:'Noto Serif JP';font-size:72px;color:#fff;font-weight:900;text-align:center;margin:8px 0 16px;text-shadow:0 0 30px rgba(26,188,156,.2);line-height:1}
.dl-q-char.is-text{font-family:'Sarabun';font-size:22px;font-weight:700;color:#f0c040;margin:14px 0}
.dl-q-label{font-size:11px;color:rgba(200,200,240,.4);text-align:center;margin-bottom:4px;font-family:'Noto Sans JP'}
.dl-opts{display:grid;grid-template-columns:1fr 1fr;gap:8px;max-width:380px;margin:0 auto}
.dl-opt{padding:12px 14px;background:rgba(255,255,255,.05);border:2px solid rgba(255,255,255,.1);border-radius:10px;cursor:pointer;font-size:14px;text-align:center;transition:all .15s;color:#e8e8f0;font-family:'Noto Serif JP'}
.dl-opt-text{font-family:'Sarabun';font-size:13px}
.dl-opt:hover{border-color:rgba(26,188,156,.5);background:rgba(26,188,156,.08)}
.dl-opt.ok{border-color:#1abc9c;background:rgba(26,188,156,.18);color:#1abc9c}
.dl-opt.bad{border-color:#e74c3c;background:rgba(231,76,60,.12);color:#e74c3c}
.dl-opt.reveal{border-color:rgba(26,188,156,.5);background:rgba(26,188,156,.08)}
.dl-round-badge{display:inline-flex;gap:6px;align-items:center;font-size:10px;color:rgba(200,200,240,.4);margin-bottom:10px;font-family:'Noto Sans JP'}
.dl-round-chip{background:rgba(255,255,255,.06);border-radius:8px;padding:2px 8px}
.dl-fb{min-height:18px;font-size:12px;text-align:center;margin-top:8px;font-family:'Noto Sans JP'}
/* Map */
.dl-map{display:flex;flex-wrap:wrap;gap:5px;margin-top:8px}
.dl-mc{width:30px;height:30px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:13px;font-family:'Noto Serif JP';border:1px solid transparent;cursor:default;transition:all .15s}
.dl-mc.today{border-color:#1abc9c;background:rgba(26,188,156,.3);color:#fff}
.dl-mc.done{background:rgba(26,188,156,.12);border-color:rgba(26,188,156,.3);color:#1abc9c}
.dl-mc.unseen{background:rgba(255,255,255,.03);border-color:rgba(255,255,255,.07);color:rgba(200,200,240,.2)}
/* Result */
.dl-result{text-align:center;padding:20px 0 8px}
.dl-result-icon{font-size:56px;margin-bottom:8px}
.dl-result-pct{font-family:'Noto Serif JP';font-size:54px;font-weight:900;line-height:1}
.dl-result-title{font-size:18px;font-weight:700;color:#fff;margin:8px 0 4px}
.dl-result-sub{font-size:13px;color:rgba(200,200,240,.5);margin-bottom:18px;line-height:1.7}
/* Animations */
@keyframes dlPop{0%{transform:scale(.85);opacity:0}60%{transform:scale(1.06)}100%{transform:scale(1);opacity:1}}
@keyframes dlShake{0%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}100%{transform:translateX(0)}}
.dl-pop{animation:dlPop .3s ease}.dl-shake{animation:dlShake .3s ease}
/* Round header colors */
.round1-col{color:#3498db}.round2-col{color:#d4a017}.round3-col{color:#1abc9c}
/* Typing input */
.dl-typing{width:100%;max-width:320px;margin:0 auto;display:block;background:rgba(255,255,255,.05);border:2px solid rgba(255,255,255,.12);border-radius:10px;padding:12px;color:#fff;font-size:18px;text-align:center;outline:none;transition:border .2s;font-family:'Noto Sans JP'}
.dl-typing:focus{border-color:#1abc9c}
.dl-typing.ok{border-color:#1abc9c;background:rgba(26,188,156,.12)}
.dl-typing.bad{border-color:#e74c3c;background:rgba(231,76,60,.08)}
</style>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DAILY LEARNING ENGINE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DL_BATCH_SIZE = { hira: 5, kata: 5, kj: 5 };

const HIRA_TIPS = [
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏ï‡∏±‡∏ß "a" ‡∏ö‡∏¥‡∏î‡∏ï‡∏±‡∏ß','‡πÄ‡∏™‡πâ‡∏ô 2 ‡πÄ‡∏™‡πâ‡∏ô ‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "ii"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏ñ‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≥ "u"','‡∏°‡∏µ‡πÑ‡∏°‡πâ‡∏Å‡∏≤‡∏á‡πÄ‡∏Ç‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „ÅÇ ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "ka" ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå','‡∏°‡∏µ 2 ‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ô + ‡∏´‡∏≤‡∏á','‡∏£‡∏π‡∏õ‡∏õ‡∏≤‡∏Å‡∏ô‡∏Å "ku"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ ke ‡∏°‡∏µ‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢','‡πÄ‡∏™‡πâ‡∏ô 2 ‡πÄ‡∏™‡πâ‡∏ô ‡∏´‡∏±‡∏Å "ko"',
  '‡πÄ‡∏™‡πâ‡∏ô 3 ‡πÄ‡∏™‡πâ‡∏ô "sa"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏ï‡∏∞‡∏Ç‡∏≠ "shi"','‡∏°‡∏µ‡∏ß‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏á "su"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ se ‡∏°‡∏µ backbone','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç 3 "so"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "ta" ‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏ö‡∏ô','‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏±‡∏ß 5 "chi"','‡πÇ‡∏Ñ‡πâ‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ "tsu"','‡πÄ‡∏™‡πâ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏á‡∏á‡πà‡∏≤‡∏¢ "te"','‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏á "to"',
  '‡∏°‡∏µ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á "na"','‡πÄ‡∏™‡πâ‡∏ô 3 ‡πÄ‡∏™‡πâ‡∏ô ‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ ‰∫å "ni"','‡∏°‡∏µ‡∏ß‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏á "nu"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „Å¨ ‡∏°‡∏µ‡∏´‡∏≤‡∏á‡∏¢‡∏≤‡∏ß "ne"','‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß "no"',
  '3 ‡∏™‡πà‡∏ß‡∏ô "ha"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç 7 ‡∏û‡∏•‡∏¥‡∏Å "hi"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á‡∏¢‡∏Å‡∏°‡∏∑‡∏≠ "fu"','‡πÄ‡∏™‡πâ‡∏ô‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß mountain "he"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „ÅØ ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° "ho"',
  '‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏ï‡∏±‡∏î "ma"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏ô‡∏¢‡∏¥‡πâ‡∏° "mi"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ mu ‡∏°‡∏µ‡∏´‡∏≤‡∏á','‡∏°‡∏µ‡∏ß‡∏á‡∏Å‡∏•‡∏° "me"','‡πÄ‡∏™‡πâ‡∏ô 3 ‡∏™‡πà‡∏ß‡∏ô "mo"',
  '‡∏ï‡∏±‡∏ß "ya" ‡∏°‡∏µ‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢','‡∏°‡∏µ‡∏ß‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏á "yu"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏ï‡∏±‡∏ß "yo"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "ra" ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏¥‡∏î‡∏ï‡∏±‡∏ß','2 ‡πÄ‡∏™‡πâ‡∏ô ‡∏á‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å "ri"','‡∏°‡∏µ‡∏ß‡∏á‡∏™‡∏ß‡∏¢ "ru"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "re" ‡∏°‡∏µ‡∏´‡∏≤‡∏á','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "ro" ‡∏ï‡∏±‡∏î‡∏´‡∏≤‡∏á',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "wa"','‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô particle ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î','‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ô‡∏≤‡∏™‡∏¥‡∏Å "n"'
];
const KATA_TIPS = [
  '‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏Å‡∏ß‡πà‡∏≤ „ÅÇ','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "I" ‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ u ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà','‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Â∑• ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „Ç™ ‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏Å‡∏•‡∏≤‡∏á',
  '‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏ï‡∏±‡∏î "ka"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ # ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö','‡∏õ‡∏≤‡∏Å‡∏ô‡∏Å‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏° "ku"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ F ‡∏û‡∏•‡∏¥‡∏Å "ke"','‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö 2 ‡∏≠‡∏±‡∏ô "ko"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ sa ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ "3" ‡∏°‡∏µ‡∏à‡∏∏‡∏î "shi"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ 7 ‡∏°‡∏µ‡∏´‡∏≤‡∏á "su"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ se "se"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „ÇΩ ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á "so"',
  'ta ‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏ï‡∏±‡∏î','chi ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „ÇΩ ‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ "tsu"','‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏ö‡∏ô "te"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏ï‡∏∞‡∏õ‡∏π "to"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ + ‡∏ö‡∏ß‡∏Å "na"','‡∏™‡∏≠‡∏á‡∏Ç‡∏µ‡∏î ‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ ‰∫å "ni"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ nu ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ ne ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°','‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß slash "no"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ A ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏¢‡∏≠‡∏î "ha"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „Éí "hi"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ 7 ‡∏´‡∏£‡∏∑‡∏≠ hook "fu"','‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÅ‡∏´‡∏•‡∏° ‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „Å∏ "he"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „Éõ ‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏ï‡∏±‡∏î "ho"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „Éû "ma"','‡∏™‡∏≤‡∏°‡∏Ç‡∏µ‡∏î "mi"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „É† ‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß "mu"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏ï‡∏±‡∏ß x "me"','‡∏™‡∏≤‡∏°‡∏Ç‡∏µ‡∏î "mo"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „É§ "ya"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „É¶ ‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏ö‡∏ô "yu"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ E ‡∏™‡∏≤‡∏°‡πÅ‡∏Ç‡∏ô "yo"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „É© ‡∏°‡∏µ‡∏´‡∏≤‡∏á‡∏Ç‡∏µ‡∏î "ra"','‡∏™‡∏≠‡∏á‡∏Ç‡∏µ‡∏î‡∏ï‡∏±‡πâ‡∏á "ri"','‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ –ß "ru"','‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ L "re"','‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏° "ro"',
  '‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ „ÉØ "wa"','‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ particle ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô','‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô „ÇΩ ‡∏´‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô "n"'
];

function dlData(type) {
  if (type === 'hira') return HIRAGANA.map((k,i) => ({char:k.jp, ro:k.ro, meaning:'„Å≤„Çâ„Åå„Å™', tip:HIRA_TIPS[i]||'', type:'kana'}));
  if (type === 'kata') return KATAKANA.map((k,i) => ({char:k.jp, ro:k.ro, meaning:'„Ç´„Çø„Ç´„Éä', tip:KATA_TIPS[i]||'', type:'kana'}));
  if (type === 'kj')   return KANJI_N5.map(k => ({char:k.k, ro:k.on+' / '+k.kun, meaning:k.m, tip:k.ex||'', type:'kanji'}));
  return [];
}

function dlBatch(type, day) {
  const sz = DL_BATCH_SIZE[type];
  return dlData(type).slice(day * sz, day * sz + sz);
}

function dlTotalDays(type) { return Math.ceil(dlData(type).length / DL_BATCH_SIZE[type]); }

function dlLoadState(type) {
  try { return JSON.parse(localStorage.getItem('dl_' + type)) || null; } catch(e){ return null; }
}
function dlSaveState(type, s) { localStorage.setItem('dl_' + type, JSON.stringify(s)); }

function dlGetState(type) {
  return dlLoadState(type) || { day: 0, mastered: [], accuracy: {} };
}

// ‚îÄ‚îÄ Persist mastered chars into original state ‚îÄ‚îÄ
function dlSyncLearned(type, batchChars) {
  if (type === 'hira') {
    batchChars.forEach(c => { if (!state.hiraLearned.includes(c)) state.hiraLearned.push(c); });
    save(); updateStats();
  } else if (type === 'kata') {
    batchChars.forEach(c => { if (!state.kataLearned.includes(c)) state.kataLearned.push(c); });
    save(); updateStats();
  } else if (type === 'kj') {
    batchChars.forEach(c => { if (!state.kanjiKnown.includes(c)) state.kanjiKnown.push(c); });
    save(); updateStats();
  }
}

function shuf(a) { return [...a].sort(() => Math.random() - .5); }

// ‚îÄ‚îÄ ENTRY POINT ‚îÄ‚îÄ
function dlInit(type) {
  const root = document.getElementById(type + '-dl-root');
  if (!root) return;
  const s = dlGetState(type);
  const total = dlTotalDays(type);
  s.day >= total ? dlRenderComplete(type, root, s, total) : dlRenderHome(type, root, s, total);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HOME SCREEN
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function dlRenderHome(type, root, s, total) {
  const data = dlData(type);
  const batch = dlBatch(type, s.day);
  const mastered = s.mastered.length;
  const pct = Math.round(mastered / total * 100);
  const typeName = {hira:'Hiragana',kata:'Katakana',kj:'Kanji N5'}[type];
  const isKj = type === 'kj';

  // Map
  const mapHTML = data.map((item, i) => {
    const day = Math.floor(i / DL_BATCH_SIZE[type]);
    const cls = day === s.day ? 'today' : s.mastered.includes(day) ? 'done' : 'unseen';
    return `<div class="dl-mc ${cls}" title="${item.char} ${item.ro}">${item.char}</div>`;
  }).join('');

  // Chips for today's batch
  const todayDone = s.mastered.includes(s.day);
  const chipsHTML = batch.map(c => `
    <div class="dl-chip ${todayDone?'mastered':'today'}">
      <div class="jp">${c.char}</div>
      <div class="ro">${c.ro}</div>
      ${isKj ? `<div class="th">${c.meaning}</div>` : ''}
    </div>`).join('');

  root.innerHTML = `
    <div class="dl-wrap">
      <div class="dl-hero">
        <div class="dl-badge">Day ${s.day+1} of ${total} ¬∑ ${typeName}</div>
        <div class="dl-hero-title">üìÖ Daily ${typeName} ‚Äî ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ ${DL_BATCH_SIZE[type]} ‡∏ï‡∏±‡∏ß</div>
        <div class="dl-hero-sub">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏ä‡∏∏‡∏î‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡πÉ‡∏´‡πâ‡∏à‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏à‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ï‡πà‡∏≠</div>
        <div class="dl-progbar"><div class="dl-progbar-fill" style="width:${pct}%"></div></div>
        <div class="dl-prog-label">${mastered}/${total} ‡∏ß‡∏±‡∏ô ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß (${pct}%)</div>
      </div>

      <div class="dl-phase">
        <div class="dl-phase-lbl">üìñ ‡∏ä‡∏∏‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‚Äî Day ${s.day+1}</div>
        <div class="dl-strip">${chipsHTML}</div>
        ${!todayDone ? `
          <div class="dl-btn-row">
            <button class="dl-btn dl-btn-g" onclick="dlStudy('${type}',0)">üìñ ‡∏î‡∏π‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß ‡πÅ‡∏•‡πâ‡∏ß Quiz</button>
            <button class="dl-btn dl-btn-o" onclick="dlQuiz('${type}',1)">‚ö° Quiz ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</button>
          </div>` : `
          <div class="dl-btn-row">
            <button class="dl-btn dl-btn-g" onclick="dlAdvance('${type}')">üîì ‡πÑ‡∏õ‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (Day ${s.day+2}) ‚Üí</button>
            <button class="dl-btn dl-btn-o" onclick="dlQuiz('${type}',1)">üîÑ ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö</button>
          </div>`}
      </div>

      <div class="dl-phase">
        <div class="dl-phase-lbl">üó∫Ô∏è ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${data.length} ‡∏ï‡∏±‡∏ß</div>
        <div style="display:flex;gap:10px;font-size:10px;color:rgba(200,200,240,.4);margin-bottom:8px;flex-wrap:wrap;font-family:'Noto Sans JP'">
          <span><span style="display:inline-block;width:10px;height:10px;background:rgba(26,188,156,.4);border-radius:2px;margin-right:4px;vertical-align:middle"></span>‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</span>
          <span><span style="display:inline-block;width:10px;height:10px;background:rgba(26,188,156,.12);border-radius:2px;margin-right:4px;vertical-align:middle"></span>‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
          <span><span style="display:inline-block;width:10px;height:10px;background:rgba(255,255,255,.03);border-radius:2px;margin-right:4px;vertical-align:middle"></span>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
        </div>
        <div class="dl-map">${mapHTML}</div>
      </div>
    </div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STUDY PHASE ‚Äî ‡∏î‡∏π‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function dlStudy(type, idx) {
  const root = document.getElementById(type + '-dl-root');
  const s = dlGetState(type);
  const batch = dlBatch(type, s.day);
  const isKj = type === 'kj';
  const c = batch[idx];

  const dotsHTML = batch.map((_,i) =>
    `<div class="dl-dot ${i < idx ? 'ok' : i === idx ? 'cur' : ''}"></div>`).join('');

  root.innerHTML = `
    <div class="dl-wrap">
      <div style="font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(200,200,240,.35);margin-bottom:10px;font-family:'Noto Sans JP'">üìñ Study ‚Äî ‡∏î‡∏π‡πÉ‡∏´‡πâ‡∏à‡∏≥‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß Quiz</div>
      <div class="dl-dots">${dotsHTML}</div>
      <div class="dl-phase">
        <div class="dl-card dl-pop">
          <div class="dl-char ${isKj?'dl-char-kj':''}">${c.char}</div>
          <div class="dl-ro">${c.ro}</div>
          ${isKj ? `<div class="dl-meaning">${c.meaning}</div>` : ''}
          <div class="dl-tip">${c.tip}</div>
          ${isKj ? `<div class="dl-on">On/Kun: ${c.ro}</div>` : ''}
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px">
          <span style="font-size:12px;color:rgba(200,200,240,.35);font-family:'Noto Sans JP'">${idx+1} / ${batch.length}</span>
          <div class="dl-btn-row" style="margin-top:0">
            ${idx > 0 ? `<button class="dl-btn dl-btn-o" style="font-size:12px;padding:8px 14px" onclick="dlStudy('${type}',${idx-1})">‚Üê ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>` : ''}
            ${idx < batch.length - 1
              ? `<button class="dl-btn dl-btn-g" onclick="dlStudy('${type}',${idx+1})">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>`
              : `<button class="dl-btn dl-btn-g" onclick="dlQuiz('${type}',1)">üéØ ‡πÄ‡∏£‡∏¥‡πà‡∏° Quiz!</button>`}
          </div>
        </div>
      </div>
      <button class="dl-btn dl-btn-o" style="font-size:11px;padding:6px 12px" onclick="dlInit('${type}')">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// QUIZ ENGINE ‚Äî 3 rounds
// round 1: ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‚Üí romaji/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ (4 ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)
// round 2: romaji/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ ‚Üí ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (4 ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)
// round 3: Mastery typing (‡∏û‡∏¥‡∏°‡∏û‡πå romaji/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function dlQuiz(type, round) {
  const root = document.getElementById(type + '-dl-root');
  const s = dlGetState(type);
  const batch = dlBatch(type, s.day);
  const allData = dlData(type);
  const isKj = type === 'kj';

  const qs = shuf([...batch]);
  let qi = 0, correct = 0, wrongCount = 0, answered = false;

  const ROUNDS = {
    1: {label:'Round 1 ‚Äî ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‚Üí ‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô', col:'#3498db', ask:'char', show:'answer'},
    2: {label:'Round 2 ‚Äî ‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô ‚Üí ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£', col:'#d4a017', ask:'answer', show:'char'},
    3: {label:'üèÜ Mastery ‚Äî ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö', col:'#1abc9c', ask:'char', show:'type'},
  };
  const rd = ROUNDS[round];

  function getOpts(c) {
    const distractors = shuf(allData.filter(x => x.char !== c.char)).slice(0, 3);
    return shuf([c, ...distractors]);
  }

  function questionText(c) {
    if (rd.ask === 'char') return c.char;
    return isKj ? c.meaning : c.ro;
  }
  function answerLabel(o) {
    if (rd.show === 'answer') return isKj ? o.meaning : o.ro;
    return o.char;
  }

  function renderQ() {
    if (qi >= qs.length) { showResult(); return; }
    answered = false;
    const c = qs[qi];
    const opts = getOpts(c);
    const progPct = qi / qs.length * 100;
    const isCharQ = rd.ask === 'char';
    const isTyping = rd.show === 'type';
    const qStyle = isCharQ ? '' : 'is-text';

    let optsHTML = '';
    if (!isTyping) {
      optsHTML = `<div class="dl-opts" id="dl-opts">${opts.map(o =>
        `<div class="dl-opt${isKj&&rd.show==='answer'?' dl-opt-text':''}" onclick="dlPick(this,'${o.char.replace(/'/g,"\\'").replace(/"/g,'&quot;')}','${c.char.replace(/'/g,"\\'").replace(/"/g,'&quot;')}')" data-char="${o.char.replace(/"/g,'&quot;')}">${answerLabel(o)}</div>`
      ).join('')}</div>`;
    } else {
      optsHTML = `
        <div style="text-align:center">
          <div style="font-size:11px;color:rgba(200,200,240,.4);margin-bottom:8px;font-family:'Noto Sans JP'">‡∏û‡∏¥‡∏°‡∏û‡πå ${isKj?'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢':'romaji'}</div>
          <input class="dl-typing" id="dl-type-inp" placeholder="${isKj?'‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢...':'‡∏û‡∏¥‡∏°‡∏û‡πå romaji...'}" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" onkeydown="if(event.key==='Enter')dlCheckType('${type}',${round},'${c.char.replace(/'/g,"\\'").replace(/"/g,'&quot;')}','${(isKj?c.meaning:c.ro).replace(/'/g,"\\'")}')">
          <div class="dl-btn-row" style="margin-top:10px">
            <button class="dl-btn dl-btn-g" onclick="dlCheckType('${type}',${round},'${c.char.replace(/'/g,"\\'").replace(/"/g,'&quot;')}','${(isKj?c.meaning:c.ro).replace(/'/g,"\\'")}')">‚úì ‡∏ï‡∏£‡∏ß‡∏à</button>
          </div>
        </div>`;
    }

    root.innerHTML = `
      <div class="dl-wrap">
        <div class="dl-round-badge">
          <span class="dl-round-chip" style="color:${rd.col};border-color:${rd.col}44">${rd.label}</span>
          <span>${correct} ‚úì &nbsp; ${wrongCount} ‚úó</span>
        </div>
        <div class="dl-qprog"><div class="dl-qprogf" style="width:${progPct}%"></div></div>
        <div class="dl-q-label">${isCharQ?(isKj?'Kanji ‡∏ô‡∏µ‡πâ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?':'Romaji ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?'):(isKj?'Kanji ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?':'‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Ç‡∏≠‡∏á romaji ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?')}</div>
        <div class="dl-q-char dl-pop ${qStyle}">${questionText(c)}</div>
        ${optsHTML}
        <div class="dl-fb" id="dl-fb"></div>
        <div style="font-size:10px;color:rgba(200,200,240,.25);text-align:center;margin-top:8px;font-family:'Noto Sans JP'">${qi+1} / ${qs.length}</div>
      </div>`;

    if (isTyping) setTimeout(() => document.getElementById('dl-type-inp')?.focus(), 80);
  }

  // Expose handlers
  window.dlPick = function(el, chosen, correctChar) {
    if (answered) return; answered = true;
    document.querySelectorAll('.dl-opt').forEach(o => { o.onclick = null; });
    const isCorrect = chosen === correctChar;
    const fb = document.getElementById('dl-fb');
    document.querySelectorAll('.dl-opt').forEach(o => {
      if (o.dataset.char === correctChar) o.classList.add('reveal');
      if (o.dataset.char === chosen && !isCorrect) o.classList.add('bad');
      if (o.dataset.char === chosen && isCorrect) o.classList.add('ok');
    });
    if (isCorrect) { correct++; if(fb){fb.textContent='‚úì ‡∏ñ‡∏π‡∏Å!';fb.style.color='#1abc9c';} }
    else { wrongCount++; if(fb){fb.textContent=`‚úó ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å: ${answerLabel(qs[qi])}`;fb.style.color='#e74c3c';} }
    qi++;
    setTimeout(renderQ, isCorrect ? 550 : 950);
  };

  window.dlCheckType = function(t, rnd, correctChar, correctAnswer) {
    if (answered) return; answered = true;
    const inp = document.getElementById('dl-type-inp');
    if (!inp) return;
    const val = inp.value.trim().toLowerCase();
    const expect = correctAnswer.trim().toLowerCase();
    // Accept partial match for kanji meanings
    const isCorrect = val === expect || (isKj && expect.includes(val) && val.length >= 2);
    inp.classList.add(isCorrect ? 'ok' : 'bad');
    const fb = document.getElementById('dl-fb');
    if (isCorrect) { correct++; if(fb){fb.textContent='‚úì ‡∏ñ‡∏π‡∏Å!';fb.style.color='#1abc9c';} }
    else { wrongCount++; if(fb){fb.textContent=`‚úó ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö: ${correctAnswer}`;fb.style.color='#e74c3c';} }
    qi++;
    setTimeout(renderQ, isCorrect ? 500 : 900);
  };

  function showResult() {
    const acc = Math.round(correct / qs.length * 100);
    const passed = acc >= (round === 3 ? 80 : 70);
    const icon = acc >= 90 ? 'üèÜ' : acc >= 70 ? 'üéâ' : 'üí™';
    const accColor = acc >= 90 ? '#1abc9c' : acc >= 70 ? '#f0c040' : '#e74c3c';
    const msg = acc >= 90 ? '‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏à‡∏≥‡πÑ‡∏î‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏à!' : acc >= 70 ? '‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß! ‡∏ó‡∏≥‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏°‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏°‡πà‡∏ô ‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏∞';

    // If mastery passed ‚Üí mark day done
    if (round === 3 && passed) {
      const s2 = dlGetState(type);
      s2.mastered = [...new Set([...s2.mastered, s2.day])];
      dlSaveState(type, s2);
      dlSyncLearned(type, batch.map(c => c.char));
    }

    let actionHTML = '';
    if (!passed) {
      actionHTML = `
        <button class="dl-btn dl-btn-g" onclick="dlStudy('${type}',0)">üìñ ‡∏î‡∏π‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="dl-btn dl-btn-o" onclick="dlQuiz('${type}',${round})">üîÑ Quiz ‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö</button>`;
    } else if (round < 3) {
      actionHTML = `
        <button class="dl-btn dl-btn-g" onclick="dlQuiz('${type}',${round+1})">‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
        <button class="dl-btn dl-btn-o" onclick="dlQuiz('${type}',${round})">üîÑ ‡∏ã‡πâ‡∏≥‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ</button>`;
    } else {
      actionHTML = `
        <button class="dl-btn dl-btn-g" onclick="dlAdvance('${type}')">üîì ‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ! ‚Üí</button>
        <button class="dl-btn dl-btn-o" onclick="dlQuiz('${type}',1)">üîÑ ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏ô</button>`;
    }

    root.innerHTML = `
      <div class="dl-wrap">
        <div class="dl-result">
          <div class="dl-result-icon">${icon}</div>
          <div class="dl-result-pct" style="color:${accColor}">${acc}%</div>
          <div class="dl-result-title">${rd.label}</div>
          <div class="dl-result-sub">${correct} / ${qs.length} ‡∏ñ‡∏π‡∏Å ‚Äî ${msg}
            ${round === 3 && passed ? '<br><span style="color:#1abc9c">‚úÖ Day ' + (dlGetState(type).day) + ' ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß! ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</span>' : ''}
          </div>
          <div class="dl-btn-row">${actionHTML}</div>
          <div class="dl-btn-row" style="margin-top:6px">
            <button class="dl-btn dl-btn-o" style="font-size:11px;padding:7px 14px" onclick="dlInit('${type}')">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
          </div>
        </div>
        <div class="dl-phase" style="margin-top:14px">
          <div class="dl-phase-lbl">Flow ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</div>
          <div style="font-size:12px;color:rgba(200,200,240,.5);line-height:1.9;font-family:'Noto Sans JP'">
            üìñ ‡∏î‡∏π‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß ‚Üí üéØ Round 1 (‡∏ï‡∏±‡∏ß‚Üí‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô) ‚Üí üîÑ Round 2 (‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô‚Üí‡∏ï‡∏±‡∏ß) ‚Üí üèÜ Mastery typing<br>
            ‡∏ú‡πà‡∏≤‡∏ô Mastery ‚â•80% = unlock ‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚úì
          </div>
        </div>
      </div>`;
  }

  renderQ();
}

function dlAdvance(type) {
  const s = dlGetState(type);
  const total = dlTotalDays(type);
  if (s.mastered.includes(s.day) && s.day < total - 1) {
    s.day++;
    dlSaveState(type, s);
  }
  dlInit(type);
}

function dlRenderComplete(type, root, s, total) {
  const typeName = {hira:'Hiragana',kata:'Katakana',kj:'Kanji N5'}[type];
  root.innerHTML = `
    <div class="dl-wrap">
      <div class="dl-result">
        <div class="dl-result-icon">üéå</div>
        <div class="dl-result-title">‡∏ú‡πà‡∏≤‡∏ô ${typeName} ‡∏Ñ‡∏£‡∏ö ${dlData(type).length} ‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡πâ‡∏ß!</div>
        <div class="dl-result-sub">${total} ‡∏ß‡∏±‡∏ô ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î<br>‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å!</div>
        <div class="dl-btn-row">
          <button class="dl-btn dl-btn-g" onclick="dlQuiz('${type}',3)">üèÜ Mastery ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
          <button class="dl-btn dl-btn-o" onclick="dlResetDay('${type}')">‚Ü∫ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
        </div>
      </div>
    </div>`;
}

function dlResetDay(type) {
  const s = dlGetState(type); s.day = 0; s.mastered = []; dlSaveState(type, s); dlInit(type);
}
</script>


<style>
#yor-credit{position:fixed;bottom:0;left:0;right:0;background:rgba(8,8,16,.92);backdrop-filter:blur(10px);border-top:1px solid rgba(232,84,122,.2);padding:5px 16px;display:flex;align-items:center;justify-content:space-between;z-index:9999;font-family:'Sarabun',sans-serif;flex-wrap:wrap;gap:6px}
#yor-credit .yc-name{font-size:12px;font-weight:700;color:#e8547a}
#yor-credit .yc-stage{font-size:10px;color:rgba(200,200,232,.4);font-family:'Noto Sans JP',sans-serif}
#yor-credit .yc-back{font-size:10px;color:rgba(200,200,232,.4);text-decoration:none;border:1px solid rgba(232,84,122,.3);border-radius:6px;padding:3px 10px;transition:all .2s}
#yor-credit .yc-back:hover{color:#e8547a;border-color:#e8547a}
body{padding-bottom:60px}
</style>
<div id="yor-credit">
  <div style="display:flex;align-items:center;gap:10px">
    <span class="yc-name">Yor</span>
    <span class="yc-stage">Êó•Êú¨Ë™ûÂ≠¶Áøí Stage 1 ¬∑ Yor's Road to Reading Japanese Manga</span>
  </div>
  <a class="yc-back" href="index.html">‚Üê Portal</a>
</div>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     FIREBASE ‚Äî loaded from firebase.js
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<style>
@keyframes fbShimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
@keyframes fbPulse{0%{opacity:1}50%{opacity:.4}100%{opacity:1}}
#fb-login-overlay{position:fixed;inset:0;background:rgba(5,5,15,.93);backdrop-filter:blur(16px);z-index:99999;display:flex;align-items:center;justify-content:center;font-family:'Sarabun',sans-serif}
#fb-login-box{background:#0f0f1a;border:1px solid rgba(232,84,122,.3);border-radius:20px;padding:36px 40px;text-align:center;max-width:380px;width:90%}
#fb-login-box .fb-logo{font-size:48px;margin-bottom:12px}
#fb-login-box .fb-title{font-size:22px;font-weight:700;color:#fff;margin-bottom:6px}
#fb-login-box .fb-sub{font-size:13px;color:rgba(200,200,240,.5);margin-bottom:24px;line-height:1.7}
#fb-google-btn{display:flex;align-items:center;gap:10px;justify-content:center;background:#fff;color:#333;border:none;border-radius:10px;padding:12px 24px;font-size:14px;font-weight:700;cursor:pointer;width:100%;transition:all .2s;font-family:'Sarabun',sans-serif}
#fb-google-btn:hover{background:#f0f0f0;transform:translateY(-2px);box-shadow:0 4px 16px rgba(255,255,255,.15)}
#fb-google-btn img{width:20px;height:20px}
#fb-skip{display:block;margin-top:14px;font-size:11px;color:rgba(200,200,240,.35);cursor:pointer;text-decoration:underline;transition:color .2s}
#fb-skip:hover{color:rgba(200,200,240,.7)}
</style>

<div id="fb-login-overlay">
  <div id="fb-login-box">
    <div class="fb-logo">üéå</div>
    <div class="fb-title">Yor's Road to Manga</div>
    <div class="fb-sub">Login ‡∏î‡πâ‡∏ß‡∏¢ Google ‡πÄ‡∏û‡∏∑‡πà‡∏≠ sync progress<br>‡∏Ç‡πâ‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏Ç‡πâ‡∏≤‡∏° Browser ‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà</div>
    <button id="fb-google-btn" onclick="fbSignIn()">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
      Login ‡∏î‡πâ‡∏ß‡∏¢ Google
    </button>
    <span id="fb-skip" onclick="fbSkip()">‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô (‡πÑ‡∏°‡πà sync)</span>
  </div>
</div>

<script type="module" src="firebase.js"></script>

</body>
</html>
